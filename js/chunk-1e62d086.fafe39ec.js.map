{"version":3,"sources":["webpack:///./node_modules/core-js/internals/function-bind.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack:///./node_modules/core-js/modules/es.reflect.construct.js","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/core-js/modules/es.map.js","webpack:///./node_modules/core-js/modules/es.object.entries.js","webpack:///./node_modules/core-js/internals/collection-strong.js","webpack:///./node_modules/core-js/internals/collection.js","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./node_modules/core-js/internals/inherit-if-required.js","webpack:///./src/views/Game.vue","webpack:///./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./node_modules/konva/lib/Util.js","webpack:///./node_modules/konva/lib/Validators.js","webpack:///./node_modules/konva/lib/Factory.js","webpack:///./node_modules/konva/lib/Context.js","webpack:///./node_modules/konva/lib/Canvas.js","webpack:///./node_modules/konva/lib/DragAndDrop.js","webpack:///./node_modules/konva/lib/Node.js","webpack:///./node_modules/konva/lib/Container.js","webpack:///./node_modules/konva/lib/PointerEvents.js","webpack:///./node_modules/konva/lib/Stage.js","webpack:///./node_modules/konva/lib/Shape.js","webpack:///./node_modules/konva/lib/Layer.js","webpack:///./node_modules/konva/lib/FastLayer.js","webpack:///./node_modules/konva/lib/Group.js","webpack:///./node_modules/konva/lib/Animation.js","webpack:///./node_modules/konva/lib/Tween.js","webpack:///./node_modules/konva/lib/_CoreInternals.js","webpack:///./node_modules/konva/lib/shapes/Arc.js","webpack:///./node_modules/konva/lib/shapes/Line.js","webpack:///./node_modules/konva/lib/shapes/Path.js","webpack:///./node_modules/konva/lib/shapes/Arrow.js","webpack:///./node_modules/konva/lib/shapes/Circle.js","webpack:///./node_modules/konva/lib/shapes/Ellipse.js","webpack:///./node_modules/konva/lib/shapes/Image.js","webpack:///./node_modules/konva/lib/shapes/Label.js","webpack:///./node_modules/konva/lib/shapes/Rect.js","webpack:///./node_modules/konva/lib/shapes/RegularPolygon.js","webpack:///./node_modules/konva/lib/shapes/Ring.js","webpack:///./node_modules/konva/lib/shapes/Sprite.js","webpack:///./node_modules/konva/lib/shapes/Star.js","webpack:///./node_modules/konva/lib/shapes/Text.js","webpack:///./node_modules/konva/lib/shapes/TextPath.js","webpack:///./node_modules/konva/lib/shapes/Transformer.js","webpack:///./node_modules/konva/lib/shapes/Wedge.js","webpack:///./node_modules/konva/lib/filters/Blur.js","webpack:///./node_modules/konva/lib/filters/Brighten.js","webpack:///./node_modules/konva/lib/filters/Contrast.js","webpack:///./node_modules/konva/lib/filters/Emboss.js","webpack:///./node_modules/konva/lib/filters/Enhance.js","webpack:///./node_modules/konva/lib/filters/Grayscale.js","webpack:///./node_modules/konva/lib/filters/HSL.js","webpack:///./node_modules/konva/lib/filters/HSV.js","webpack:///./node_modules/konva/lib/filters/Invert.js","webpack:///./node_modules/konva/lib/filters/Kaleidoscope.js","webpack:///./node_modules/konva/lib/filters/Mask.js","webpack:///./node_modules/konva/lib/filters/Noise.js","webpack:///./node_modules/konva/lib/filters/Pixelate.js","webpack:///./node_modules/konva/lib/filters/Posterize.js","webpack:///./node_modules/konva/lib/filters/RGB.js","webpack:///./node_modules/konva/lib/filters/RGBA.js","webpack:///./node_modules/konva/lib/filters/Sepia.js","webpack:///./node_modules/konva/lib/filters/Solarize.js","webpack:///./node_modules/konva/lib/filters/Threshold.js","webpack:///./node_modules/konva/lib/_FullInternals.js","webpack:///./node_modules/konva/lib/index.js","webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createSuper.js","webpack:///./src/game/BoardComponent.js","webpack:///./src/game/utils/ImageLoader.js","webpack:///./src/game/Piece/PieceType.js","webpack:///./src/game/PlayerType.js","webpack:///./src/game/Piece/index.js","webpack:///./src/game/Slot/index.js","webpack:///./src/game/Board.js","webpack:///./src/views/Game.vue?3bb0","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./node_modules/core-js/internals/call-with-safe-iteration-closing.js","webpack:///./node_modules/core-js/modules/es.array.from.js","webpack:///./node_modules/core-js/modules/es.function.name.js","webpack:///./node_modules/core-js/internals/freezing.js","webpack:///./node_modules/core-js/modules/es.array.fill.js","webpack:///./node_modules/core-js/modules/es.symbol.iterator.js","webpack:///./node_modules/konva/lib/Global.js","webpack:///./node_modules/core-js/modules/es.symbol.description.js","webpack:///./node_modules/core-js/internals/internal-metadata.js","webpack:///./node_modules/core-js/modules/es.array.slice.js"],"names":["aFunction","isObject","slice","factories","construct","C","argsLength","args","list","i","Function","join","module","exports","bind","that","fn","this","partArgs","call","arguments","boundFunction","concat","length","apply","prototype","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","o","minLen","arrayLikeToArray","n","Object","toString","constructor","name","from","test","$","fails","toObject","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","FAILS_ON_PRIMITIVES","target","stat","forced","sham","getPrototypeOf","it","getBuiltIn","anObject","create","nativeConstruct","NEW_TARGET_BUG","F","ARGS_BUG","FORCED","Target","newTarget","$args","push","proto","instance","result","callWithSafeIterationClosing","isArrayIteratorMethod","toLength","createProperty","getIteratorMethod","arrayLike","step","iterator","next","value","O","argumentsLength","mapfn","undefined","mapping","iteratorMethod","index","done","collection","collectionStrong","init","$entries","entries","defineProperty","f","redefineAll","anInstance","iterate","defineIterator","setSpecies","DESCRIPTORS","fastKey","InternalStateModule","setInternalState","set","internalStateGetterFor","getterFor","getConstructor","wrapper","CONSTRUCTOR_NAME","IS_MAP","ADDER","iterable","type","first","last","size","AS_ENTRIES","getInternalState","define","key","previous","state","entry","getEntry","removed","clear","data","prev","forEach","callbackfn","has","get","add","setStrong","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","iterated","kind","global","isForced","redefine","InternalMetadataModule","checkCorrectnessOfIteration","setToStringTag","inheritIfRequired","common","indexOf","IS_WEAK","NativeConstructor","NativePrototype","Constructor","exported","fixMethod","KEY","nativeMethod","REPLACE","REQUIRED","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","dummy","objectKeys","toIndexedObject","propertyIsEnumerable","createMethod","TO_ENTRIES","keys","values","_typeof","obj","Symbol","__esModule","setPrototypeOf","$this","Wrapper","NewTarget","NewTargetPrototype","class","id","_createForOfIteratorHelper","allowArrayLike","isArray","unsupportedIterableToArray","s","e","_e","TypeError","err","normalCompletion","didErr","_e2","_classCallCheck","_defineProperties","props","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","Transform","m","dirty","tr","point","x","y","sx","sy","rad","c","Math","cos","sin","m11","m12","m21","m22","matrix","dx","dy","d","m0","m1","m2","m3","m4","m5","yt","xt","translate","a","b","delta","rotation","scaleX","scaleY","skewX","skewY","r","sqrt","acos","PI","Util","_getRotation","OBJECT_ARRAY","OBJECT_NUMBER","OBJECT_STRING","OBJECT_BOOLEAN","PI_OVER_DEG180","DEG180_OVER_PI","HASH","EMPTY_STRING","ZERO","KONVA_WARNING","KONVA_ERROR","RGB_PAREN","COLORS","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","transparent","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","RGB_REGEX","animQueue","req","requestAnimationFrame","setTimeout","nodeType","isNaN","isFinite","val","selector","firstChar","toUpperCase","number","callback","queue","cb","canvas","document","createElement","style","el","parentNode","url","imageObj","createImageElement","onload","src","g","hex","replace","bigint","parseInt","randColor","random","color","rgb","_hexToRgb","substring","substr","exec","str","_namedColorToRBA","_hex3ColorToRGBA","_hex6ColorToRGBA","_rgbColorToRGBA","_rgbaColorToRGBA","_hslColorToRGBA","toLowerCase","match","parts","split","map","Number","_","hsl","h","l","t2","t3","round","t1","r1","r2","width","height","retObj","_isPlainObject","cloneObject","_isArray","cloneArray","deg","warn","degToRad","radToDeg","radians","angleDeg","charAt","Error","console","error","showWarnings","func","left","right","x1","y1","x2","y2","x3","y3","dist","pd2","u","pt","line","isClosed","pc","MAX_VALUE","p1","p2","proj","_getProjectionToSegment","px","py","pdist","startArray","endArray","start","end","temp","newStart","pr","_getProjectionToLine","desc","visitedByCircularReferenceRemoval","hasOwnProperty","getOwnPropertyDescriptor","_isElement","_prepareToStringify","source","evt","touches","changedTouches","identifier","_formatValue","_isString","_isBoolean","RGBComponent","getNumberValidator","isUnminified","attr","_isNumber","getNumberOrArrayOfNumbersValidator","noOfElements","isNumber","isValidArray","getNumberOrAutoValidator","isAuto","getStringValidator","getStringOrGradientValidator","isString","isGradient","addColorStop","getNumberArrayValidator","item","getBooleanValidator","isBool","getComponentValidator","components","GET","SET","Factory","def","validator","after","addGetter","addSetter","addOverloadedGetterSetter","method","_capitalize","attrs","overWriteSetter","_setAttr","component","capitalize","getter","setter","ret","getAttr","basicValidator","oldVal","_fireChangeEvent","capitalizedAttr","message","methods","each","oldMethodName","newMethodName","oldGetter","oldSetter","deprecated","_filterUpToDate","simplifyArray","retArr","util","COMMA","OPEN_PAREN","CLOSE_PAREN","OPEN_PAREN_BRACKET","CLOSE_BRACKET_PAREN","SEMICOLON","DOUBLE_PAREN","EQUALS","CONTEXT_METHODS","CONTEXT_PROPERTIES","traceArrMax","_context","_canvas","getContext","enableTrace","traceArr","_enableTrace","shape","fillEnabled","_fill","hasStroke","_stroke","fillAfterStrokeEnabled","strokeShape","fillShape","relaxed","rounded","trace","floor","property","shift","pixelRatio","getCanvas","getPixelRatio","setTransform","bounds","clearRect","getWidth","getHeight","lineCap","getLineCap","setAttr","absOpacity","getAbsoluteOpacity","lineJoin","a0","a1","a2","a3","a4","a5","arc","arcTo","beginPath","bezierCurveTo","clip","closePath","createImageData","createLinearGradient","createPattern","createRadialGradient","a6","a7","a8","drawImage","ellipse","isPointInPath","path2d","fill","fillRect","strokeRect","text","maxWidth","fillText","measureText","getImageData","lineTo","moveTo","rect","putImageData","quadraticCurveTo","restore","rotate","save","scale","setLineDash","getLineDash","stroke","strokeText","transform","origSetter","methodName","origMethod","_trace","prop","node","op","globalCompositeOperation","SceneContext","_fillFunc","_getFillPattern","grd","_getLinearGradient","_getRadialGradient","hasColor","fillPriority","getFillPriority","_fillColor","hasPattern","getFillPatternImage","_fillPattern","hasLinearGradient","getFillLinearGradientColorStops","_fillLinearGradient","hasRadialGradient","getFillRadialGradientColorStops","_fillRadialGradient","getStrokeLinearGradientStartPoint","getStrokeLinearGradientEndPoint","colorStops","getStrokeLinearGradientColorStops","dash","strokeScaleEnabled","getStrokeScaleEnabled","_applyLineCap","dashEnabled","dashOffset","strokeWidth","getShadowForStrokeEnabled","_strokeLinearGradient","_strokeFunc","_a","_b","_c","getShadowRGBA","blur","getShadowBlur","offset","getShadowOffset","getAbsoluteScale","ratio","min","abs","HitContext","colorKey","_fillFuncHit","hasHitStroke","hitStrokeWidth","_strokeFuncHit","_pixelRatio","getDevicePixelRatio","createCanvasElement","context","devicePixelRatio","_global","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","config","isCache","conf","padding","margin","border","background","position","top","previousRatio","setSize","setWidth","setHeight","mimeType","quality","toDataURL","addGetterSetter","super","hitCanvas","DD","flag","_dragElements","elem","dragStatus","justDragged","Map","nodesToFireEvents","stage","getStage","setPointersPositions","pointerId","_getFirstPointerId","pos","_changedPointerPositions","find","dragDistance","distance","max","startPointerPos","startDrag","isDragging","_setDragPosition","fire","_mouseListenClick","_touchListenClick","_pointerListenClick","drawNode","getLayer","batchDraw","delete","isBrowser","window","addEventListener","_endDragBefore","_drag","_endDragAfter","ABSOLUTE_OPACITY","ALL_LISTENERS","ABSOLUTE_TRANSFORM","ABSOLUTE_SCALE","CANVAS","CHANGE","CHILDREN","KONVA","LISTENING","MOUSEENTER","MOUSELEAVE","SHAPE","SPACE","STAGE","TRANSFORM","UPPER_STAGE","VISIBLE","TRANSFORM_CHANGE_STR","idCounter","_id","eventListeners","_allEventListeners","parent","_cache","_attachedDepsListeners","_lastPos","_batchingTransformChange","_needClearTransformCache","_isUnderCache","_dragEventId","_shouldFireChangeEvents","setAttrs","privateGetter","cache","isTransform","invalid","deps","depsString","dep","on","_clearCache","_getCache","_clearSelfAndDescendantCache","_requestDraw","getClientRect","skipTransform","relativeTo","getParent","ceil","drawBorder","hitCanvasPixelRatio","cachedSceneCanvas","cachedFilterCanvas","cachedHitCanvas","sceneContext","hitContext","imageSmoothingEnabled","drawScene","drawHit","scene","filter","hit","minX","minY","maxX","maxY","points","trans","getAbsoluteTransform","transformed","_applyOpacity","_applyGlobalCompositeOperation","canvasCache","_getCanvasCache","cacheCanvas","_getCachedSceneCanvas","imageData","filters","cachedCanvas","sceneCanvas","filterCanvas","filterContext","evtStr","handler","_delegate","event","baseEvent","events","t","_off","off","stopNode","targets","findAncestors","currentTarget","stopDrag","_remove","_clearCaches","children","splice","_setChildrenIndices","remove","_isFunction","ancestors","_batchTransformChanges","_isListening","listening","_isVisible","visible","skipDragCheck","layer","layerUnderDrag","dragSkip","hitOnDragEnabled","isListening","isVisible","nodes","child","depth","getDepth","addChildren","getChildren","getPointerPosition","copy","invert","haveCachedParent","isCached","absoluteMatrix","getMatrix","absoluteTransform","getTranslation","origTrans","_clearTransform","_getAbsoluteTransform","_setTransform","setPosition","offsetX","offsetY","change","changeX","changeY","family","unshift","theta","zIndex","_getAbsoluteOpacity","opacity","newContainer","defaultValue","nonPlainObject","getAttrs","className","getClassName","JSON","stringify","includeSelf","res","_isMatch","ancestor","sel","selectorArr","isValidSelector","hasName","_getStage","eventType","bubble","_fireAndBubble","_fire","at","_eachAncestorReverse","transformsEnabled","multiply","getTransform","copyInto","reset","decompose","_getTransform","getAngle","skew","allListeners","listener","box","_toKonvaCanvas","_urlToImage","img","getDragDistance","evtName","evtListeners","newVal","oldName","newName","fullName","names","autoDrawEnabled","compareShape","shouldStop","isAncestorOf","stopBubble","cancelBubble","listeners","newEvents","oldEvents","topListeners","_getProtoListeners","selfListeners","ap","getAbsolutePosition","_getPointerById","bubbleEvent","_createDragElement","newNodePos","dbf","dragBoundFunc","bounded","setAbsolutePosition","draggable","_dragChange","_dragCleanup","shouldCheckButton","canDrag","dragButtons","hasDraggingChild","_listenDrag","dragElement","isReady","screenRect","haveIntersection","container","parse","_createNode","no","Class","_attrsAffectingSize","addComponentsGetterSetter","backCompat","rotateDeg","setRotationDeg","getRotationDeg","filterFunc","results","destroy","_validateAdd","hasChildren","destroyChildren","_generalFind","findOne","_descendants","valid","clone","intersects","can","caching","_drawCachedSceneCanvas","_drawChildren","shouldDrawHit","_drawCachedHitCanvas","drawMethod","clipWidth","clipHeight","clipFunc","hasClip","selfCache","clipX","clipY","hasComposition","selfRect","Infinity","skipShadow","skipStroke","shapes","hasVisible","_transformedRect","Captures","SUPPORT_POINTER_EVENTS","getCapturedShape","createEvent","hasPointerCapture","setPointerCapture","releaseCapture","PointerEvent","content","STRING","PX","MOUSEOUT","MOUSEOVER","MOUSEMOVE","MOUSEDOWN","MOUSEUP","POINTERMOVE","POINTERDOWN","POINTERUP","POINTERCANCEL","LOSTPOINTERCAPTURE","POINTEROUT","POINTERLEAVE","POINTEROVER","POINTERENTER","CONTEXTMENU","TOUCHSTART","TOUCHEND","TOUCHMOVE","TOUCHCANCEL","WHEEL","MAX_LAYERS_NUMBER","EVENTS","EVENTS_MAP","mouse","pointerclick","pointerdblclick","touch","pointer","getEventType","getEventsMap","pointerEventsEnabled","checkNoClip","NO_POINTERS_MESSAGE","stages","_pointerPositions","_buildDOM","_bindContentEvents","_resizeDOM","_checkVisibility","isLayer","getType","isFastLayer","throw","display","getElementsByClassName","getElementById","parentElement","removeChild","appendChild","layers","_isInDocument","p","layerCanvas","getIntersection","bufferCanvas","bufferHitCanvas","draw","rest","pointerenter","pointerover","evenType","targetShape","_getTargetShape","eventsEnabled","pointerout","pointerleave","pointerPos","triggeredOnShape","hasShape","capturePointerEventsEnabled","pointerdown","isTouch","preventDefault","cancelable","processedShapesIds","differentTarget","pointermove","clickStartShape","clickEndShape","fireDblClick","clearTimeout","dblClickWindow","pointerup","contentPosition","_getContentPosition","clientX","clientY","getBoundingClientRect","clientWidth","clientHeight","innerHTML","userSelect","setAttribute","HAS_SHADOW","SHADOW_RGBA","patternImage","linearGradient","radialGradient","dummyContext","getDummyContext","_clearHasShadowCache","_clearGetShadowRGBACache","_clearFillPatternCache","_clearLinearGradientCache","_clearRadialGradientCache","getRandomColor","sceneFunc","hitFunc","_hasShadow","shadowEnabled","shadowOpacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","__getFillPattern","fillPatternImage","ctx","pattern","fillPatternRepeat","fillPatternX","fillPatternY","fillPatternRotation","fillPatternScaleX","fillPatternScaleY","fillPatternOffsetX","fillPatternOffsetY","__getLinearGradient","fillLinearGradientColorStops","fillLinearGradientStartPoint","fillLinearGradientEndPoint","__getRadialGradient","fillRadialGradientColorStops","fillRadialGradientStartPoint","fillRadialGradientEndPoint","fillRadialGradientStartRadius","fillRadialGradientEndRadius","_getShadowRGBA","hasShadow","rgba","colorToRGBA","_calculate","strokeEnabled","strokeLinearGradientColorStops","forceFill","perfectDrawEnabled","hasFill","isTransparent","strokeForShadow","shadowForStrokeEnabled","_centroid","getSelfRect","applyStroke","fillAndStrokeWidth","fillAndStrokeHeight","applyShadow","preWidth","preHeight","blurRadius","roundingOffset","bufferContext","drawFunc","getSceneFunc","skipBuffer","cachingSelf","_useBufferCanvas","_applyLineJoin","_applyShadow","alphaThreshold","hitImageData","hitData","rgbColorKey","alpha","hitWidth","hitHeight","dashArray","getDashArray","setDashArray","getDrawFunc","setDrawFunc","drawHitFunc","getDrawHitFunc","setDrawHitFunc","BEFORE_DRAW","DRAW","INTERSECTION_OFFSETS","INTERSECTION_OFFSETS_LEN","_waitingForDraw","_setSmoothEnabled","createPNGStream","getHitCanvas","setZIndex","getNativeCanvasElement","insertBefore","moveToTop","moved","moveUp","moveDown","moveToBottom","requestAnimFrame","spiralSearchDistance","continueSearch","intersectionOffset","_getIntersection","antialiased","p3","_rgbToHex","clearBeforeDraw","hitGraphEnabled","added","now","performance","Date","getTime","animIdCounter","frame","time","timeDiff","lastTime","frameRate","setLayers","lays","animations","stop","_addAnimation","_removeAnimation","anim","_handleAnimation","layersLen","needRedraw","layerHash","_updateFrameObject","Anim","_runFrames","_animationLoop","animRunning","blacklist","duration","easing","onFinish","yoyo","PAUSED","PLAYING","REVERSING","colorAttrs","TweenEngine","propFunc","begin","finish","_pos","_change","prevPos","_time","_position","_startTime","_finish","pause","reverse","play","update","getTimer","onEnterFrame","getPosition","setTime","nodeId","Easings","Linear","getLayers","tween","_tweenFunc","_addListeners","tweens","_addAttr","onReset","onUpdate","diff","tweenId","trueEnd","trueStart","endRGBA","_prepareArrayForTween","closed","startRGBA","onPlay","onReverse","onPause","seek","thisId","to","params","asin","pow","BounceEaseOut","BounceEaseIn","Konva","_assign","Global","Node","Container","Stage","Layer","FastLayer","Group","Shape","Animation","Tween","Context","Canvas","angle","clockwise","outerRadius","innerRadius","fillStrokeShape","getControlPoints","x0","y0","d01","d12","fa","fb","p1x","p1y","p2x","p2y","expandPoints","tension","cp","allPoints","tp","bezier","getTensionPoints","_getTensionPoints","_getTensionPointsClosed","firstControlPoints","lastControlPoints","middle","dataArray","pathLength","parsePathData","ca","command","cx","cy","rx","ry","dTheta","psi","fs","inc","getPointOnEllipticalArc","getPointOnCubicBezier","ii","getPointOnLine","getPointOnQuadraticBezier","P1x","P1y","P2x","P2y","fromX","fromY","run","rise","ix","iy","getLineLength","pRise","pRun","pct","P3x","P3y","P4x","P4y","CB1","CB2","CB3","CB4","QB1","QB2","QB3","cosPsi","sinPsi","cs","cc","RegExp","coords","cpx","cpy","re","j","jlen","parsed","parseFloat","prevCmd","ctlPtx","ctlPty","cmd","startX","startY","idx","convertEndpointToCenterParameterization","calcLength","path","psiDeg","xp","yp","lambda","cxp","cyp","vMag","v","vRatio","vAngle","_sceneFunc","PI2","fromTension","pointerLength","lp","lastLength","atan2","pointerWidth","pointerAtEnding","pointerAtBeginning","isDashEnabled","lineRect","radius","radiusX","radiusY","_setImageLoad","image","cropWidth","cropHeight","cropX","cropY","crossOrigin","ATTR_CHANGE_LIST","CHANGE_KONVA","NONE","UP","RIGHT","DOWN","LEFT","attrChangeListLen","_sync","getText","pointerDirection","pointerHeight","tag","getTag","cornerRadius","topLeft","topRight","bottomLeft","bottomRight","direction","_getPoints","sides","PIx2","_updated","updated","frameIndex","isRunning","clearInterval","interval","_setInterval","animation","ix4","offsets","frameOffsets","ix2","setInterval","_updateIndex","getIndex","setIndex","numPoints","stringToArray","string","AUTO","CENTER","JUSTIFY","CONTEXT_2D","DASH","TEXT","TEXT_UPPER","TOP","BOTTOM","MIDDLE","NORMAL","PX_SPACE","WORD","CHAR","ELLIPSIS","normalizeFontFamily","fontFamily","trim","hasSpace","hasQuotes","_partialText","_partialTextX","_partialTextY","checkDefaultFill","_setTextData","textArr","textArrLen","fontSize","lineHeightPx","lineHeight","verticalAlign","alignY","align","totalWidth","letterSpacing","textDecoration","shouldUnderline","shouldLineThrough","translateY","lineTranslateX","lineTranslateY","_getContextFont","spacesNumber","oneWord","lineWidth","lastLine","strokeStyle","array","li","letter","measureSize","getTextWidth","textWidth","textHeight","metrics","font","fontStyle","fontVariant","_getTextWidth","lines","fixedWidth","fixedHeight","maxHeightPx","currentHeightPx","wrap","shouldWrap","wrapAtWord","shouldAddEllipsis","ellipsis","additionalWidth","low","high","matchWidth","mid","substrWidth","wrapIndex","nextChar","nextIsSpaceOrDash","lastIndexOf","trimRight","_addTextLine","haveSpace","trimLeft","partialText","dummyCanvas","textBaseline","glyphInfo","p0","setText","_getTextSize","kerningFunc","textFullWidth","fullPathWidth","pathCmd","charArr","pIndex","currentT","getNextPathSegment","pathData","findSegmentToFitCharacter","glyphWidth","currLen","attempts","cumulativePathLength","needNewSegment","testChar","lettersInOffset","k","kern","midpoint","transposeX","transposeY","info","EVENTS_NAME","NODES_RECT","ANGLES","TOUCH_DEVICE","getCursor","anchorName","_inRange","ANCHORS_NAMES","MAX_SAFE_INTEGER","getCenter","rotateAroundPoint","angleRad","assign","rotateAroundCenter","deltaRad","center","getSnap","snaps","newRotationRad","tol","snapped","absDiff","dif","_transforming","_createElements","_handleMouseMove","_handleMouseUp","getNode","setNode","setNodes","_nodes","detach","getAbsoluteRotation","additionalEvents","onChange","_resetTransformCache","_proxyDrag","elementsCreated","lastPos","otherNode","otherAbs","_movingAnchorName","__getNodeRect","rot","relative","ignoreStroke","absScale","absPos","totalPoints","_getNodeRect","_createBack","_createAnchor","anchor","self","_handleMouseDown","cursor","_cursorChange","back","rotateEnabled","rotateAnchorOffset","_sign","shouldOverdrawWholeArea","hypotenuse","_anchorDragOffset","newHypotenuse","anchorNode","pp","oldAbs","newAbs","keepProportion","keepRatio","shiftKey","centeredScaling","altKey","comparePoint","reverseX","reverseY","topOffsetX","topOffsetY","bottomOffsetX","bottomOffsetY","move","_fitNodesInto","oldRotation","newRotation","rotationSnapTolerance","snappedRot","rotationSnaps","_removeEvents","removeEventListener","newAttrs","oldAttrs","minSize","allowNegativeScale","flipEnabled","boundBoxFunc","baseSize","oldTr","newTr","parentTransform","localTransform","newLocalTransform","enabledAnchors","resizeEnabled","anchorSize","anchorStroke","anchorStrokeWidth","anchorFill","anchorCornerRadius","_batchChangeChild","borderEnabled","borderStroke","borderStrokeWidth","borderDash","validateAnchors","lineEnabled","rotateHandlerOffset","enabledHandlers","BlurStack","getAngleDeg","setAngleDeg","mul_table","shg_table","filterGaussBlurRGBA","yi","yw","r_sum","g_sum","b_sum","a_sum","r_out_sum","g_out_sum","b_out_sum","a_out_sum","r_in_sum","g_in_sum","b_in_sum","a_in_sum","pg","pb","pa","rbs","pixels","div","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","stackEnd","stack","stackIn","stackOut","mul_sum","shg_sum","Blur","afterSetFilter","Brighten","brightness","Contrast","adjust","contrast","nPixels","Emboss","strength","embossStrength","greyLevel","embossWhiteLevel","embossDirection","blend","embossBlend","dirY","dirX","w","w4","otherY","offsetYOther","otherX","offsetOther","dR","dG","dB","absDif","absG","absB","remap","fromValue","fromMin","fromMax","toMin","toMax","toValue","fromRange","toRange","Enhance","nSubPixels","rMin","rMax","gMin","gMax","bMin","bMax","enhanceAmount","enhance","rMid","rGoalMax","rGoalMin","gMid","gGoalMax","gGoalMin","bMid","bGoalMax","bGoalMin","Grayscale","HSL","saturation","hue","luminance","vsu","vsw","rr","rg","rb","gr","gg","gb","br","bg","bb","HSV","Invert","ToPolar","dst","opt","srcPixels","dstPixels","xSize","ySize","xMid","polarCenterX","yMid","polarCenterY","rSize","tSize","conversion","FromPolar","phaseShift","polarRotation","Kaleidoscope","xoff","srcPos","dstPos","power","kaleidoscopePower","kaleidoscopeAngle","tempCanvas","scratchData","minSectionSize","sectionSize","xStart","xEnd","xDelta","pixelAt","idata","rgbDistance","rgbMean","pTab","backgroundMask","threshold","rgbv_no","rgbv_ne","rgbv_so","rgbv_se","thres","mean","mask","applyMask","erodeMask","sw","sh","weights","side","halfSide","maskResult","so","scy","scx","srcOff","wt","dilateMask","smoothEdgeMask","Mask","Noise","amount","noise","half","Pixelate","xBinStart","xBinEnd","yBinStart","yBinEnd","xBin","yBin","pixelsInBin","pixelSize","nBinsX","nBinsY","Posterize","levels","RGB","RGBA","ia","Sepia","Solarize","Threshold","level","Arc","Arrow","Circle","Ellipse","Image","Label","Tag","Line","Path","Rect","RegularPolygon","Ring","Sprite","Star","Text","TextPath","Transformer","Wedge","Filters","_assertThisInitialized","ReferenceError","_setPrototypeOf","__proto__","_inherits","subClass","superClass","_getPrototypeOf","_isNativeReflectConstruct","Reflect","Proxy","Boolean","valueOf","_possibleConstructorReturn","assertThisInitialized","_createSuper","Derived","hasNativeReflectConstruct","isNativeReflectConstruct","Super","possibleConstructorReturn","BoardComponent","board","col","row","setBoardPosition","updateScreenPosition","boardPosition","screenPosition","getScreenPosition","group","ImageLoader","images","loaded","callbacks","handleImage","pop","CONFIG","PATH","SVG","PieceType","load","svg","compare","getValue","getTypeByValue","Types","HIDDEN","FLAG","PRIVATE","SERGEANT","LIEUTENANT2","LIEUTENANT1","CAPTAIN","MAJOR","LIEUTENANT_COLONEL","COLONEL","GENERAL1","GENERAL2","GENERAL3","GENERAL4","GENERAL5","SPY","getTypeById","getId","PlayerType","WHITE","BLACK","COLOR","DEFAULT","DARK","ID","RECT","TAG","Piece","playerType","pieceType","initKonva","piece","BOARD_CONFIG","SLOT","WIDTH","HEIGHT","initEvents","handlePieceClick","serialized","POTENTIAL","POTENTIAL_DARK","Slot","slot","handleSlotClick","getShape","BOARD","GAP","CELL","Board","socket","initSockets","boardRect","ROW","slots","loadBoard","payload","orientedColRow","col1","row1","col2","row2","handlePieceBattle","log","hasPieceAt","pieces","killPiece","movePiece","clickedPiece","unclickPiece","clickPiece","setPotentialsOf","dcol","drow","isInBound","setPotential","pCol","pRow","getDistance","emit","changeOrientation","orientation","oriented","changePlayerType","getPieceAt","deserialize","opponent","mounted","$socket","client","gameId","$route","query","userId","$router","computed","render","toAbsoluteIndex","endPos","iteratorClose","ENTRIES","INCORRECT_ITERATION","FunctionPrototype","FunctionPrototypeToString","nameRE","NAME","isExtensible","preventExtensions","addToUnscopables","defineWellKnownSymbol","PI_OVER_180","detectBrowser","glob","WorkerGlobalScope","version","param","_mouseInDblClickWindow","_touchInDblClickWindow","_pointerInDblClickWindow","_registerNode","NodeClass","_injectGlobal","copyConstructorProperties","NativeSymbol","description","EmptyStringDescriptionStore","SymbolWrapper","String","symbolPrototype","symbolToString","native","regexp","symbol","hiddenKeys","uid","FREEZING","METADATA","setMetadata","objectID","weakData","getWeakData","onFreeze","meta","wellKnownSymbol","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","SPECIES","nativeSlice","fin"],"mappings":"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1c,KAAK+9C,OAAOrhC,EAAS,ICpB7B,SAASgzC,KACL1vD,KAAKkO,EAAI,EACTlO,KAAKqa,EAAI,EACTra,KAAK2N,EAAI,EACT3N,KAAK0N,EAAI,EACT1N,KAAK4D,KAAO,KDkBhB,GAAMpD,UAAU26B,UAAY,QAC5B,GAAM36B,UAAUqsC,WAAY,EAC5B,GAAMrsC,UAAU4/B,oBAAsB,CAAC,UACvC,eAAc,IACdne,EAAQmN,gBAAgB,GAAO,SAAU,EAAG1O,KAC5CuB,EAAQmN,gBAAgB,GAAO,QAAS,EAAG1O,KAC3CuB,EAAQmN,gBAAgB,GAAO,aAAa,GAC5CnN,EAAQqe,WAAW,GAAO,CACtBjjB,SAAU,QACVsyC,YAAa,WACbC,YAAa,aC1BjB,IAAIC,GAAY,CACZ,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KAEAC,GAAY,CACZ,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEJ,SAASC,GAAoBv5B,EAAWunB,GACpC,IACI/xC,EAAGC,EAAGzM,EAAGknC,EAAGiW,EAAIqT,EAAIC,EAAIC,EAAOC,EAAOC,EAAOC,EAAOC,EAAWC,EAAWC,EAAWC,EAAWC,EAAUC,EAAUC,EAAUC,EAAUpxC,EAAIqxC,EAAIC,EAAIC,EAAIC,EADxJC,EAAS16B,EAAU3vB,KAAM4V,EAAQ+Z,EAAU/Z,MAAOC,EAAS8Z,EAAU9Z,OAErEy0C,EAAMpT,EAASA,EAAS,EAAGqT,EAAc30C,EAAQ,EAAG40C,EAAe30C,EAAS,EAAG40C,EAAcvT,EAAS,EAAGwT,EAAaD,GAAeA,EAAc,GAAM,EAAGE,EAAa,IAAI9B,GAAa+B,EAAW,KAAMC,EAAQF,EAAYG,EAAU,KAAMC,EAAW,KAAMC,EAAUhC,GAAU9R,GAAS+T,EAAUhC,GAAU/R,GACrT,IAAKv+C,EAAI,EAAGA,EAAI2xD,EAAK3xD,IACjBkyD,EAAQA,EAAM9tD,KAAO,IAAI8rD,GACrBlwD,IAAM8xD,IACNG,EAAWC,GAKnB,IAFAA,EAAM9tD,KAAO4tD,EACbvB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","file":"js/chunk-1e62d086.fafe39ec.js","sourcesContent":["'use strict';\nvar aFunction = require('../internals/a-function');\nvar isObject = require('../internals/is-object');\n\nvar slice = [].slice;\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!(argsLength in factories)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func -- we have no proper alternatives, IE8- only\n    factories[argsLength] = Function('C,a', 'return new C(' + list.join(',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.es/ecma262/#sec-function.prototype.bind\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = slice.call(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = partArgs.concat(slice.call(arguments));\n    return this instanceof boundFunction ? construct(fn, args.length, args) : fn.apply(that, args);\n  };\n  if (isObject(fn.prototype)) boundFunction.prototype = fn.prototype;\n  return boundFunction;\n};\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aFunction = require('../internals/a-function');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar bind = require('../internals/function-bind');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\n\n// `Reflect.construct` method\n// https://tc39.es/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","'use strict';\nvar bind = require('../internals/function-bind-context');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\n// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var C = typeof this == 'function' ? this : Array;\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = iteratorMethod.call(O);\n    next = iterator.next;\n    result = new C();\n    for (;!(step = next.call(iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = toLength(O.length);\n    result = new C(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.es/ecma262/#sec-map-objects\nmodule.exports = collection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, CONSTRUCTOR_NAME);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(C.prototype, {\n      // `{ Map, Set }.prototype.clear()` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.clear\n      // https://tc39.es/ecma262/#sec-set.prototype.clear\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // `{ Map, Set }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.delete\n      // https://tc39.es/ecma262/#sec-set.prototype.delete\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // `{ Map, Set }.prototype.forEach(callbackfn, thisArg = undefined)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.foreach\n      // https://tc39.es/ecma262/#sec-set.prototype.foreach\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // `{ Map, Set}.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.has\n      // https://tc39.es/ecma262/#sec-set.prototype.has\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(C.prototype, IS_MAP ? {\n      // `Map.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.get\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // `Map.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.set\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // `Set.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-set.prototype.add\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(C.prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return C;\n  },\n  setStrong: function (C, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // `{ Map, Set }.prototype.{ keys, values, entries, @@iterator }()` methods\n    // https://tc39.es/ecma262/#sec-map.prototype.entries\n    // https://tc39.es/ecma262/#sec-map.prototype.keys\n    // https://tc39.es/ecma262/#sec-map.prototype.values\n    // https://tc39.es/ecma262/#sec-map.prototype-@@iterator\n    // https://tc39.es/ecma262/#sec-set.prototype.entries\n    // https://tc39.es/ecma262/#sec-set.prototype.keys\n    // https://tc39.es/ecma262/#sec-set.prototype.values\n    // https://tc39.es/ecma262/#sec-set.prototype-@@iterator\n    defineIterator(C, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // `{ Map, Set }.prototype[@@species]` accessors\n    // https://tc39.es/ecma262/#sec-get-map-@@species\n    // https://tc39.es/ecma262/#sec-get-set-@@species\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var nativeMethod = NativePrototype[KEY];\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        nativeMethod.call(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        nativeMethod.call(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  var REPLACE = isForced(\n    CONSTRUCTOR_NAME,\n    typeof NativeConstructor != 'function' || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n      new NativeConstructor().entries().next();\n    }))\n  );\n\n  if (REPLACE) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.REQUIRED = true;\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new -- required for testing\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, Constructor, CONSTRUCTOR_NAME);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.es/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.es/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    typeof (NewTarget = dummy.constructor) == 'function' &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","<template>\n  <div class=\"game\">\n      <!-- <p v-if=\"opponent.username\">OPPONENT: {{ opponent.username }}</p> -->\n      <div id=\"game-container\"></div>\n      <!-- <p>{{ username }}</p> -->\n  </div>\n</template>\n\n<script>\nimport { Board } from '@/game/Board'\nimport { mapGetters } from 'vuex';\n\nexport default {\n  name: 'Game',\n  data() {\n    return {\n      opponent: {},\n    }\n  },\n  mounted() {\n    new Board(this.$socket.client, 'game-container', 0, 0, 8, 9);\n    \n    this.$socket.client.emit(\"join-game\", {\n      gameId: this.$route.query.gameId,\n      userId: this.userId,\n    }, () => {\n      this.$router.push({ name: 'Lobby' });\n    });\n\n    this.$socket.client.on(\"set-opponent\", (opponent) => {\n      this.opponent = opponent;\n    });\n  },\n  computed: {\n    ...mapGetters(['username', 'userId']),\n  },\n  methods: {\n  }\n}\n</script>\n\n<style>\n\n</style>","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { Konva } from './Global.js';\nexport class Transform {\n    constructor(m = [1, 0, 0, 1, 0, 0]) {\n        this.dirty = false;\n        this.m = (m && m.slice()) || [1, 0, 0, 1, 0, 0];\n    }\n    reset() {\n        this.m[0] = 1;\n        this.m[1] = 0;\n        this.m[2] = 0;\n        this.m[3] = 1;\n        this.m[4] = 0;\n        this.m[5] = 0;\n    }\n    copy() {\n        return new Transform(this.m);\n    }\n    copyInto(tr) {\n        tr.m[0] = this.m[0];\n        tr.m[1] = this.m[1];\n        tr.m[2] = this.m[2];\n        tr.m[3] = this.m[3];\n        tr.m[4] = this.m[4];\n        tr.m[5] = this.m[5];\n    }\n    point(point) {\n        var m = this.m;\n        return {\n            x: m[0] * point.x + m[2] * point.y + m[4],\n            y: m[1] * point.x + m[3] * point.y + m[5],\n        };\n    }\n    translate(x, y) {\n        this.m[4] += this.m[0] * x + this.m[2] * y;\n        this.m[5] += this.m[1] * x + this.m[3] * y;\n        return this;\n    }\n    scale(sx, sy) {\n        this.m[0] *= sx;\n        this.m[1] *= sx;\n        this.m[2] *= sy;\n        this.m[3] *= sy;\n        return this;\n    }\n    rotate(rad) {\n        var c = Math.cos(rad);\n        var s = Math.sin(rad);\n        var m11 = this.m[0] * c + this.m[2] * s;\n        var m12 = this.m[1] * c + this.m[3] * s;\n        var m21 = this.m[0] * -s + this.m[2] * c;\n        var m22 = this.m[1] * -s + this.m[3] * c;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    getTranslation() {\n        return {\n            x: this.m[4],\n            y: this.m[5],\n        };\n    }\n    skew(sx, sy) {\n        var m11 = this.m[0] + this.m[2] * sy;\n        var m12 = this.m[1] + this.m[3] * sy;\n        var m21 = this.m[2] + this.m[0] * sx;\n        var m22 = this.m[3] + this.m[1] * sx;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    multiply(matrix) {\n        var m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n        var m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n        var m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n        var m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n        var dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n        var dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        this.m[4] = dx;\n        this.m[5] = dy;\n        return this;\n    }\n    invert() {\n        var d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n        var m0 = this.m[3] * d;\n        var m1 = -this.m[1] * d;\n        var m2 = -this.m[2] * d;\n        var m3 = this.m[0] * d;\n        var m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n        var m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n        this.m[0] = m0;\n        this.m[1] = m1;\n        this.m[2] = m2;\n        this.m[3] = m3;\n        this.m[4] = m4;\n        this.m[5] = m5;\n        return this;\n    }\n    getMatrix() {\n        return this.m;\n    }\n    setAbsolutePosition(x, y) {\n        var m0 = this.m[0], m1 = this.m[1], m2 = this.m[2], m3 = this.m[3], m4 = this.m[4], m5 = this.m[5], yt = (m0 * (y - m5) - m1 * (x - m4)) / (m0 * m3 - m1 * m2), xt = (x - m4 - m2 * yt) / m0;\n        return this.translate(xt, yt);\n    }\n    decompose() {\n        var a = this.m[0];\n        var b = this.m[1];\n        var c = this.m[2];\n        var d = this.m[3];\n        var e = this.m[4];\n        var f = this.m[5];\n        var delta = a * d - b * c;\n        let result = {\n            x: e,\n            y: f,\n            rotation: 0,\n            scaleX: 0,\n            scaleY: 0,\n            skewX: 0,\n            skewY: 0,\n        };\n        if (a != 0 || b != 0) {\n            var r = Math.sqrt(a * a + b * b);\n            result.rotation = b > 0 ? Math.acos(a / r) : -Math.acos(a / r);\n            result.scaleX = r;\n            result.scaleY = delta / r;\n            result.skewX = (a * c + b * d) / delta;\n            result.skewY = 0;\n        }\n        else if (c != 0 || d != 0) {\n            var s = Math.sqrt(c * c + d * d);\n            result.rotation =\n                Math.PI / 2 - (d > 0 ? Math.acos(-c / s) : -Math.acos(c / s));\n            result.scaleX = delta / s;\n            result.scaleY = s;\n            result.skewX = 0;\n            result.skewY = (a * c + b * d) / delta;\n        }\n        else {\n        }\n        result.rotation = Util._getRotation(result.rotation);\n        return result;\n    }\n}\nvar OBJECT_ARRAY = '[object Array]', OBJECT_NUMBER = '[object Number]', OBJECT_STRING = '[object String]', OBJECT_BOOLEAN = '[object Boolean]', PI_OVER_DEG180 = Math.PI / 180, DEG180_OVER_PI = 180 / Math.PI, HASH = '#', EMPTY_STRING = '', ZERO = '0', KONVA_WARNING = 'Konva warning: ', KONVA_ERROR = 'Konva error: ', RGB_PAREN = 'rgb(', COLORS = {\n    aliceblue: [240, 248, 255],\n    antiquewhite: [250, 235, 215],\n    aqua: [0, 255, 255],\n    aquamarine: [127, 255, 212],\n    azure: [240, 255, 255],\n    beige: [245, 245, 220],\n    bisque: [255, 228, 196],\n    black: [0, 0, 0],\n    blanchedalmond: [255, 235, 205],\n    blue: [0, 0, 255],\n    blueviolet: [138, 43, 226],\n    brown: [165, 42, 42],\n    burlywood: [222, 184, 135],\n    cadetblue: [95, 158, 160],\n    chartreuse: [127, 255, 0],\n    chocolate: [210, 105, 30],\n    coral: [255, 127, 80],\n    cornflowerblue: [100, 149, 237],\n    cornsilk: [255, 248, 220],\n    crimson: [220, 20, 60],\n    cyan: [0, 255, 255],\n    darkblue: [0, 0, 139],\n    darkcyan: [0, 139, 139],\n    darkgoldenrod: [184, 132, 11],\n    darkgray: [169, 169, 169],\n    darkgreen: [0, 100, 0],\n    darkgrey: [169, 169, 169],\n    darkkhaki: [189, 183, 107],\n    darkmagenta: [139, 0, 139],\n    darkolivegreen: [85, 107, 47],\n    darkorange: [255, 140, 0],\n    darkorchid: [153, 50, 204],\n    darkred: [139, 0, 0],\n    darksalmon: [233, 150, 122],\n    darkseagreen: [143, 188, 143],\n    darkslateblue: [72, 61, 139],\n    darkslategray: [47, 79, 79],\n    darkslategrey: [47, 79, 79],\n    darkturquoise: [0, 206, 209],\n    darkviolet: [148, 0, 211],\n    deeppink: [255, 20, 147],\n    deepskyblue: [0, 191, 255],\n    dimgray: [105, 105, 105],\n    dimgrey: [105, 105, 105],\n    dodgerblue: [30, 144, 255],\n    firebrick: [178, 34, 34],\n    floralwhite: [255, 255, 240],\n    forestgreen: [34, 139, 34],\n    fuchsia: [255, 0, 255],\n    gainsboro: [220, 220, 220],\n    ghostwhite: [248, 248, 255],\n    gold: [255, 215, 0],\n    goldenrod: [218, 165, 32],\n    gray: [128, 128, 128],\n    green: [0, 128, 0],\n    greenyellow: [173, 255, 47],\n    grey: [128, 128, 128],\n    honeydew: [240, 255, 240],\n    hotpink: [255, 105, 180],\n    indianred: [205, 92, 92],\n    indigo: [75, 0, 130],\n    ivory: [255, 255, 240],\n    khaki: [240, 230, 140],\n    lavender: [230, 230, 250],\n    lavenderblush: [255, 240, 245],\n    lawngreen: [124, 252, 0],\n    lemonchiffon: [255, 250, 205],\n    lightblue: [173, 216, 230],\n    lightcoral: [240, 128, 128],\n    lightcyan: [224, 255, 255],\n    lightgoldenrodyellow: [250, 250, 210],\n    lightgray: [211, 211, 211],\n    lightgreen: [144, 238, 144],\n    lightgrey: [211, 211, 211],\n    lightpink: [255, 182, 193],\n    lightsalmon: [255, 160, 122],\n    lightseagreen: [32, 178, 170],\n    lightskyblue: [135, 206, 250],\n    lightslategray: [119, 136, 153],\n    lightslategrey: [119, 136, 153],\n    lightsteelblue: [176, 196, 222],\n    lightyellow: [255, 255, 224],\n    lime: [0, 255, 0],\n    limegreen: [50, 205, 50],\n    linen: [250, 240, 230],\n    magenta: [255, 0, 255],\n    maroon: [128, 0, 0],\n    mediumaquamarine: [102, 205, 170],\n    mediumblue: [0, 0, 205],\n    mediumorchid: [186, 85, 211],\n    mediumpurple: [147, 112, 219],\n    mediumseagreen: [60, 179, 113],\n    mediumslateblue: [123, 104, 238],\n    mediumspringgreen: [0, 250, 154],\n    mediumturquoise: [72, 209, 204],\n    mediumvioletred: [199, 21, 133],\n    midnightblue: [25, 25, 112],\n    mintcream: [245, 255, 250],\n    mistyrose: [255, 228, 225],\n    moccasin: [255, 228, 181],\n    navajowhite: [255, 222, 173],\n    navy: [0, 0, 128],\n    oldlace: [253, 245, 230],\n    olive: [128, 128, 0],\n    olivedrab: [107, 142, 35],\n    orange: [255, 165, 0],\n    orangered: [255, 69, 0],\n    orchid: [218, 112, 214],\n    palegoldenrod: [238, 232, 170],\n    palegreen: [152, 251, 152],\n    paleturquoise: [175, 238, 238],\n    palevioletred: [219, 112, 147],\n    papayawhip: [255, 239, 213],\n    peachpuff: [255, 218, 185],\n    peru: [205, 133, 63],\n    pink: [255, 192, 203],\n    plum: [221, 160, 203],\n    powderblue: [176, 224, 230],\n    purple: [128, 0, 128],\n    rebeccapurple: [102, 51, 153],\n    red: [255, 0, 0],\n    rosybrown: [188, 143, 143],\n    royalblue: [65, 105, 225],\n    saddlebrown: [139, 69, 19],\n    salmon: [250, 128, 114],\n    sandybrown: [244, 164, 96],\n    seagreen: [46, 139, 87],\n    seashell: [255, 245, 238],\n    sienna: [160, 82, 45],\n    silver: [192, 192, 192],\n    skyblue: [135, 206, 235],\n    slateblue: [106, 90, 205],\n    slategray: [119, 128, 144],\n    slategrey: [119, 128, 144],\n    snow: [255, 255, 250],\n    springgreen: [0, 255, 127],\n    steelblue: [70, 130, 180],\n    tan: [210, 180, 140],\n    teal: [0, 128, 128],\n    thistle: [216, 191, 216],\n    transparent: [255, 255, 255, 0],\n    tomato: [255, 99, 71],\n    turquoise: [64, 224, 208],\n    violet: [238, 130, 238],\n    wheat: [245, 222, 179],\n    white: [255, 255, 255],\n    whitesmoke: [245, 245, 245],\n    yellow: [255, 255, 0],\n    yellowgreen: [154, 205, 5],\n}, RGB_REGEX = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/, animQueue = [];\nconst req = (typeof requestAnimationFrame !== 'undefined' && requestAnimationFrame) ||\n    function (f) {\n        setTimeout(f, 60);\n    };\nexport const Util = {\n    _isElement(obj) {\n        return !!(obj && obj.nodeType == 1);\n    },\n    _isFunction(obj) {\n        return !!(obj && obj.constructor && obj.call && obj.apply);\n    },\n    _isPlainObject(obj) {\n        return !!obj && obj.constructor === Object;\n    },\n    _isArray(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_ARRAY;\n    },\n    _isNumber(obj) {\n        return (Object.prototype.toString.call(obj) === OBJECT_NUMBER &&\n            !isNaN(obj) &&\n            isFinite(obj));\n    },\n    _isString(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_STRING;\n    },\n    _isBoolean(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_BOOLEAN;\n    },\n    isObject(val) {\n        return val instanceof Object;\n    },\n    isValidSelector(selector) {\n        if (typeof selector !== 'string') {\n            return false;\n        }\n        var firstChar = selector[0];\n        return (firstChar === '#' ||\n            firstChar === '.' ||\n            firstChar === firstChar.toUpperCase());\n    },\n    _sign(number) {\n        if (number === 0) {\n            return 1;\n        }\n        if (number > 0) {\n            return 1;\n        }\n        else {\n            return -1;\n        }\n    },\n    requestAnimFrame(callback) {\n        animQueue.push(callback);\n        if (animQueue.length === 1) {\n            req(function () {\n                const queue = animQueue;\n                animQueue = [];\n                queue.forEach(function (cb) {\n                    cb();\n                });\n            });\n        }\n    },\n    createCanvasElement() {\n        var canvas = document.createElement('canvas');\n        try {\n            canvas.style = canvas.style || {};\n        }\n        catch (e) { }\n        return canvas;\n    },\n    createImageElement() {\n        return document.createElement('img');\n    },\n    _isInDocument(el) {\n        while ((el = el.parentNode)) {\n            if (el == document) {\n                return true;\n            }\n        }\n        return false;\n    },\n    _urlToImage(url, callback) {\n        var imageObj = Util.createImageElement();\n        imageObj.onload = function () {\n            callback(imageObj);\n        };\n        imageObj.src = url;\n    },\n    _rgbToHex(r, g, b) {\n        return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n    },\n    _hexToRgb(hex) {\n        hex = hex.replace(HASH, EMPTY_STRING);\n        var bigint = parseInt(hex, 16);\n        return {\n            r: (bigint >> 16) & 255,\n            g: (bigint >> 8) & 255,\n            b: bigint & 255,\n        };\n    },\n    getRandomColor() {\n        var randColor = ((Math.random() * 0xffffff) << 0).toString(16);\n        while (randColor.length < 6) {\n            randColor = ZERO + randColor;\n        }\n        return HASH + randColor;\n    },\n    getRGB(color) {\n        var rgb;\n        if (color in COLORS) {\n            rgb = COLORS[color];\n            return {\n                r: rgb[0],\n                g: rgb[1],\n                b: rgb[2],\n            };\n        }\n        else if (color[0] === HASH) {\n            return this._hexToRgb(color.substring(1));\n        }\n        else if (color.substr(0, 4) === RGB_PAREN) {\n            rgb = RGB_REGEX.exec(color.replace(/ /g, ''));\n            return {\n                r: parseInt(rgb[1], 10),\n                g: parseInt(rgb[2], 10),\n                b: parseInt(rgb[3], 10),\n            };\n        }\n        else {\n            return {\n                r: 0,\n                g: 0,\n                b: 0,\n            };\n        }\n    },\n    colorToRGBA(str) {\n        str = str || 'black';\n        return (Util._namedColorToRBA(str) ||\n            Util._hex3ColorToRGBA(str) ||\n            Util._hex6ColorToRGBA(str) ||\n            Util._rgbColorToRGBA(str) ||\n            Util._rgbaColorToRGBA(str) ||\n            Util._hslColorToRGBA(str));\n    },\n    _namedColorToRBA(str) {\n        var c = COLORS[str.toLowerCase()];\n        if (!c) {\n            return null;\n        }\n        return {\n            r: c[0],\n            g: c[1],\n            b: c[2],\n            a: 1,\n        };\n    },\n    _rgbColorToRGBA(str) {\n        if (str.indexOf('rgb(') === 0) {\n            str = str.match(/rgb\\(([^)]+)\\)/)[1];\n            var parts = str.split(/ *, */).map(Number);\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: 1,\n            };\n        }\n    },\n    _rgbaColorToRGBA(str) {\n        if (str.indexOf('rgba(') === 0) {\n            str = str.match(/rgba\\(([^)]+)\\)/)[1];\n            var parts = str.split(/ *, */).map(Number);\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: parts[3],\n            };\n        }\n    },\n    _hex6ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 7) {\n            return {\n                r: parseInt(str.slice(1, 3), 16),\n                g: parseInt(str.slice(3, 5), 16),\n                b: parseInt(str.slice(5, 7), 16),\n                a: 1,\n            };\n        }\n    },\n    _hex3ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 4) {\n            return {\n                r: parseInt(str[1] + str[1], 16),\n                g: parseInt(str[2] + str[2], 16),\n                b: parseInt(str[3] + str[3], 16),\n                a: 1,\n            };\n        }\n    },\n    _hslColorToRGBA(str) {\n        if (/hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.test(str)) {\n            const [_, ...hsl] = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(str);\n            const h = Number(hsl[0]) / 360;\n            const s = Number(hsl[1]) / 100;\n            const l = Number(hsl[2]) / 100;\n            let t2;\n            let t3;\n            let val;\n            if (s === 0) {\n                val = l * 255;\n                return {\n                    r: Math.round(val),\n                    g: Math.round(val),\n                    b: Math.round(val),\n                    a: 1,\n                };\n            }\n            if (l < 0.5) {\n                t2 = l * (1 + s);\n            }\n            else {\n                t2 = l + s - l * s;\n            }\n            const t1 = 2 * l - t2;\n            const rgb = [0, 0, 0];\n            for (let i = 0; i < 3; i++) {\n                t3 = h + (1 / 3) * -(i - 1);\n                if (t3 < 0) {\n                    t3++;\n                }\n                if (t3 > 1) {\n                    t3--;\n                }\n                if (6 * t3 < 1) {\n                    val = t1 + (t2 - t1) * 6 * t3;\n                }\n                else if (2 * t3 < 1) {\n                    val = t2;\n                }\n                else if (3 * t3 < 2) {\n                    val = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n                }\n                else {\n                    val = t1;\n                }\n                rgb[i] = val * 255;\n            }\n            return {\n                r: Math.round(rgb[0]),\n                g: Math.round(rgb[1]),\n                b: Math.round(rgb[2]),\n                a: 1,\n            };\n        }\n    },\n    haveIntersection(r1, r2) {\n        return !(r2.x > r1.x + r1.width ||\n            r2.x + r2.width < r1.x ||\n            r2.y > r1.y + r1.height ||\n            r2.y + r2.height < r1.y);\n    },\n    cloneObject(obj) {\n        var retObj = {};\n        for (var key in obj) {\n            if (this._isPlainObject(obj[key])) {\n                retObj[key] = this.cloneObject(obj[key]);\n            }\n            else if (this._isArray(obj[key])) {\n                retObj[key] = this.cloneArray(obj[key]);\n            }\n            else {\n                retObj[key] = obj[key];\n            }\n        }\n        return retObj;\n    },\n    cloneArray(arr) {\n        return arr.slice(0);\n    },\n    degToRad(deg) {\n        return deg * PI_OVER_DEG180;\n    },\n    radToDeg(rad) {\n        return rad * DEG180_OVER_PI;\n    },\n    _degToRad(deg) {\n        Util.warn('Util._degToRad is removed. Please use public Util.degToRad instead.');\n        return Util.degToRad(deg);\n    },\n    _radToDeg(rad) {\n        Util.warn('Util._radToDeg is removed. Please use public Util.radToDeg instead.');\n        return Util.radToDeg(rad);\n    },\n    _getRotation(radians) {\n        return Konva.angleDeg ? Util.radToDeg(radians) : radians;\n    },\n    _capitalize(str) {\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n    throw(str) {\n        throw new Error(KONVA_ERROR + str);\n    },\n    error(str) {\n        console.error(KONVA_ERROR + str);\n    },\n    warn(str) {\n        if (!Konva.showWarnings) {\n            return;\n        }\n        console.warn(KONVA_WARNING + str);\n    },\n    each(obj, func) {\n        for (var key in obj) {\n            func(key, obj[key]);\n        }\n    },\n    _inRange(val, left, right) {\n        return left <= val && val < right;\n    },\n    _getProjectionToSegment(x1, y1, x2, y2, x3, y3) {\n        var x, y, dist;\n        var pd2 = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n        if (pd2 == 0) {\n            x = x1;\n            y = y1;\n            dist = (x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2);\n        }\n        else {\n            var u = ((x3 - x1) * (x2 - x1) + (y3 - y1) * (y2 - y1)) / pd2;\n            if (u < 0) {\n                x = x1;\n                y = y1;\n                dist = (x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3);\n            }\n            else if (u > 1.0) {\n                x = x2;\n                y = y2;\n                dist = (x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3);\n            }\n            else {\n                x = x1 + u * (x2 - x1);\n                y = y1 + u * (y2 - y1);\n                dist = (x - x3) * (x - x3) + (y - y3) * (y - y3);\n            }\n        }\n        return [x, y, dist];\n    },\n    _getProjectionToLine(pt, line, isClosed) {\n        var pc = Util.cloneObject(pt);\n        var dist = Number.MAX_VALUE;\n        line.forEach(function (p1, i) {\n            if (!isClosed && i === line.length - 1) {\n                return;\n            }\n            var p2 = line[(i + 1) % line.length];\n            var proj = Util._getProjectionToSegment(p1.x, p1.y, p2.x, p2.y, pt.x, pt.y);\n            var px = proj[0], py = proj[1], pdist = proj[2];\n            if (pdist < dist) {\n                pc.x = px;\n                pc.y = py;\n                dist = pdist;\n            }\n        });\n        return pc;\n    },\n    _prepareArrayForTween(startArray, endArray, isClosed) {\n        var n, start = [], end = [];\n        if (startArray.length > endArray.length) {\n            var temp = endArray;\n            endArray = startArray;\n            startArray = temp;\n        }\n        for (n = 0; n < startArray.length; n += 2) {\n            start.push({\n                x: startArray[n],\n                y: startArray[n + 1],\n            });\n        }\n        for (n = 0; n < endArray.length; n += 2) {\n            end.push({\n                x: endArray[n],\n                y: endArray[n + 1],\n            });\n        }\n        var newStart = [];\n        end.forEach(function (point) {\n            var pr = Util._getProjectionToLine(point, start, isClosed);\n            newStart.push(pr.x);\n            newStart.push(pr.y);\n        });\n        return newStart;\n    },\n    _prepareToStringify(obj) {\n        var desc;\n        obj.visitedByCircularReferenceRemoval = true;\n        for (var key in obj) {\n            if (!(obj.hasOwnProperty(key) && obj[key] && typeof obj[key] == 'object')) {\n                continue;\n            }\n            desc = Object.getOwnPropertyDescriptor(obj, key);\n            if (obj[key].visitedByCircularReferenceRemoval ||\n                Util._isElement(obj[key])) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n            else if (Util._prepareToStringify(obj[key]) === null) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        delete obj.visitedByCircularReferenceRemoval;\n        return obj;\n    },\n    _assign(target, source) {\n        for (var key in source) {\n            target[key] = source[key];\n        }\n        return target;\n    },\n    _getFirstPointerId(evt) {\n        if (!evt.touches) {\n            return 999;\n        }\n        else {\n            return evt.changedTouches[0].identifier;\n        }\n    },\n};\n","import { Konva } from './Global.js';\nimport { Util } from './Util.js';\nfunction _formatValue(val) {\n    if (Util._isString(val)) {\n        return '\"' + val + '\"';\n    }\n    if (Object.prototype.toString.call(val) === '[object Number]') {\n        return val;\n    }\n    if (Util._isBoolean(val)) {\n        return val;\n    }\n    return Object.prototype.toString.call(val);\n}\nexport function RGBComponent(val) {\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    return Math.round(val);\n}\nexport function alphaComponent(val) {\n    if (val > 1) {\n        return 1;\n    }\n    else if (val < 0.0001) {\n        return 0.0001;\n    }\n    return val;\n}\nexport function getNumberValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isNumber(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number.');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberOrArrayOfNumbersValidator(noOfElements) {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            let isNumber = Util._isNumber(val);\n            let isValidArray = Util._isArray(val) && val.length == noOfElements;\n            if (!isNumber && !isValidArray) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or Array<number>(' +\n                    noOfElements +\n                    ')');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberOrAutoValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            var isNumber = Util._isNumber(val);\n            var isAuto = val === 'auto';\n            if (!(isNumber || isAuto)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or \"auto\".');\n            }\n            return val;\n        };\n    }\n}\nexport function getStringValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isString(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string.');\n            }\n            return val;\n        };\n    }\n}\nexport function getStringOrGradientValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            const isString = Util._isString(val);\n            const isGradient = Object.prototype.toString.call(val) === '[object CanvasGradient]' ||\n                (val && val.addColorStop);\n            if (!(isString || isGradient)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string or a native gradient.');\n            }\n            return val;\n        };\n    }\n}\nexport function getFunctionValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isFunction(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a function.');\n            }\n            return val;\n        };\n    }\n}\nexport function getNumberArrayValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util._isArray(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a array of numbers.');\n            }\n            else {\n                val.forEach(function (item) {\n                    if (!Util._isNumber(item)) {\n                        Util.warn('\"' +\n                            attr +\n                            '\" attribute has non numeric element ' +\n                            item +\n                            '. Make sure that all elements are numbers.');\n                    }\n                });\n            }\n            return val;\n        };\n    }\n}\nexport function getBooleanValidator() {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            var isBool = val === true || val === false;\n            if (!isBool) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a boolean.');\n            }\n            return val;\n        };\n    }\n}\nexport function getComponentValidator(components) {\n    if (Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util.isObject(val)) {\n                Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be an object with properties ' +\n                    components);\n            }\n            return val;\n        };\n    }\n}\n","import { Util } from './Util.js';\nimport { getComponentValidator } from './Validators.js';\nvar GET = 'get', SET = 'set';\nexport const Factory = {\n    addGetterSetter(constructor, attr, def, validator, after) {\n        Factory.addGetter(constructor, attr, def);\n        Factory.addSetter(constructor, attr, validator, after);\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addGetter(constructor, attr, def) {\n        var method = GET + Util._capitalize(attr);\n        constructor.prototype[method] =\n            constructor.prototype[method] ||\n                function () {\n                    var val = this.attrs[attr];\n                    return val === undefined ? def : val;\n                };\n    },\n    addSetter(constructor, attr, validator, after) {\n        var method = SET + Util._capitalize(attr);\n        if (!constructor.prototype[method]) {\n            Factory.overWriteSetter(constructor, attr, validator, after);\n        }\n    },\n    overWriteSetter(constructor, attr, validator, after) {\n        var method = SET + Util._capitalize(attr);\n        constructor.prototype[method] = function (val) {\n            if (validator && val !== undefined && val !== null) {\n                val = validator.call(this, val, attr);\n            }\n            this._setAttr(attr, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n    },\n    addComponentsGetterSetter(constructor, attr, components, validator, after) {\n        var len = components.length, capitalize = Util._capitalize, getter = GET + capitalize(attr), setter = SET + capitalize(attr), n, component;\n        constructor.prototype[getter] = function () {\n            var ret = {};\n            for (n = 0; n < len; n++) {\n                component = components[n];\n                ret[component] = this.getAttr(attr + capitalize(component));\n            }\n            return ret;\n        };\n        var basicValidator = getComponentValidator(components);\n        constructor.prototype[setter] = function (val) {\n            var oldVal = this.attrs[attr], key;\n            if (validator) {\n                val = validator.call(this, val);\n            }\n            if (basicValidator) {\n                basicValidator.call(this, val, attr);\n            }\n            for (key in val) {\n                if (!val.hasOwnProperty(key)) {\n                    continue;\n                }\n                this._setAttr(attr + capitalize(key), val[key]);\n            }\n            this._fireChangeEvent(attr, oldVal, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addOverloadedGetterSetter(constructor, attr) {\n        var capitalizedAttr = Util._capitalize(attr), setter = SET + capitalizedAttr, getter = GET + capitalizedAttr;\n        constructor.prototype[attr] = function () {\n            if (arguments.length) {\n                this[setter](arguments[0]);\n                return this;\n            }\n            return this[getter]();\n        };\n    },\n    addDeprecatedGetterSetter(constructor, attr, def, validator) {\n        Util.error('Adding deprecated ' + attr);\n        var method = GET + Util._capitalize(attr);\n        var message = attr +\n            ' property is deprecated and will be removed soon. Look at Konva change log for more information.';\n        constructor.prototype[method] = function () {\n            Util.error(message);\n            var val = this.attrs[attr];\n            return val === undefined ? def : val;\n        };\n        Factory.addSetter(constructor, attr, validator, function () {\n            Util.error(message);\n        });\n        Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    backCompat(constructor, methods) {\n        Util.each(methods, function (oldMethodName, newMethodName) {\n            var method = constructor.prototype[newMethodName];\n            var oldGetter = GET + Util._capitalize(oldMethodName);\n            var oldSetter = SET + Util._capitalize(oldMethodName);\n            function deprecated() {\n                method.apply(this, arguments);\n                Util.error('\"' +\n                    oldMethodName +\n                    '\" method is deprecated and will be removed soon. Use \"\"' +\n                    newMethodName +\n                    '\" instead.');\n            }\n            constructor.prototype[oldMethodName] = deprecated;\n            constructor.prototype[oldGetter] = deprecated;\n            constructor.prototype[oldSetter] = deprecated;\n        });\n    },\n    afterSetFilter() {\n        this._filterUpToDate = false;\n    },\n};\n","import { Util } from './Util.js';\nimport { Konva } from './Global.js';\nfunction simplifyArray(arr) {\n    var retArr = [], len = arr.length, util = Util, n, val;\n    for (n = 0; n < len; n++) {\n        val = arr[n];\n        if (util._isNumber(val)) {\n            val = Math.round(val * 1000) / 1000;\n        }\n        else if (!util._isString(val)) {\n            val = val + '';\n        }\n        retArr.push(val);\n    }\n    return retArr;\n}\nvar COMMA = ',', OPEN_PAREN = '(', CLOSE_PAREN = ')', OPEN_PAREN_BRACKET = '([', CLOSE_BRACKET_PAREN = '])', SEMICOLON = ';', DOUBLE_PAREN = '()', EQUALS = '=', CONTEXT_METHODS = [\n    'arc',\n    'arcTo',\n    'beginPath',\n    'bezierCurveTo',\n    'clearRect',\n    'clip',\n    'closePath',\n    'createLinearGradient',\n    'createPattern',\n    'createRadialGradient',\n    'drawImage',\n    'ellipse',\n    'fill',\n    'fillText',\n    'getImageData',\n    'createImageData',\n    'lineTo',\n    'moveTo',\n    'putImageData',\n    'quadraticCurveTo',\n    'rect',\n    'restore',\n    'rotate',\n    'save',\n    'scale',\n    'setLineDash',\n    'setTransform',\n    'stroke',\n    'strokeText',\n    'transform',\n    'translate',\n];\nvar CONTEXT_PROPERTIES = [\n    'fillStyle',\n    'strokeStyle',\n    'shadowColor',\n    'shadowBlur',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'lineCap',\n    'lineDashOffset',\n    'lineJoin',\n    'lineWidth',\n    'miterLimit',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'globalAlpha',\n    'globalCompositeOperation',\n    'imageSmoothingEnabled',\n];\nconst traceArrMax = 100;\nexport class Context {\n    constructor(canvas) {\n        this.canvas = canvas;\n        this._context = canvas._canvas.getContext('2d');\n        if (Konva.enableTrace) {\n            this.traceArr = [];\n            this._enableTrace();\n        }\n    }\n    fillShape(shape) {\n        if (shape.fillEnabled()) {\n            this._fill(shape);\n        }\n    }\n    _fill(shape) {\n    }\n    strokeShape(shape) {\n        if (shape.hasStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n    }\n    fillStrokeShape(shape) {\n        if (shape.attrs.fillAfterStrokeEnabled) {\n            this.strokeShape(shape);\n            this.fillShape(shape);\n        }\n        else {\n            this.fillShape(shape);\n            this.strokeShape(shape);\n        }\n    }\n    getTrace(relaxed, rounded) {\n        var traceArr = this.traceArr, len = traceArr.length, str = '', n, trace, method, args;\n        for (n = 0; n < len; n++) {\n            trace = traceArr[n];\n            method = trace.method;\n            if (method) {\n                args = trace.args;\n                str += method;\n                if (relaxed) {\n                    str += DOUBLE_PAREN;\n                }\n                else {\n                    if (Util._isArray(args[0])) {\n                        str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n                    }\n                    else {\n                        if (rounded) {\n                            args = args.map((a) => typeof a === 'number' ? Math.floor(a) : a);\n                        }\n                        str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n                    }\n                }\n            }\n            else {\n                str += trace.property;\n                if (!relaxed) {\n                    str += EQUALS + trace.val;\n                }\n            }\n            str += SEMICOLON;\n        }\n        return str;\n    }\n    clearTrace() {\n        this.traceArr = [];\n    }\n    _trace(str) {\n        var traceArr = this.traceArr, len;\n        traceArr.push(str);\n        len = traceArr.length;\n        if (len >= traceArrMax) {\n            traceArr.shift();\n        }\n    }\n    reset() {\n        var pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    clear(bounds) {\n        var canvas = this.getCanvas();\n        if (bounds) {\n            this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n        }\n        else {\n            this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n        }\n    }\n    _applyLineCap(shape) {\n        var lineCap = shape.getLineCap();\n        if (lineCap) {\n            this.setAttr('lineCap', lineCap);\n        }\n    }\n    _applyOpacity(shape) {\n        var absOpacity = shape.getAbsoluteOpacity();\n        if (absOpacity !== 1) {\n            this.setAttr('globalAlpha', absOpacity);\n        }\n    }\n    _applyLineJoin(shape) {\n        var lineJoin = shape.attrs.lineJoin;\n        if (lineJoin) {\n            this.setAttr('lineJoin', lineJoin);\n        }\n    }\n    setAttr(attr, val) {\n        this._context[attr] = val;\n    }\n    arc(a0, a1, a2, a3, a4, a5) {\n        this._context.arc(a0, a1, a2, a3, a4, a5);\n    }\n    arcTo(a0, a1, a2, a3, a4) {\n        this._context.arcTo(a0, a1, a2, a3, a4);\n    }\n    beginPath() {\n        this._context.beginPath();\n    }\n    bezierCurveTo(a0, a1, a2, a3, a4, a5) {\n        this._context.bezierCurveTo(a0, a1, a2, a3, a4, a5);\n    }\n    clearRect(a0, a1, a2, a3) {\n        this._context.clearRect(a0, a1, a2, a3);\n    }\n    clip() {\n        this._context.clip();\n    }\n    closePath() {\n        this._context.closePath();\n    }\n    createImageData(a0, a1) {\n        var a = arguments;\n        if (a.length === 2) {\n            return this._context.createImageData(a0, a1);\n        }\n        else if (a.length === 1) {\n            return this._context.createImageData(a0);\n        }\n    }\n    createLinearGradient(a0, a1, a2, a3) {\n        return this._context.createLinearGradient(a0, a1, a2, a3);\n    }\n    createPattern(a0, a1) {\n        return this._context.createPattern(a0, a1);\n    }\n    createRadialGradient(a0, a1, a2, a3, a4, a5) {\n        return this._context.createRadialGradient(a0, a1, a2, a3, a4, a5);\n    }\n    drawImage(a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        var a = arguments, _context = this._context;\n        if (a.length === 3) {\n            _context.drawImage(a0, a1, a2);\n        }\n        else if (a.length === 5) {\n            _context.drawImage(a0, a1, a2, a3, a4);\n        }\n        else if (a.length === 9) {\n            _context.drawImage(a0, a1, a2, a3, a4, a5, a6, a7, a8);\n        }\n    }\n    ellipse(a0, a1, a2, a3, a4, a5, a6, a7) {\n        this._context.ellipse(a0, a1, a2, a3, a4, a5, a6, a7);\n    }\n    isPointInPath(x, y) {\n        return this._context.isPointInPath(x, y);\n    }\n    fill(path2d) {\n        if (path2d) {\n            this._context.fill(path2d);\n        }\n        else {\n            this._context.fill();\n        }\n    }\n    fillRect(x, y, width, height) {\n        this._context.fillRect(x, y, width, height);\n    }\n    strokeRect(x, y, width, height) {\n        this._context.strokeRect(x, y, width, height);\n    }\n    fillText(text, x, y, maxWidth) {\n        if (maxWidth) {\n            this._context.fillText(text, x, y, maxWidth);\n        }\n        else {\n            this._context.fillText(text, x, y);\n        }\n    }\n    measureText(text) {\n        return this._context.measureText(text);\n    }\n    getImageData(a0, a1, a2, a3) {\n        return this._context.getImageData(a0, a1, a2, a3);\n    }\n    lineTo(a0, a1) {\n        this._context.lineTo(a0, a1);\n    }\n    moveTo(a0, a1) {\n        this._context.moveTo(a0, a1);\n    }\n    rect(a0, a1, a2, a3) {\n        this._context.rect(a0, a1, a2, a3);\n    }\n    putImageData(a0, a1, a2) {\n        this._context.putImageData(a0, a1, a2);\n    }\n    quadraticCurveTo(a0, a1, a2, a3) {\n        this._context.quadraticCurveTo(a0, a1, a2, a3);\n    }\n    restore() {\n        this._context.restore();\n    }\n    rotate(a0) {\n        this._context.rotate(a0);\n    }\n    save() {\n        this._context.save();\n    }\n    scale(a0, a1) {\n        this._context.scale(a0, a1);\n    }\n    setLineDash(a0) {\n        if (this._context.setLineDash) {\n            this._context.setLineDash(a0);\n        }\n        else if ('mozDash' in this._context) {\n            this._context['mozDash'] = a0;\n        }\n        else if ('webkitLineDash' in this._context) {\n            this._context['webkitLineDash'] = a0;\n        }\n    }\n    getLineDash() {\n        return this._context.getLineDash();\n    }\n    setTransform(a0, a1, a2, a3, a4, a5) {\n        this._context.setTransform(a0, a1, a2, a3, a4, a5);\n    }\n    stroke(path2d) {\n        if (path2d) {\n            this._context.stroke(path2d);\n        }\n        else {\n            this._context.stroke();\n        }\n    }\n    strokeText(a0, a1, a2, a3) {\n        this._context.strokeText(a0, a1, a2, a3);\n    }\n    transform(a0, a1, a2, a3, a4, a5) {\n        this._context.transform(a0, a1, a2, a3, a4, a5);\n    }\n    translate(a0, a1) {\n        this._context.translate(a0, a1);\n    }\n    _enableTrace() {\n        var that = this, len = CONTEXT_METHODS.length, origSetter = this.setAttr, n, args;\n        var func = function (methodName) {\n            var origMethod = that[methodName], ret;\n            that[methodName] = function () {\n                args = simplifyArray(Array.prototype.slice.call(arguments, 0));\n                ret = origMethod.apply(that, arguments);\n                that._trace({\n                    method: methodName,\n                    args: args,\n                });\n                return ret;\n            };\n        };\n        for (n = 0; n < len; n++) {\n            func(CONTEXT_METHODS[n]);\n        }\n        that.setAttr = function () {\n            origSetter.apply(that, arguments);\n            var prop = arguments[0];\n            var val = arguments[1];\n            if (prop === 'shadowOffsetX' ||\n                prop === 'shadowOffsetY' ||\n                prop === 'shadowBlur') {\n                val = val / this.canvas.getPixelRatio();\n            }\n            that._trace({\n                property: prop,\n                val: val,\n            });\n        };\n    }\n    _applyGlobalCompositeOperation(node) {\n        const op = node.attrs.globalCompositeOperation;\n        var def = !op || op === 'source-over';\n        if (!def) {\n            this.setAttr('globalCompositeOperation', op);\n        }\n    }\n}\nCONTEXT_PROPERTIES.forEach(function (prop) {\n    Object.defineProperty(Context.prototype, prop, {\n        get() {\n            return this._context[prop];\n        },\n        set(val) {\n            this._context[prop] = val;\n        },\n    });\n});\nexport class SceneContext extends Context {\n    _fillColor(shape) {\n        var fill = shape.fill();\n        this.setAttr('fillStyle', fill);\n        shape._fillFunc(this);\n    }\n    _fillPattern(shape) {\n        this.setAttr('fillStyle', shape._getFillPattern());\n        shape._fillFunc(this);\n    }\n    _fillLinearGradient(shape) {\n        var grd = shape._getLinearGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fillRadialGradient(shape) {\n        var grd = shape._getRadialGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fill(shape) {\n        var hasColor = shape.fill(), fillPriority = shape.getFillPriority();\n        if (hasColor && fillPriority === 'color') {\n            this._fillColor(shape);\n            return;\n        }\n        var hasPattern = shape.getFillPatternImage();\n        if (hasPattern && fillPriority === 'pattern') {\n            this._fillPattern(shape);\n            return;\n        }\n        var hasLinearGradient = shape.getFillLinearGradientColorStops();\n        if (hasLinearGradient && fillPriority === 'linear-gradient') {\n            this._fillLinearGradient(shape);\n            return;\n        }\n        var hasRadialGradient = shape.getFillRadialGradientColorStops();\n        if (hasRadialGradient && fillPriority === 'radial-gradient') {\n            this._fillRadialGradient(shape);\n            return;\n        }\n        if (hasColor) {\n            this._fillColor(shape);\n        }\n        else if (hasPattern) {\n            this._fillPattern(shape);\n        }\n        else if (hasLinearGradient) {\n            this._fillLinearGradient(shape);\n        }\n        else if (hasRadialGradient) {\n            this._fillRadialGradient(shape);\n        }\n    }\n    _strokeLinearGradient(shape) {\n        var start = shape.getStrokeLinearGradientStartPoint(), end = shape.getStrokeLinearGradientEndPoint(), colorStops = shape.getStrokeLinearGradientColorStops(), grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n        if (colorStops) {\n            for (var n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            this.setAttr('strokeStyle', grd);\n        }\n    }\n    _stroke(shape) {\n        var dash = shape.dash(), strokeScaleEnabled = shape.getStrokeScaleEnabled();\n        if (shape.hasStroke()) {\n            if (!strokeScaleEnabled) {\n                this.save();\n                var pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            if (dash && shape.dashEnabled()) {\n                this.setLineDash(dash);\n                this.setAttr('lineDashOffset', shape.dashOffset());\n            }\n            this.setAttr('lineWidth', shape.strokeWidth());\n            if (!shape.getShadowForStrokeEnabled()) {\n                this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n            }\n            var hasLinearGradient = shape.getStrokeLinearGradientColorStops();\n            if (hasLinearGradient) {\n                this._strokeLinearGradient(shape);\n            }\n            else {\n                this.setAttr('strokeStyle', shape.stroke());\n            }\n            shape._strokeFunc(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n    _applyShadow(shape) {\n        var _a, _b, _c;\n        var color = (_a = shape.getShadowRGBA()) !== null && _a !== void 0 ? _a : 'black', blur = (_b = shape.getShadowBlur()) !== null && _b !== void 0 ? _b : 5, offset = (_c = shape.getShadowOffset()) !== null && _c !== void 0 ? _c : {\n            x: 0,\n            y: 0,\n        }, scale = shape.getAbsoluteScale(), ratio = this.canvas.getPixelRatio(), scaleX = scale.x * ratio, scaleY = scale.y * ratio;\n        this.setAttr('shadowColor', color);\n        this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));\n        this.setAttr('shadowOffsetX', offset.x * scaleX);\n        this.setAttr('shadowOffsetY', offset.y * scaleY);\n    }\n}\nexport class HitContext extends Context {\n    _fill(shape) {\n        this.save();\n        this.setAttr('fillStyle', shape.colorKey);\n        shape._fillFuncHit(this);\n        this.restore();\n    }\n    strokeShape(shape) {\n        if (shape.hasHitStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n        if (shape.hasHitStroke()) {\n            var strokeScaleEnabled = shape.getStrokeScaleEnabled();\n            if (!strokeScaleEnabled) {\n                this.save();\n                var pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            var hitStrokeWidth = shape.hitStrokeWidth();\n            var strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;\n            this.setAttr('lineWidth', strokeWidth);\n            this.setAttr('strokeStyle', shape.colorKey);\n            shape._strokeFuncHit(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n}\n","import { Util } from './Util.js';\nimport { SceneContext, HitContext } from './Context.js';\nimport { Konva } from './Global.js';\nimport { Factory } from './Factory.js';\nimport { getNumberValidator } from './Validators.js';\nvar _pixelRatio;\nfunction getDevicePixelRatio() {\n    if (_pixelRatio) {\n        return _pixelRatio;\n    }\n    var canvas = Util.createCanvasElement();\n    var context = canvas.getContext('2d');\n    _pixelRatio = (function () {\n        var devicePixelRatio = Konva._global.devicePixelRatio || 1, backingStoreRatio = context.webkitBackingStorePixelRatio ||\n            context.mozBackingStorePixelRatio ||\n            context.msBackingStorePixelRatio ||\n            context.oBackingStorePixelRatio ||\n            context.backingStorePixelRatio ||\n            1;\n        return devicePixelRatio / backingStoreRatio;\n    })();\n    return _pixelRatio;\n}\nexport class Canvas {\n    constructor(config) {\n        this.pixelRatio = 1;\n        this.width = 0;\n        this.height = 0;\n        this.isCache = false;\n        var conf = config || {};\n        var pixelRatio = conf.pixelRatio || Konva.pixelRatio || getDevicePixelRatio();\n        this.pixelRatio = pixelRatio;\n        this._canvas = Util.createCanvasElement();\n        this._canvas.style.padding = '0';\n        this._canvas.style.margin = '0';\n        this._canvas.style.border = '0';\n        this._canvas.style.background = 'transparent';\n        this._canvas.style.position = 'absolute';\n        this._canvas.style.top = '0';\n        this._canvas.style.left = '0';\n    }\n    getContext() {\n        return this.context;\n    }\n    getPixelRatio() {\n        return this.pixelRatio;\n    }\n    setPixelRatio(pixelRatio) {\n        var previousRatio = this.pixelRatio;\n        this.pixelRatio = pixelRatio;\n        this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n    }\n    setWidth(width) {\n        this.width = this._canvas.width = width * this.pixelRatio;\n        this._canvas.style.width = width + 'px';\n        var pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    setHeight(height) {\n        this.height = this._canvas.height = height * this.pixelRatio;\n        this._canvas.style.height = height + 'px';\n        var pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    getWidth() {\n        return this.width;\n    }\n    getHeight() {\n        return this.height;\n    }\n    setSize(width, height) {\n        this.setWidth(width || 0);\n        this.setHeight(height || 0);\n    }\n    toDataURL(mimeType, quality) {\n        try {\n            return this._canvas.toDataURL(mimeType, quality);\n        }\n        catch (e) {\n            try {\n                return this._canvas.toDataURL();\n            }\n            catch (err) {\n                Util.error('Unable to get data URL. ' +\n                    err.message +\n                    ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                return '';\n            }\n        }\n    }\n}\nFactory.addGetterSetter(Canvas, 'pixelRatio', undefined, getNumberValidator());\nexport class SceneCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0 }) {\n        super(config);\n        this.context = new SceneContext(this);\n        this.setSize(config.width, config.height);\n    }\n}\nexport class HitCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0 }) {\n        super(config);\n        this.hitCanvas = true;\n        this.context = new HitContext(this);\n        this.setSize(config.width, config.height);\n    }\n}\n","import { Konva } from './Global.js';\nimport { Util } from './Util.js';\nexport const DD = {\n    get isDragging() {\n        var flag = false;\n        DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus === 'dragging') {\n                flag = true;\n            }\n        });\n        return flag;\n    },\n    justDragged: false,\n    get node() {\n        var node;\n        DD._dragElements.forEach((elem) => {\n            node = elem.node;\n        });\n        return node;\n    },\n    _dragElements: new Map(),\n    _drag(evt) {\n        const nodesToFireEvents = [];\n        DD._dragElements.forEach((elem, key) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            stage.setPointersPositions(evt);\n            if (elem.pointerId === undefined) {\n                elem.pointerId = Util._getFirstPointerId(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus !== 'dragging') {\n                var dragDistance = node.dragDistance();\n                var distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n                if (distance < dragDistance) {\n                    return;\n                }\n                node.startDrag({ evt });\n                if (!node.isDragging()) {\n                    return;\n                }\n            }\n            node._setDragPosition(evt, elem);\n            nodesToFireEvents.push(node);\n        });\n        nodesToFireEvents.forEach((node) => {\n            node.fire('dragmove', {\n                type: 'dragmove',\n                target: node,\n                evt: evt,\n            }, true);\n        });\n    },\n    _endDragBefore(evt) {\n        DD._dragElements.forEach((elem) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            if (evt) {\n                stage.setPointersPositions(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n                DD.justDragged = true;\n                Konva._mouseListenClick = false;\n                Konva._touchListenClick = false;\n                Konva._pointerListenClick = false;\n                elem.dragStatus = 'stopped';\n            }\n            const drawNode = elem.node.getLayer() ||\n                (elem.node instanceof Konva['Stage'] && elem.node);\n            if (drawNode) {\n                drawNode.batchDraw();\n            }\n        });\n    },\n    _endDragAfter(evt) {\n        DD._dragElements.forEach((elem, key) => {\n            if (elem.dragStatus === 'stopped') {\n                elem.node.fire('dragend', {\n                    type: 'dragend',\n                    target: elem.node,\n                    evt: evt,\n                }, true);\n            }\n            if (elem.dragStatus !== 'dragging') {\n                DD._dragElements.delete(key);\n            }\n        });\n    },\n};\nif (Konva.isBrowser) {\n    window.addEventListener('mouseup', DD._endDragBefore, true);\n    window.addEventListener('touchend', DD._endDragBefore, true);\n    window.addEventListener('mousemove', DD._drag);\n    window.addEventListener('touchmove', DD._drag);\n    window.addEventListener('mouseup', DD._endDragAfter, false);\n    window.addEventListener('touchend', DD._endDragAfter, false);\n}\n","import { Util, Transform } from './Util.js';\nimport { Factory } from './Factory.js';\nimport { SceneCanvas, HitCanvas } from './Canvas.js';\nimport { Konva } from './Global.js';\nimport { DD } from './DragAndDrop.js';\nimport { getNumberValidator, getStringValidator, getBooleanValidator, } from './Validators.js';\nvar ABSOLUTE_OPACITY = 'absoluteOpacity', ALL_LISTENERS = 'allEventListeners', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', TRANSFORM_CHANGE_STR = [\n    'xChange.konva',\n    'yChange.konva',\n    'scaleXChange.konva',\n    'scaleYChange.konva',\n    'skewXChange.konva',\n    'skewYChange.konva',\n    'rotationChange.konva',\n    'offsetXChange.konva',\n    'offsetYChange.konva',\n    'transformsEnabledChange.konva',\n].join(SPACE);\nlet idCounter = 1;\nexport class Node {\n    constructor(config) {\n        this._id = idCounter++;\n        this.eventListeners = {};\n        this.attrs = {};\n        this.index = 0;\n        this._allEventListeners = null;\n        this.parent = null;\n        this._cache = new Map();\n        this._attachedDepsListeners = new Map();\n        this._lastPos = null;\n        this._batchingTransformChange = false;\n        this._needClearTransformCache = false;\n        this._filterUpToDate = false;\n        this._isUnderCache = false;\n        this._dragEventId = null;\n        this._shouldFireChangeEvents = false;\n        this.setAttrs(config);\n        this._shouldFireChangeEvents = true;\n    }\n    hasChildren() {\n        return false;\n    }\n    _clearCache(attr) {\n        if ((attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM) &&\n            this._cache.get(attr)) {\n            this._cache.get(attr).dirty = true;\n        }\n        else if (attr) {\n            this._cache.delete(attr);\n        }\n        else {\n            this._cache.clear();\n        }\n    }\n    _getCache(attr, privateGetter) {\n        var cache = this._cache.get(attr);\n        var isTransform = attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM;\n        var invalid = cache === undefined || (isTransform && cache.dirty === true);\n        if (invalid) {\n            cache = privateGetter.call(this);\n            this._cache.set(attr, cache);\n        }\n        return cache;\n    }\n    _calculate(name, deps, getter) {\n        if (!this._attachedDepsListeners.get(name)) {\n            const depsString = deps.map((dep) => dep + 'Change.konva').join(SPACE);\n            this.on(depsString, () => {\n                this._clearCache(name);\n            });\n            this._attachedDepsListeners.set(name, true);\n        }\n        return this._getCache(name, getter);\n    }\n    _getCanvasCache() {\n        return this._cache.get(CANVAS);\n    }\n    _clearSelfAndDescendantCache(attr) {\n        this._clearCache(attr);\n        if (attr === ABSOLUTE_TRANSFORM) {\n            this.fire('absoluteTransformChange');\n        }\n    }\n    clearCache() {\n        this._cache.delete(CANVAS);\n        this._clearSelfAndDescendantCache();\n        this._requestDraw();\n        return this;\n    }\n    cache(config) {\n        var conf = config || {};\n        var rect = {};\n        if (conf.x === undefined ||\n            conf.y === undefined ||\n            conf.width === undefined ||\n            conf.height === undefined) {\n            rect = this.getClientRect({\n                skipTransform: true,\n                relativeTo: this.getParent(),\n            });\n        }\n        var width = Math.ceil(conf.width || rect.width), height = Math.ceil(conf.height || rect.height), pixelRatio = conf.pixelRatio, x = conf.x === undefined ? rect.x : conf.x, y = conf.y === undefined ? rect.y : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false, hitCanvasPixelRatio = conf.hitCanvasPixelRatio || 1;\n        if (!width || !height) {\n            Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\n            return;\n        }\n        width += offset * 2;\n        height += offset * 2;\n        x -= offset;\n        y -= offset;\n        var cachedSceneCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height,\n        }), cachedFilterCanvas = new SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: 0,\n            height: 0,\n        }), cachedHitCanvas = new HitCanvas({\n            pixelRatio: hitCanvasPixelRatio,\n            width: width,\n            height: height,\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\n        cachedHitCanvas.isCache = true;\n        cachedSceneCanvas.isCache = true;\n        this._cache.delete(CANVAS);\n        this._filterUpToDate = false;\n        if (conf.imageSmoothingEnabled === false) {\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\n        }\n        sceneContext.save();\n        hitContext.save();\n        sceneContext.translate(-x, -y);\n        hitContext.translate(-x, -y);\n        this._isUnderCache = true;\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this.drawScene(cachedSceneCanvas, this);\n        this.drawHit(cachedHitCanvas, this);\n        this._isUnderCache = false;\n        sceneContext.restore();\n        hitContext.restore();\n        if (drawBorder) {\n            sceneContext.save();\n            sceneContext.beginPath();\n            sceneContext.rect(0, 0, width, height);\n            sceneContext.closePath();\n            sceneContext.setAttr('strokeStyle', 'red');\n            sceneContext.setAttr('lineWidth', 5);\n            sceneContext.stroke();\n            sceneContext.restore();\n        }\n        this._cache.set(CANVAS, {\n            scene: cachedSceneCanvas,\n            filter: cachedFilterCanvas,\n            hit: cachedHitCanvas,\n            x: x,\n            y: y,\n        });\n        this._requestDraw();\n        return this;\n    }\n    isCached() {\n        return this._cache.has(CANVAS);\n    }\n    getClientRect(config) {\n        throw new Error('abstract \"getClientRect\" method call');\n    }\n    _transformedRect(rect, top) {\n        var points = [\n            { x: rect.x, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y + rect.height },\n            { x: rect.x, y: rect.y + rect.height },\n        ];\n        var minX, minY, maxX, maxY;\n        var trans = this.getAbsoluteTransform(top);\n        points.forEach(function (point) {\n            var transformed = trans.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    _drawCachedSceneCanvas(context) {\n        context.save();\n        context._applyOpacity(this);\n        context._applyGlobalCompositeOperation(this);\n        const canvasCache = this._getCanvasCache();\n        context.translate(canvasCache.x, canvasCache.y);\n        var cacheCanvas = this._getCachedSceneCanvas();\n        var ratio = cacheCanvas.pixelRatio;\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n        context.restore();\n    }\n    _drawCachedHitCanvas(context) {\n        var canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\n        context.save();\n        context.translate(canvasCache.x, canvasCache.y);\n        context.drawImage(hitCanvas._canvas, 0, 0, hitCanvas.width / hitCanvas.pixelRatio, hitCanvas.height / hitCanvas.pixelRatio);\n        context.restore();\n    }\n    _getCachedSceneCanvas() {\n        var filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\n        if (filters) {\n            if (!this._filterUpToDate) {\n                var ratio = sceneCanvas.pixelRatio;\n                filterCanvas.setSize(sceneCanvas.width / sceneCanvas.pixelRatio, sceneCanvas.height / sceneCanvas.pixelRatio);\n                try {\n                    len = filters.length;\n                    filterContext.clear();\n                    filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n                    imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n                    for (n = 0; n < len; n++) {\n                        filter = filters[n];\n                        if (typeof filter !== 'function') {\n                            Util.error('Filter should be type of function, but got ' +\n                                typeof filter +\n                                ' instead. Please check correct filters');\n                            continue;\n                        }\n                        filter.call(this, imageData);\n                        filterContext.putImageData(imageData, 0, 0);\n                    }\n                }\n                catch (e) {\n                    Util.error('Unable to apply filter. ' +\n                        e.message +\n                        ' This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                }\n                this._filterUpToDate = true;\n            }\n            return filterCanvas;\n        }\n        return sceneCanvas;\n    }\n    on(evtStr, handler) {\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (arguments.length === 3) {\n            return this._delegate.apply(this, arguments);\n        }\n        var events = evtStr.split(SPACE), len = events.length, n, event, parts, baseEvent, name;\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1] || '';\n            if (!this.eventListeners[baseEvent]) {\n                this.eventListeners[baseEvent] = [];\n            }\n            this.eventListeners[baseEvent].push({\n                name: name,\n                handler: handler,\n            });\n        }\n        return this;\n    }\n    off(evtStr, callback) {\n        var events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (!evtStr) {\n            for (t in this.eventListeners) {\n                this._off(t);\n            }\n        }\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1];\n            if (baseEvent) {\n                if (this.eventListeners[baseEvent]) {\n                    this._off(baseEvent, name, callback);\n                }\n            }\n            else {\n                for (t in this.eventListeners) {\n                    this._off(t, name, callback);\n                }\n            }\n        }\n        return this;\n    }\n    dispatchEvent(evt) {\n        var e = {\n            target: this,\n            type: evt.type,\n            evt: evt,\n        };\n        this.fire(evt.type, e);\n        return this;\n    }\n    addEventListener(type, handler) {\n        this.on(type, function (evt) {\n            handler.call(this, evt.evt);\n        });\n        return this;\n    }\n    removeEventListener(type) {\n        this.off(type);\n        return this;\n    }\n    _delegate(event, selector, handler) {\n        var stopNode = this;\n        this.on(event, function (evt) {\n            var targets = evt.target.findAncestors(selector, true, stopNode);\n            for (var i = 0; i < targets.length; i++) {\n                evt = Util.cloneObject(evt);\n                evt.currentTarget = targets[i];\n                handler.call(targets[i], evt);\n            }\n        });\n    }\n    remove() {\n        if (this.isDragging()) {\n            this.stopDrag();\n        }\n        DD._dragElements.delete(this._id);\n        this._remove();\n        return this;\n    }\n    _clearCaches() {\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this._clearSelfAndDescendantCache(STAGE);\n        this._clearSelfAndDescendantCache(VISIBLE);\n        this._clearSelfAndDescendantCache(LISTENING);\n    }\n    _remove() {\n        this._clearCaches();\n        var parent = this.getParent();\n        if (parent && parent.children) {\n            parent.children.splice(this.index, 1);\n            parent._setChildrenIndices();\n            this.parent = null;\n        }\n    }\n    destroy() {\n        this.remove();\n        return this;\n    }\n    getAttr(attr) {\n        var method = 'get' + Util._capitalize(attr);\n        if (Util._isFunction(this[method])) {\n            return this[method]();\n        }\n        return this.attrs[attr];\n    }\n    getAncestors() {\n        var parent = this.getParent(), ancestors = [];\n        while (parent) {\n            ancestors.push(parent);\n            parent = parent.getParent();\n        }\n        return ancestors;\n    }\n    getAttrs() {\n        return this.attrs || {};\n    }\n    setAttrs(config) {\n        this._batchTransformChanges(() => {\n            var key, method;\n            if (!config) {\n                return this;\n            }\n            for (key in config) {\n                if (key === CHILDREN) {\n                    continue;\n                }\n                method = SET + Util._capitalize(key);\n                if (Util._isFunction(this[method])) {\n                    this[method](config[key]);\n                }\n                else {\n                    this._setAttr(key, config[key]);\n                }\n            }\n        });\n        return this;\n    }\n    isListening() {\n        return this._getCache(LISTENING, this._isListening);\n    }\n    _isListening(relativeTo) {\n        const listening = this.listening();\n        if (!listening) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isListening(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    isVisible() {\n        return this._getCache(VISIBLE, this._isVisible);\n    }\n    _isVisible(relativeTo) {\n        const visible = this.visible();\n        if (!visible) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isVisible(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    shouldDrawHit(top, skipDragCheck = false) {\n        if (top) {\n            return this._isVisible(top) && this._isListening(top);\n        }\n        var layer = this.getLayer();\n        var layerUnderDrag = false;\n        DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus !== 'dragging') {\n                return;\n            }\n            else if (elem.node.nodeType === 'Stage') {\n                layerUnderDrag = true;\n            }\n            else if (elem.node.getLayer() === layer) {\n                layerUnderDrag = true;\n            }\n        });\n        var dragSkip = !skipDragCheck && !Konva.hitOnDragEnabled && layerUnderDrag;\n        return this.isListening() && this.isVisible() && !dragSkip;\n    }\n    show() {\n        this.visible(true);\n        return this;\n    }\n    hide() {\n        this.visible(false);\n        return this;\n    }\n    getZIndex() {\n        return this.index || 0;\n    }\n    getAbsoluteZIndex() {\n        var depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\n        function addChildren(children) {\n            nodes = [];\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                child = children[n];\n                index++;\n                if (child.nodeType !== SHAPE) {\n                    nodes = nodes.concat(child.getChildren().slice());\n                }\n                if (child._id === that._id) {\n                    n = len;\n                }\n            }\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                addChildren(nodes);\n            }\n        }\n        if (that.nodeType !== UPPER_STAGE) {\n            addChildren(that.getStage().getChildren());\n        }\n        return index;\n    }\n    getDepth() {\n        var depth = 0, parent = this.parent;\n        while (parent) {\n            depth++;\n            parent = parent.parent;\n        }\n        return depth;\n    }\n    _batchTransformChanges(func) {\n        this._batchingTransformChange = true;\n        func();\n        this._batchingTransformChange = false;\n        if (this._needClearTransformCache) {\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        }\n        this._needClearTransformCache = false;\n    }\n    setPosition(pos) {\n        this._batchTransformChanges(() => {\n            this.x(pos.x);\n            this.y(pos.y);\n        });\n        return this;\n    }\n    getPosition() {\n        return {\n            x: this.x(),\n            y: this.y(),\n        };\n    }\n    getRelativePointerPosition() {\n        if (!this.getStage()) {\n            return null;\n        }\n        var pos = this.getStage().getPointerPosition();\n        if (!pos) {\n            return null;\n        }\n        var transform = this.getAbsoluteTransform().copy();\n        transform.invert();\n        return transform.point(pos);\n    }\n    getAbsolutePosition(top) {\n        let haveCachedParent = false;\n        let parent = this.parent;\n        while (parent) {\n            if (parent.isCached()) {\n                haveCachedParent = true;\n                break;\n            }\n            parent = parent.parent;\n        }\n        if (haveCachedParent && !top) {\n            top = true;\n        }\n        var absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Transform(), offset = this.offset();\n        absoluteTransform.m = absoluteMatrix.slice();\n        absoluteTransform.translate(offset.x, offset.y);\n        return absoluteTransform.getTranslation();\n    }\n    setAbsolutePosition(pos) {\n        var origTrans = this._clearTransform();\n        this.attrs.x = origTrans.x;\n        this.attrs.y = origTrans.y;\n        delete origTrans.x;\n        delete origTrans.y;\n        this._clearCache(TRANSFORM);\n        var it = this._getAbsoluteTransform().copy();\n        it.invert();\n        it.translate(pos.x, pos.y);\n        pos = {\n            x: this.attrs.x + it.getTranslation().x,\n            y: this.attrs.y + it.getTranslation().y,\n        };\n        this._setTransform(origTrans);\n        this.setPosition({ x: pos.x, y: pos.y });\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        return this;\n    }\n    _setTransform(trans) {\n        var key;\n        for (key in trans) {\n            this.attrs[key] = trans[key];\n        }\n    }\n    _clearTransform() {\n        var trans = {\n            x: this.x(),\n            y: this.y(),\n            rotation: this.rotation(),\n            scaleX: this.scaleX(),\n            scaleY: this.scaleY(),\n            offsetX: this.offsetX(),\n            offsetY: this.offsetY(),\n            skewX: this.skewX(),\n            skewY: this.skewY(),\n        };\n        this.attrs.x = 0;\n        this.attrs.y = 0;\n        this.attrs.rotation = 0;\n        this.attrs.scaleX = 1;\n        this.attrs.scaleY = 1;\n        this.attrs.offsetX = 0;\n        this.attrs.offsetY = 0;\n        this.attrs.skewX = 0;\n        this.attrs.skewY = 0;\n        return trans;\n    }\n    move(change) {\n        var changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\n        if (changeX !== undefined) {\n            x += changeX;\n        }\n        if (changeY !== undefined) {\n            y += changeY;\n        }\n        this.setPosition({ x: x, y: y });\n        return this;\n    }\n    _eachAncestorReverse(func, top) {\n        var family = [], parent = this.getParent(), len, n;\n        if (top && top._id === this._id) {\n            return;\n        }\n        family.unshift(this);\n        while (parent && (!top || parent._id !== top._id)) {\n            family.unshift(parent);\n            parent = parent.parent;\n        }\n        len = family.length;\n        for (n = 0; n < len; n++) {\n            func(family[n]);\n        }\n    }\n    rotate(theta) {\n        this.rotation(this.rotation() + theta);\n        return this;\n    }\n    moveToTop() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToTop function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.push(this);\n        this.parent._setChildrenIndices();\n        return true;\n    }\n    moveUp() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveUp function is ignored.');\n            return false;\n        }\n        var index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index + 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveDown() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveDown function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index - 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (!this.parent) {\n            Util.warn('Node has no parent. moveToBottom function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.unshift(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    setZIndex(zIndex) {\n        if (!this.parent) {\n            Util.warn('Node has no parent. zIndex parameter is ignored.');\n            return this;\n        }\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\n            Util.warn('Unexpected value ' +\n                zIndex +\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\n                (this.parent.children.length - 1) +\n                '.');\n        }\n        var index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(zIndex, 0, this);\n        this.parent._setChildrenIndices();\n        return this;\n    }\n    getAbsoluteOpacity() {\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n    }\n    _getAbsoluteOpacity() {\n        var absOpacity = this.opacity();\n        var parent = this.getParent();\n        if (parent && !parent._isUnderCache) {\n            absOpacity *= parent.getAbsoluteOpacity();\n        }\n        return absOpacity;\n    }\n    moveTo(newContainer) {\n        if (this.getParent() !== newContainer) {\n            this._remove();\n            newContainer.add(this);\n        }\n        return this;\n    }\n    toObject() {\n        var obj = {}, attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\n        obj.attrs = {};\n        for (key in attrs) {\n            val = attrs[key];\n            nonPlainObject =\n                Util.isObject(val) && !Util._isPlainObject(val) && !Util._isArray(val);\n            if (nonPlainObject) {\n                continue;\n            }\n            getter = typeof this[key] === 'function' && this[key];\n            delete attrs[key];\n            defaultValue = getter ? getter.call(this) : null;\n            attrs[key] = val;\n            if (defaultValue !== val) {\n                obj.attrs[key] = val;\n            }\n        }\n        obj.className = this.getClassName();\n        return Util._prepareToStringify(obj);\n    }\n    toJSON() {\n        return JSON.stringify(this.toObject());\n    }\n    getParent() {\n        return this.parent;\n    }\n    findAncestors(selector, includeSelf, stopNode) {\n        var res = [];\n        if (includeSelf && this._isMatch(selector)) {\n            res.push(this);\n        }\n        var ancestor = this.parent;\n        while (ancestor) {\n            if (ancestor === stopNode) {\n                return res;\n            }\n            if (ancestor._isMatch(selector)) {\n                res.push(ancestor);\n            }\n            ancestor = ancestor.parent;\n        }\n        return res;\n    }\n    isAncestorOf(node) {\n        return false;\n    }\n    findAncestor(selector, includeSelf, stopNode) {\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\n    }\n    _isMatch(selector) {\n        if (!selector) {\n            return false;\n        }\n        if (typeof selector === 'function') {\n            return selector(this);\n        }\n        var selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\n        for (n = 0; n < len; n++) {\n            sel = selectorArr[n];\n            if (!Util.isValidSelector(sel)) {\n                Util.warn('Selector \"' +\n                    sel +\n                    '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                Util.warn('Konva is awesome, right?');\n            }\n            if (sel.charAt(0) === '#') {\n                if (this.id() === sel.slice(1)) {\n                    return true;\n                }\n            }\n            else if (sel.charAt(0) === '.') {\n                if (this.hasName(sel.slice(1))) {\n                    return true;\n                }\n            }\n            else if (this.className === sel || this.nodeType === sel) {\n                return true;\n            }\n        }\n        return false;\n    }\n    getLayer() {\n        var parent = this.getParent();\n        return parent ? parent.getLayer() : null;\n    }\n    getStage() {\n        return this._getCache(STAGE, this._getStage);\n    }\n    _getStage() {\n        var parent = this.getParent();\n        if (parent) {\n            return parent.getStage();\n        }\n        else {\n            return undefined;\n        }\n    }\n    fire(eventType, evt = {}, bubble) {\n        evt.target = evt.target || this;\n        if (bubble) {\n            this._fireAndBubble(eventType, evt);\n        }\n        else {\n            this._fire(eventType, evt);\n        }\n        return this;\n    }\n    getAbsoluteTransform(top) {\n        if (top) {\n            return this._getAbsoluteTransform(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n        }\n    }\n    _getAbsoluteTransform(top) {\n        var at;\n        if (top) {\n            at = new Transform();\n            this._eachAncestorReverse(function (node) {\n                var transformsEnabled = node.transformsEnabled();\n                if (transformsEnabled === 'all') {\n                    at.multiply(node.getTransform());\n                }\n                else if (transformsEnabled === 'position') {\n                    at.translate(node.x() - node.offsetX(), node.y() - node.offsetY());\n                }\n            }, top);\n            return at;\n        }\n        else {\n            at = this._cache.get(ABSOLUTE_TRANSFORM) || new Transform();\n            if (this.parent) {\n                this.parent.getAbsoluteTransform().copyInto(at);\n            }\n            else {\n                at.reset();\n            }\n            var transformsEnabled = this.transformsEnabled();\n            if (transformsEnabled === 'all') {\n                at.multiply(this.getTransform());\n            }\n            else if (transformsEnabled === 'position') {\n                const x = this.attrs.x || 0;\n                const y = this.attrs.y || 0;\n                const offsetX = this.attrs.offsetX || 0;\n                const offsetY = this.attrs.offsetY || 0;\n                at.translate(x - offsetX, y - offsetY);\n            }\n            at.dirty = false;\n            return at;\n        }\n    }\n    getAbsoluteScale(top) {\n        var parent = this;\n        while (parent) {\n            if (parent._isUnderCache) {\n                top = parent;\n            }\n            parent = parent.getParent();\n        }\n        const transform = this.getAbsoluteTransform(top);\n        const attrs = transform.decompose();\n        return {\n            x: attrs.scaleX,\n            y: attrs.scaleY,\n        };\n    }\n    getAbsoluteRotation() {\n        return this.getAbsoluteTransform().decompose().rotation;\n    }\n    getTransform() {\n        return this._getCache(TRANSFORM, this._getTransform);\n    }\n    _getTransform() {\n        var _a, _b;\n        var m = this._cache.get(TRANSFORM) || new Transform();\n        m.reset();\n        var x = this.x(), y = this.y(), rotation = Konva.getAngle(this.rotation()), scaleX = (_a = this.attrs.scaleX) !== null && _a !== void 0 ? _a : 1, scaleY = (_b = this.attrs.scaleY) !== null && _b !== void 0 ? _b : 1, skewX = this.attrs.skewX || 0, skewY = this.attrs.skewY || 0, offsetX = this.attrs.offsetX || 0, offsetY = this.attrs.offsetY || 0;\n        if (x !== 0 || y !== 0) {\n            m.translate(x, y);\n        }\n        if (rotation !== 0) {\n            m.rotate(rotation);\n        }\n        if (skewX !== 0 || skewY !== 0) {\n            m.skew(skewX, skewY);\n        }\n        if (scaleX !== 1 || scaleY !== 1) {\n            m.scale(scaleX, scaleY);\n        }\n        if (offsetX !== 0 || offsetY !== 0) {\n            m.translate(-1 * offsetX, -1 * offsetY);\n        }\n        m.dirty = false;\n        return m;\n    }\n    clone(obj) {\n        var attrs = Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\n        for (key in obj) {\n            attrs[key] = obj[key];\n        }\n        var node = new this.constructor(attrs);\n        for (key in this.eventListeners) {\n            allListeners = this.eventListeners[key];\n            len = allListeners.length;\n            for (n = 0; n < len; n++) {\n                listener = allListeners[n];\n                if (listener.name.indexOf(KONVA) < 0) {\n                    if (!node.eventListeners[key]) {\n                        node.eventListeners[key] = [];\n                    }\n                    node.eventListeners[key].push(listener);\n                }\n            }\n        }\n        return node;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        var box = this.getClientRect();\n        var stage = this.getStage(), x = config.x !== undefined ? config.x : box.x, y = config.y !== undefined ? config.y : box.y, pixelRatio = config.pixelRatio || 1, canvas = new SceneCanvas({\n            width: config.width || box.width || (stage ? stage.width() : 0),\n            height: config.height || box.height || (stage ? stage.height() : 0),\n            pixelRatio: pixelRatio,\n        }), context = canvas.getContext();\n        context.save();\n        if (x || y) {\n            context.translate(-1 * x, -1 * y);\n        }\n        this.drawScene(canvas);\n        context.restore();\n        return canvas;\n    }\n    toCanvas(config) {\n        return this._toKonvaCanvas(config)._canvas;\n    }\n    toDataURL(config) {\n        config = config || {};\n        var mimeType = config.mimeType || null, quality = config.quality || null;\n        var url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\n        if (config.callback) {\n            config.callback(url);\n        }\n        return url;\n    }\n    toImage(config) {\n        if (!config || !config.callback) {\n            throw 'callback required for toImage method config argument';\n        }\n        var callback = config.callback;\n        delete config.callback;\n        Util._urlToImage(this.toDataURL(config), function (img) {\n            callback(img);\n        });\n    }\n    setSize(size) {\n        this.width(size.width);\n        this.height(size.height);\n        return this;\n    }\n    getSize() {\n        return {\n            width: this.width(),\n            height: this.height(),\n        };\n    }\n    getClassName() {\n        return this.className || this.nodeType;\n    }\n    getType() {\n        return this.nodeType;\n    }\n    getDragDistance() {\n        if (this.attrs.dragDistance !== undefined) {\n            return this.attrs.dragDistance;\n        }\n        else if (this.parent) {\n            return this.parent.getDragDistance();\n        }\n        else {\n            return Konva.dragDistance;\n        }\n    }\n    _off(type, name, callback) {\n        var evtListeners = this.eventListeners[type], i, evtName, handler;\n        for (i = 0; i < evtListeners.length; i++) {\n            evtName = evtListeners[i].name;\n            handler = evtListeners[i].handler;\n            if ((evtName !== 'konva' || name === 'konva') &&\n                (!name || evtName === name) &&\n                (!callback || callback === handler)) {\n                evtListeners.splice(i, 1);\n                if (evtListeners.length === 0) {\n                    delete this.eventListeners[type];\n                    break;\n                }\n                i--;\n            }\n        }\n    }\n    _fireChangeEvent(attr, oldVal, newVal) {\n        this._fire(attr + CHANGE, {\n            oldVal: oldVal,\n            newVal: newVal,\n        });\n    }\n    addName(name) {\n        if (!this.hasName(name)) {\n            var oldName = this.name();\n            var newName = oldName ? oldName + ' ' + name : name;\n            this.name(newName);\n        }\n        return this;\n    }\n    hasName(name) {\n        if (!name) {\n            return false;\n        }\n        const fullName = this.name();\n        if (!fullName) {\n            return false;\n        }\n        var names = (fullName || '').split(/\\s/g);\n        return names.indexOf(name) !== -1;\n    }\n    removeName(name) {\n        var names = (this.name() || '').split(/\\s/g);\n        var index = names.indexOf(name);\n        if (index !== -1) {\n            names.splice(index, 1);\n            this.name(names.join(' '));\n        }\n        return this;\n    }\n    setAttr(attr, val) {\n        var func = this[SET + Util._capitalize(attr)];\n        if (Util._isFunction(func)) {\n            func.call(this, val);\n        }\n        else {\n            this._setAttr(attr, val);\n        }\n        return this;\n    }\n    _requestDraw() {\n        if (Konva.autoDrawEnabled) {\n            const drawNode = this.getLayer() || this.getStage();\n            drawNode === null || drawNode === void 0 ? void 0 : drawNode.batchDraw();\n        }\n    }\n    _setAttr(key, val) {\n        var oldVal = this.attrs[key];\n        if (oldVal === val && !Util.isObject(val)) {\n            return;\n        }\n        if (val === undefined || val === null) {\n            delete this.attrs[key];\n        }\n        else {\n            this.attrs[key] = val;\n        }\n        if (this._shouldFireChangeEvents) {\n            this._fireChangeEvent(key, oldVal, val);\n        }\n        this._requestDraw();\n    }\n    _setComponentAttr(key, component, val) {\n        var oldVal;\n        if (val !== undefined) {\n            oldVal = this.attrs[key];\n            if (!oldVal) {\n                this.attrs[key] = this.getAttr(key);\n            }\n            this.attrs[key][component] = val;\n            this._fireChangeEvent(key, oldVal, val);\n        }\n    }\n    _fireAndBubble(eventType, evt, compareShape) {\n        if (evt && this.nodeType === SHAPE) {\n            evt.target = this;\n        }\n        var shouldStop = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n            ((compareShape &&\n                (this === compareShape ||\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\n                (this.nodeType === 'Stage' && !compareShape));\n        if (!shouldStop) {\n            this._fire(eventType, evt);\n            var stopBubble = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n                compareShape &&\n                compareShape.isAncestorOf &&\n                compareShape.isAncestorOf(this) &&\n                !compareShape.isAncestorOf(this.parent);\n            if (((evt && !evt.cancelBubble) || !evt) &&\n                this.parent &&\n                this.parent.isListening() &&\n                !stopBubble) {\n                if (compareShape && compareShape.parent) {\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape);\n                }\n                else {\n                    this._fireAndBubble.call(this.parent, eventType, evt);\n                }\n            }\n        }\n    }\n    _getProtoListeners(eventType) {\n        let listeners = this._cache.get(ALL_LISTENERS);\n        if (!listeners) {\n            listeners = {};\n            let obj = Object.getPrototypeOf(this);\n            while (obj) {\n                if (!obj.eventListeners) {\n                    obj = Object.getPrototypeOf(obj);\n                    continue;\n                }\n                for (var event in obj.eventListeners) {\n                    const newEvents = obj.eventListeners[event];\n                    const oldEvents = listeners[event] || [];\n                    listeners[event] = newEvents.concat(oldEvents);\n                }\n                obj = Object.getPrototypeOf(obj);\n            }\n            this._cache.set(ALL_LISTENERS, listeners);\n        }\n        return listeners[eventType];\n    }\n    _fire(eventType, evt) {\n        evt = evt || {};\n        evt.currentTarget = this;\n        evt.type = eventType;\n        const topListeners = this._getProtoListeners(eventType);\n        if (topListeners) {\n            for (var i = 0; i < topListeners.length; i++) {\n                topListeners[i].handler.call(this, evt);\n            }\n        }\n        const selfListeners = this.eventListeners[eventType];\n        if (selfListeners) {\n            for (var i = 0; i < selfListeners.length; i++) {\n                selfListeners[i].handler.call(this, evt);\n            }\n        }\n    }\n    draw() {\n        this.drawScene();\n        this.drawHit();\n        return this;\n    }\n    _createDragElement(evt) {\n        var pointerId = evt ? evt.pointerId : undefined;\n        var stage = this.getStage();\n        var ap = this.getAbsolutePosition();\n        var pos = stage._getPointerById(pointerId) ||\n            stage._changedPointerPositions[0] ||\n            ap;\n        DD._dragElements.set(this._id, {\n            node: this,\n            startPointerPos: pos,\n            offset: {\n                x: pos.x - ap.x,\n                y: pos.y - ap.y,\n            },\n            dragStatus: 'ready',\n            pointerId,\n        });\n    }\n    startDrag(evt, bubbleEvent = true) {\n        if (!DD._dragElements.has(this._id)) {\n            this._createDragElement(evt);\n        }\n        const elem = DD._dragElements.get(this._id);\n        elem.dragStatus = 'dragging';\n        this.fire('dragstart', {\n            type: 'dragstart',\n            target: this,\n            evt: evt && evt.evt,\n        }, bubbleEvent);\n    }\n    _setDragPosition(evt, elem) {\n        const pos = this.getStage()._getPointerById(elem.pointerId);\n        if (!pos) {\n            return;\n        }\n        var newNodePos = {\n            x: pos.x - elem.offset.x,\n            y: pos.y - elem.offset.y,\n        };\n        var dbf = this.dragBoundFunc();\n        if (dbf !== undefined) {\n            const bounded = dbf.call(this, newNodePos, evt);\n            if (!bounded) {\n                Util.warn('dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.');\n            }\n            else {\n                newNodePos = bounded;\n            }\n        }\n        if (!this._lastPos ||\n            this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            this.setAbsolutePosition(newNodePos);\n            this._requestDraw();\n        }\n        this._lastPos = newNodePos;\n    }\n    stopDrag(evt) {\n        const elem = DD._dragElements.get(this._id);\n        if (elem) {\n            elem.dragStatus = 'stopped';\n        }\n        DD._endDragBefore(evt);\n        DD._endDragAfter(evt);\n    }\n    setDraggable(draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    }\n    isDragging() {\n        const elem = DD._dragElements.get(this._id);\n        return elem ? elem.dragStatus === 'dragging' : false;\n    }\n    _listenDrag() {\n        this._dragCleanup();\n        this.on('mousedown.konva touchstart.konva', function (evt) {\n            var shouldCheckButton = evt.evt['button'] !== undefined;\n            var canDrag = !shouldCheckButton || Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\n            if (!canDrag) {\n                return;\n            }\n            if (this.isDragging()) {\n                return;\n            }\n            var hasDraggingChild = false;\n            DD._dragElements.forEach((elem) => {\n                if (this.isAncestorOf(elem.node)) {\n                    hasDraggingChild = true;\n                }\n            });\n            if (!hasDraggingChild) {\n                this._createDragElement(evt);\n            }\n        });\n    }\n    _dragChange() {\n        if (this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            this._dragCleanup();\n            var stage = this.getStage();\n            if (!stage) {\n                return;\n            }\n            const dragElement = DD._dragElements.get(this._id);\n            const isDragging = dragElement && dragElement.dragStatus === 'dragging';\n            const isReady = dragElement && dragElement.dragStatus === 'ready';\n            if (isDragging) {\n                this.stopDrag();\n            }\n            else if (isReady) {\n                DD._dragElements.delete(this._id);\n            }\n        }\n    }\n    _dragCleanup() {\n        this.off('mousedown.konva');\n        this.off('touchstart.konva');\n    }\n    isClientRectOnScreen(margin = { x: 0, y: 0 }) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const screenRect = {\n            x: -margin.x,\n            y: -margin.y,\n            width: stage.width() + margin.x,\n            height: stage.height() + margin.y,\n        };\n        return Util.haveIntersection(screenRect, this.getClientRect());\n    }\n    static create(data, container) {\n        if (Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    }\n    static _createNode(obj, container) {\n        var className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\n        if (container) {\n            obj.attrs.container = container;\n        }\n        if (!Konva[className]) {\n            Util.warn('Can not find a node with class name \"' +\n                className +\n                '\". Fallback to \"Shape\".');\n            className = 'Shape';\n        }\n        const Class = Konva[className];\n        no = new Class(obj.attrs);\n        if (children) {\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                no.add(Node._createNode(children[n]));\n            }\n        }\n        return no;\n    }\n}\nNode.prototype.nodeType = 'Node';\nNode.prototype._attrsAffectingSize = [];\nNode.prototype.eventListeners = {};\nNode.prototype.on.call(Node.prototype, TRANSFORM_CHANGE_STR, function () {\n    if (this._batchingTransformChange) {\n        this._needClearTransformCache = true;\n        return;\n    }\n    this._clearCache(TRANSFORM);\n    this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n});\nNode.prototype.on.call(Node.prototype, 'visibleChange.konva', function () {\n    this._clearSelfAndDescendantCache(VISIBLE);\n});\nNode.prototype.on.call(Node.prototype, 'listeningChange.konva', function () {\n    this._clearSelfAndDescendantCache(LISTENING);\n});\nNode.prototype.on.call(Node.prototype, 'opacityChange.konva', function () {\n    this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n});\nconst addGetterSetter = Factory.addGetterSetter;\naddGetterSetter(Node, 'zIndex');\naddGetterSetter(Node, 'absolutePosition');\naddGetterSetter(Node, 'position');\naddGetterSetter(Node, 'x', 0, getNumberValidator());\naddGetterSetter(Node, 'y', 0, getNumberValidator());\naddGetterSetter(Node, 'globalCompositeOperation', 'source-over', getStringValidator());\naddGetterSetter(Node, 'opacity', 1, getNumberValidator());\naddGetterSetter(Node, 'name', '', getStringValidator());\naddGetterSetter(Node, 'id', '', getStringValidator());\naddGetterSetter(Node, 'rotation', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\naddGetterSetter(Node, 'scaleX', 1, getNumberValidator());\naddGetterSetter(Node, 'scaleY', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\naddGetterSetter(Node, 'skewX', 0, getNumberValidator());\naddGetterSetter(Node, 'skewY', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\naddGetterSetter(Node, 'offsetX', 0, getNumberValidator());\naddGetterSetter(Node, 'offsetY', 0, getNumberValidator());\naddGetterSetter(Node, 'dragDistance', null, getNumberValidator());\naddGetterSetter(Node, 'width', 0, getNumberValidator());\naddGetterSetter(Node, 'height', 0, getNumberValidator());\naddGetterSetter(Node, 'listening', true, getBooleanValidator());\naddGetterSetter(Node, 'preventDefault', true, getBooleanValidator());\naddGetterSetter(Node, 'filters', null, function (val) {\n    this._filterUpToDate = false;\n    return val;\n});\naddGetterSetter(Node, 'visible', true, getBooleanValidator());\naddGetterSetter(Node, 'transformsEnabled', 'all', getStringValidator());\naddGetterSetter(Node, 'size');\naddGetterSetter(Node, 'dragBoundFunc');\naddGetterSetter(Node, 'draggable', false, getBooleanValidator());\nFactory.backCompat(Node, {\n    rotateDeg: 'rotate',\n    setRotationDeg: 'setRotation',\n    getRotationDeg: 'getRotation',\n});\n","import { Factory } from './Factory.js';\nimport { Node } from './Node.js';\nimport { getNumberValidator } from './Validators.js';\nexport class Container extends Node {\n    constructor() {\n        super(...arguments);\n        this.children = [];\n    }\n    getChildren(filterFunc) {\n        if (!filterFunc) {\n            return this.children || [];\n        }\n        const children = this.children || [];\n        var results = [];\n        children.forEach(function (child) {\n            if (filterFunc(child)) {\n                results.push(child);\n            }\n        });\n        return results;\n    }\n    hasChildren() {\n        return this.getChildren().length > 0;\n    }\n    removeChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.remove();\n        });\n        this.children = [];\n        return this;\n    }\n    destroyChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.destroy();\n        });\n        this.children = [];\n        return this;\n    }\n    add(...children) {\n        if (arguments.length > 1) {\n            for (var i = 0; i < arguments.length; i++) {\n                this.add(arguments[i]);\n            }\n            return this;\n        }\n        var child = children[0];\n        if (child.getParent()) {\n            child.moveTo(this);\n            return this;\n        }\n        this._validateAdd(child);\n        child.index = this.getChildren().length;\n        child.parent = this;\n        child._clearCaches();\n        this.getChildren().push(child);\n        this._fire('add', {\n            child: child,\n        });\n        this._requestDraw();\n        return this;\n    }\n    destroy() {\n        if (this.hasChildren()) {\n            this.destroyChildren();\n        }\n        super.destroy();\n        return this;\n    }\n    find(selector) {\n        return this._generalFind(selector, false);\n    }\n    findOne(selector) {\n        var result = this._generalFind(selector, true);\n        return result.length > 0 ? result[0] : undefined;\n    }\n    _generalFind(selector, findOne) {\n        var retArr = [];\n        this._descendants((node) => {\n            const valid = node._isMatch(selector);\n            if (valid) {\n                retArr.push(node);\n            }\n            if (valid && findOne) {\n                return true;\n            }\n            return false;\n        });\n        return retArr;\n    }\n    _descendants(fn) {\n        let shouldStop = false;\n        const children = this.getChildren();\n        for (const child of children) {\n            shouldStop = fn(child);\n            if (shouldStop) {\n                return true;\n            }\n            if (!child.hasChildren()) {\n                continue;\n            }\n            shouldStop = child._descendants(fn);\n            if (shouldStop) {\n                return true;\n            }\n        }\n        return false;\n    }\n    toObject() {\n        var obj = Node.prototype.toObject.call(this);\n        obj.children = [];\n        this.getChildren().forEach((child) => {\n            obj.children.push(child.toObject());\n        });\n        return obj;\n    }\n    isAncestorOf(node) {\n        var parent = node.getParent();\n        while (parent) {\n            if (parent._id === this._id) {\n                return true;\n            }\n            parent = parent.getParent();\n        }\n        return false;\n    }\n    clone(obj) {\n        var node = Node.prototype.clone.call(this, obj);\n        this.getChildren().forEach(function (no) {\n            node.add(no.clone());\n        });\n        return node;\n    }\n    getAllIntersections(pos) {\n        var arr = [];\n        this.find('Shape').forEach(function (shape) {\n            if (shape.isVisible() && shape.intersects(pos)) {\n                arr.push(shape);\n            }\n        });\n        return arr;\n    }\n    _clearSelfAndDescendantCache(attr) {\n        var _a;\n        super._clearSelfAndDescendantCache(attr);\n        if (this.isCached()) {\n            return;\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (node) {\n            node._clearSelfAndDescendantCache(attr);\n        });\n    }\n    _setChildrenIndices() {\n        var _a;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child, n) {\n            child.index = n;\n        });\n        this._requestDraw();\n    }\n    drawScene(can, top) {\n        var layer = this.getLayer(), canvas = can || (layer && layer.getCanvas()), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedSceneCanvas = cachedCanvas && cachedCanvas.scene;\n        var caching = canvas && canvas.isCache;\n        if (!this.isVisible() && !caching) {\n            return this;\n        }\n        if (cachedSceneCanvas) {\n            context.save();\n            var m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawScene', canvas, top);\n        }\n        return this;\n    }\n    drawHit(can, top) {\n        if (!this.shouldDrawHit(top)) {\n            return this;\n        }\n        var layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (cachedHitCanvas) {\n            context.save();\n            var m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawHit', canvas, top);\n        }\n        return this;\n    }\n    _drawChildren(drawMethod, canvas, top) {\n        var _a;\n        var context = canvas && canvas.getContext(), clipWidth = this.clipWidth(), clipHeight = this.clipHeight(), clipFunc = this.clipFunc(), hasClip = (clipWidth && clipHeight) || clipFunc;\n        const selfCache = top === this;\n        if (hasClip) {\n            context.save();\n            var transform = this.getAbsoluteTransform(top);\n            var m = transform.getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            context.beginPath();\n            if (clipFunc) {\n                clipFunc.call(this, context, this);\n            }\n            else {\n                var clipX = this.clipX();\n                var clipY = this.clipY();\n                context.rect(clipX, clipY, clipWidth, clipHeight);\n            }\n            context.clip();\n            m = transform.copy().invert().getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n        var hasComposition = !selfCache &&\n            this.globalCompositeOperation() !== 'source-over' &&\n            drawMethod === 'drawScene';\n        if (hasComposition) {\n            context.save();\n            context._applyGlobalCompositeOperation(this);\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            child[drawMethod](canvas, top);\n        });\n        if (hasComposition) {\n            context.restore();\n        }\n        if (hasClip) {\n            context.restore();\n        }\n    }\n    getClientRect(config) {\n        var _a;\n        config = config || {};\n        var skipTransform = config.skipTransform;\n        var relativeTo = config.relativeTo;\n        var minX, minY, maxX, maxY;\n        var selfRect = {\n            x: Infinity,\n            y: Infinity,\n            width: 0,\n            height: 0,\n        };\n        var that = this;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            if (!child.visible()) {\n                return;\n            }\n            var rect = child.getClientRect({\n                relativeTo: that,\n                skipShadow: config.skipShadow,\n                skipStroke: config.skipStroke,\n            });\n            if (rect.width === 0 && rect.height === 0) {\n                return;\n            }\n            if (minX === undefined) {\n                minX = rect.x;\n                minY = rect.y;\n                maxX = rect.x + rect.width;\n                maxY = rect.y + rect.height;\n            }\n            else {\n                minX = Math.min(minX, rect.x);\n                minY = Math.min(minY, rect.y);\n                maxX = Math.max(maxX, rect.x + rect.width);\n                maxY = Math.max(maxY, rect.y + rect.height);\n            }\n        });\n        var shapes = this.find('Shape');\n        var hasVisible = false;\n        for (var i = 0; i < shapes.length; i++) {\n            var shape = shapes[i];\n            if (shape._isVisible(this)) {\n                hasVisible = true;\n                break;\n            }\n        }\n        if (hasVisible && minX !== undefined) {\n            selfRect = {\n                x: minX,\n                y: minY,\n                width: maxX - minX,\n                height: maxY - minY,\n            };\n        }\n        else {\n            selfRect = {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (!skipTransform) {\n            return this._transformedRect(selfRect, relativeTo);\n        }\n        return selfRect;\n    }\n}\nFactory.addComponentsGetterSetter(Container, 'clip', [\n    'x',\n    'y',\n    'width',\n    'height',\n]);\nFactory.addGetterSetter(Container, 'clipX', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipY', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipWidth', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipHeight', undefined, getNumberValidator());\nFactory.addGetterSetter(Container, 'clipFunc');\n","import { Konva } from './Global.js';\nconst Captures = new Map();\nconst SUPPORT_POINTER_EVENTS = Konva._global['PointerEvent'] !== undefined;\nexport function getCapturedShape(pointerId) {\n    return Captures.get(pointerId);\n}\nexport function createEvent(evt) {\n    return {\n        evt,\n        pointerId: evt.pointerId,\n    };\n}\nexport function hasPointerCapture(pointerId, shape) {\n    return Captures.get(pointerId) === shape;\n}\nexport function setPointerCapture(pointerId, shape) {\n    releaseCapture(pointerId);\n    const stage = shape.getStage();\n    if (!stage)\n        return;\n    Captures.set(pointerId, shape);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('gotpointercapture', createEvent(new PointerEvent('gotpointercapture')));\n    }\n}\nexport function releaseCapture(pointerId, target) {\n    const shape = Captures.get(pointerId);\n    if (!shape)\n        return;\n    const stage = shape.getStage();\n    if (stage && stage.content) {\n    }\n    Captures.delete(pointerId);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('lostpointercapture', createEvent(new PointerEvent('lostpointercapture')));\n    }\n}\n","import { Util } from './Util.js';\nimport { Factory } from './Factory.js';\nimport { Container } from './Container.js';\nimport { Konva } from './Global.js';\nimport { SceneCanvas, HitCanvas } from './Canvas.js';\nimport { DD } from './DragAndDrop.js';\nimport { _registerNode } from './Global.js';\nimport * as PointerEvents from './PointerEvents.js';\nvar STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', POINTEROUT = 'pointerout', POINTERLEAVE = 'pointerleave', POINTEROVER = 'pointerover', POINTERENTER = 'pointerenter', CONTEXTMENU = 'contextmenu', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TOUCHMOVE = 'touchmove', TOUCHCANCEL = 'touchcancel', WHEEL = 'wheel', MAX_LAYERS_NUMBER = 5, EVENTS = [\n    [MOUSEENTER, '_pointerenter'],\n    [MOUSEDOWN, '_pointerdown'],\n    [MOUSEMOVE, '_pointermove'],\n    [MOUSEUP, '_pointerup'],\n    [MOUSELEAVE, '_pointerleave'],\n    [TOUCHSTART, '_pointerdown'],\n    [TOUCHMOVE, '_pointermove'],\n    [TOUCHEND, '_pointerup'],\n    [TOUCHCANCEL, '_pointercancel'],\n    [MOUSEOVER, '_pointerover'],\n    [WHEEL, '_wheel'],\n    [CONTEXTMENU, '_contextmenu'],\n    [POINTERDOWN, '_pointerdown'],\n    [POINTERMOVE, '_pointermove'],\n    [POINTERUP, '_pointerup'],\n    [POINTERCANCEL, '_pointercancel'],\n    [LOSTPOINTERCAPTURE, '_lostpointercapture'],\n];\nconst EVENTS_MAP = {\n    mouse: {\n        [POINTEROUT]: MOUSEOUT,\n        [POINTERLEAVE]: MOUSELEAVE,\n        [POINTEROVER]: MOUSEOVER,\n        [POINTERENTER]: MOUSEENTER,\n        [POINTERMOVE]: MOUSEMOVE,\n        [POINTERDOWN]: MOUSEDOWN,\n        [POINTERUP]: MOUSEUP,\n        [POINTERCANCEL]: 'mousecancel',\n        pointerclick: 'click',\n        pointerdblclick: 'dblclick',\n    },\n    touch: {\n        [POINTEROUT]: 'touchout',\n        [POINTERLEAVE]: 'touchleave',\n        [POINTEROVER]: 'touchover',\n        [POINTERENTER]: 'touchenter',\n        [POINTERMOVE]: TOUCHMOVE,\n        [POINTERDOWN]: TOUCHSTART,\n        [POINTERUP]: TOUCHEND,\n        [POINTERCANCEL]: TOUCHCANCEL,\n        pointerclick: 'tap',\n        pointerdblclick: 'dbltap',\n    },\n    pointer: {\n        [POINTEROUT]: POINTEROUT,\n        [POINTERLEAVE]: POINTERLEAVE,\n        [POINTEROVER]: POINTEROVER,\n        [POINTERENTER]: POINTERENTER,\n        [POINTERMOVE]: POINTERMOVE,\n        [POINTERDOWN]: POINTERDOWN,\n        [POINTERUP]: POINTERUP,\n        [POINTERCANCEL]: POINTERCANCEL,\n        pointerclick: 'pointerclick',\n        pointerdblclick: 'pointerdblclick',\n    },\n};\nconst getEventType = (type) => {\n    if (type.indexOf('pointer') >= 0) {\n        return 'pointer';\n    }\n    if (type.indexOf('touch') >= 0) {\n        return 'touch';\n    }\n    return 'mouse';\n};\nconst getEventsMap = (eventType) => {\n    const type = getEventType(eventType);\n    if (type === 'pointer') {\n        return Konva.pointerEventsEnabled && EVENTS_MAP.pointer;\n    }\n    if (type === 'touch') {\n        return EVENTS_MAP.touch;\n    }\n    if (type === 'mouse') {\n        return EVENTS_MAP.mouse;\n    }\n};\nfunction checkNoClip(attrs = {}) {\n    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {\n        Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');\n    }\n    return attrs;\n}\nconst NO_POINTERS_MESSAGE = `Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);`;\nexport const stages = [];\nexport class Stage extends Container {\n    constructor(config) {\n        super(checkNoClip(config));\n        this._pointerPositions = [];\n        this._changedPointerPositions = [];\n        this._buildDOM();\n        this._bindContentEvents();\n        stages.push(this);\n        this.on('widthChange.konva heightChange.konva', this._resizeDOM);\n        this.on('visibleChange.konva', this._checkVisibility);\n        this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', () => {\n            checkNoClip(this.attrs);\n        });\n        this._checkVisibility();\n    }\n    _validateAdd(child) {\n        const isLayer = child.getType() === 'Layer';\n        const isFastLayer = child.getType() === 'FastLayer';\n        const valid = isLayer || isFastLayer;\n        if (!valid) {\n            Util.throw('You may only add layers to the stage.');\n        }\n    }\n    _checkVisibility() {\n        if (!this.content) {\n            return;\n        }\n        const style = this.visible() ? '' : 'none';\n        this.content.style.display = style;\n    }\n    setContainer(container) {\n        if (typeof container === STRING) {\n            if (container.charAt(0) === '.') {\n                var className = container.slice(1);\n                container = document.getElementsByClassName(className)[0];\n            }\n            else {\n                var id;\n                if (container.charAt(0) !== '#') {\n                    id = container;\n                }\n                else {\n                    id = container.slice(1);\n                }\n                container = document.getElementById(id);\n            }\n            if (!container) {\n                throw 'Can not find container in document with id ' + id;\n            }\n        }\n        this._setAttr('container', container);\n        if (this.content) {\n            if (this.content.parentElement) {\n                this.content.parentElement.removeChild(this.content);\n            }\n            container.appendChild(this.content);\n        }\n        return this;\n    }\n    shouldDrawHit() {\n        return true;\n    }\n    clear() {\n        var layers = this.children, len = layers.length, n;\n        for (n = 0; n < len; n++) {\n            layers[n].clear();\n        }\n        return this;\n    }\n    clone(obj) {\n        if (!obj) {\n            obj = {};\n        }\n        obj.container =\n            typeof document !== 'undefined' && document.createElement('div');\n        return Container.prototype.clone.call(this, obj);\n    }\n    destroy() {\n        super.destroy();\n        var content = this.content;\n        if (content && Util._isInDocument(content)) {\n            this.container().removeChild(content);\n        }\n        var index = stages.indexOf(this);\n        if (index > -1) {\n            stages.splice(index, 1);\n        }\n        return this;\n    }\n    getPointerPosition() {\n        const pos = this._pointerPositions[0] || this._changedPointerPositions[0];\n        if (!pos) {\n            Util.warn(NO_POINTERS_MESSAGE);\n            return null;\n        }\n        return {\n            x: pos.x,\n            y: pos.y,\n        };\n    }\n    _getPointerById(id) {\n        return this._pointerPositions.find((p) => p.id === id);\n    }\n    getPointersPositions() {\n        return this._pointerPositions;\n    }\n    getStage() {\n        return this;\n    }\n    getContent() {\n        return this.content;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        config.x = config.x || 0;\n        config.y = config.y || 0;\n        config.width = config.width || this.width();\n        config.height = config.height || this.height();\n        var canvas = new SceneCanvas({\n            width: config.width,\n            height: config.height,\n            pixelRatio: config.pixelRatio || 1,\n        });\n        var _context = canvas.getContext()._context;\n        var layers = this.children;\n        if (config.x || config.y) {\n            _context.translate(-1 * config.x, -1 * config.y);\n        }\n        layers.forEach(function (layer) {\n            if (!layer.isVisible()) {\n                return;\n            }\n            var layerCanvas = layer._toKonvaCanvas(config);\n            _context.drawImage(layerCanvas._canvas, config.x, config.y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());\n        });\n        return canvas;\n    }\n    getIntersection(pos) {\n        if (!pos) {\n            return null;\n        }\n        var layers = this.children, len = layers.length, end = len - 1, n;\n        for (n = end; n >= 0; n--) {\n            const shape = layers[n].getIntersection(pos);\n            if (shape) {\n                return shape;\n            }\n        }\n        return null;\n    }\n    _resizeDOM() {\n        var width = this.width();\n        var height = this.height();\n        if (this.content) {\n            this.content.style.width = width + PX;\n            this.content.style.height = height + PX;\n        }\n        this.bufferCanvas.setSize(width, height);\n        this.bufferHitCanvas.setSize(width, height);\n        this.children.forEach((layer) => {\n            layer.setSize({ width, height });\n            layer.draw();\n        });\n    }\n    add(layer, ...rest) {\n        if (arguments.length > 1) {\n            for (var i = 0; i < arguments.length; i++) {\n                this.add(arguments[i]);\n            }\n            return this;\n        }\n        super.add(layer);\n        var length = this.children.length;\n        if (length > MAX_LAYERS_NUMBER) {\n            Util.warn('The stage has ' +\n                length +\n                ' layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');\n        }\n        layer.setSize({ width: this.width(), height: this.height() });\n        layer.draw();\n        if (Konva.isBrowser) {\n            this.content.appendChild(layer.canvas._canvas);\n        }\n        return this;\n    }\n    getParent() {\n        return null;\n    }\n    getLayer() {\n        return null;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n    getLayers() {\n        return this.children;\n    }\n    _bindContentEvents() {\n        if (!Konva.isBrowser) {\n            return;\n        }\n        EVENTS.forEach(([event, methodName]) => {\n            this.content.addEventListener(event, (evt) => {\n                this[methodName](evt);\n            });\n        });\n    }\n    _pointerenter(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        this._fire(events.pointerenter, {\n            evt: evt,\n            target: this,\n            currentTarget: this,\n        });\n    }\n    _pointerover(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        this._fire(events.pointerover, {\n            evt: evt,\n            target: this,\n            currentTarget: this,\n        });\n    }\n    _getTargetShape(evenType) {\n        let shape = this[evenType + 'targetShape'];\n        if (shape && !shape.getStage()) {\n            shape = null;\n        }\n        return shape;\n    }\n    _pointerleave(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var targetShape = this._getTargetShape(eventType);\n        var eventsEnabled = !DD.isDragging || Konva.hitOnDragEnabled;\n        if (targetShape && eventsEnabled) {\n            targetShape._fireAndBubble(events.pointerout, { evt: evt });\n            targetShape._fireAndBubble(events.pointerleave, { evt: evt });\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this[eventType + 'targetShape'] = null;\n        }\n        else if (eventsEnabled) {\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this._fire(events.pointerout, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n        this.pointerPos = undefined;\n        this._pointerPositions = [];\n    }\n    _pointerdown(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var triggeredOnShape = false;\n        this._changedPointerPositions.forEach((pos) => {\n            var shape = this.getIntersection(pos);\n            DD.justDragged = false;\n            Konva['_' + eventType + 'ListenClick'] = true;\n            const hasShape = shape && shape.isListening();\n            if (!hasShape) {\n                return;\n            }\n            if (Konva.capturePointerEventsEnabled) {\n                shape.setPointerCapture(pos.id);\n            }\n            this[eventType + 'ClickStartShape'] = shape;\n            shape._fireAndBubble(events.pointerdown, {\n                evt: evt,\n                pointerId: pos.id,\n            });\n            triggeredOnShape = true;\n            const isTouch = evt.type.indexOf('touch') >= 0;\n            if (shape.preventDefault() && evt.cancelable && isTouch) {\n                evt.preventDefault();\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointerdown, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._pointerPositions[0].id,\n            });\n        }\n    }\n    _pointermove(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        if (DD.isDragging && DD.node.preventDefault() && evt.cancelable) {\n            evt.preventDefault();\n        }\n        this.setPointersPositions(evt);\n        var eventsEnabled = !DD.isDragging || Konva.hitOnDragEnabled;\n        if (!eventsEnabled) {\n            return;\n        }\n        var processedShapesIds = {};\n        let triggeredOnShape = false;\n        var targetShape = this._getTargetShape(eventType);\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            var differentTarget = targetShape !== shape;\n            if (differentTarget && targetShape) {\n                targetShape._fireAndBubble(events.pointerout, event, shape);\n                targetShape._fireAndBubble(events.pointerleave, event, shape);\n            }\n            if (shape) {\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            if (shape && shape.isListening()) {\n                triggeredOnShape = true;\n                if (differentTarget) {\n                    shape._fireAndBubble(events.pointerover, event, targetShape);\n                    shape._fireAndBubble(events.pointerenter, event, targetShape);\n                    this[eventType + 'targetShape'] = shape;\n                }\n                shape._fireAndBubble(events.pointermove, event);\n            }\n            else {\n                if (targetShape) {\n                    this._fire(events.pointerover, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                    this[eventType + 'targetShape'] = null;\n                }\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointermove, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n    }\n    _pointerup(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        const clickStartShape = this[eventType + 'ClickStartShape'];\n        const clickEndShape = this[eventType + 'ClickEndShape'];\n        var processedShapesIds = {};\n        let triggeredOnShape = false;\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            if (shape) {\n                shape.releaseCapture(pos.id);\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            let fireDblClick = false;\n            if (Konva['_' + eventType + 'InDblClickWindow']) {\n                fireDblClick = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            else if (!DD.justDragged) {\n                Konva['_' + eventType + 'InDblClickWindow'] = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            this[eventType + 'DblTimeout'] = setTimeout(function () {\n                Konva['_' + eventType + 'InDblClickWindow'] = false;\n            }, Konva.dblClickWindow);\n            if (shape && shape.isListening()) {\n                triggeredOnShape = true;\n                this[eventType + 'ClickEndShape'] = shape;\n                shape._fireAndBubble(events.pointerup, event);\n                if (Konva['_' + eventType + 'ListenClick'] &&\n                    clickStartShape &&\n                    clickStartShape === shape) {\n                    shape._fireAndBubble(events.pointerclick, event);\n                    if (fireDblClick && clickEndShape && clickEndShape === shape) {\n                        shape._fireAndBubble(events.pointerdblclick, event);\n                    }\n                }\n            }\n            else {\n                this[eventType + 'ClickEndShape'] = null;\n                if (Konva['_' + eventType + 'ListenClick']) {\n                    this._fire(events.pointerclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n                if (fireDblClick) {\n                    this._fire(events.pointerdblclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointerup, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n        Konva['_' + eventType + 'ListenClick'] = false;\n        if (evt.cancelable) {\n            evt.preventDefault();\n        }\n    }\n    _contextmenu(evt) {\n        this.setPointersPositions(evt);\n        var shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(CONTEXTMENU, { evt: evt });\n        }\n        else {\n            this._fire(CONTEXTMENU, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _wheel(evt) {\n        this.setPointersPositions(evt);\n        var shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(WHEEL, { evt: evt });\n        }\n        else {\n            this._fire(WHEEL, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _pointercancel(evt) {\n        this.setPointersPositions(evt);\n        const shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\n        }\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    _lostpointercapture(evt) {\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    setPointersPositions(evt) {\n        var contentPosition = this._getContentPosition(), x = null, y = null;\n        evt = evt ? evt : window.event;\n        if (evt.touches !== undefined) {\n            this._pointerPositions = [];\n            this._changedPointerPositions = [];\n            Array.prototype.forEach.call(evt.touches, (touch) => {\n                this._pointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n            Array.prototype.forEach.call(evt.changedTouches || evt.touches, (touch) => {\n                this._changedPointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n        }\n        else {\n            x = (evt.clientX - contentPosition.left) / contentPosition.scaleX;\n            y = (evt.clientY - contentPosition.top) / contentPosition.scaleY;\n            this.pointerPos = {\n                x: x,\n                y: y,\n            };\n            this._pointerPositions = [{ x, y, id: Util._getFirstPointerId(evt) }];\n            this._changedPointerPositions = [\n                { x, y, id: Util._getFirstPointerId(evt) },\n            ];\n        }\n    }\n    _setPointerPosition(evt) {\n        Util.warn('Method _setPointerPosition is deprecated. Use \"stage.setPointersPositions(event)\" instead.');\n        this.setPointersPositions(evt);\n    }\n    _getContentPosition() {\n        if (!this.content || !this.content.getBoundingClientRect) {\n            return {\n                top: 0,\n                left: 0,\n                scaleX: 1,\n                scaleY: 1,\n            };\n        }\n        var rect = this.content.getBoundingClientRect();\n        return {\n            top: rect.top,\n            left: rect.left,\n            scaleX: rect.width / this.content.clientWidth || 1,\n            scaleY: rect.height / this.content.clientHeight || 1,\n        };\n    }\n    _buildDOM() {\n        this.bufferCanvas = new SceneCanvas({\n            width: this.width(),\n            height: this.height(),\n        });\n        this.bufferHitCanvas = new HitCanvas({\n            pixelRatio: 1,\n            width: this.width(),\n            height: this.height(),\n        });\n        if (!Konva.isBrowser) {\n            return;\n        }\n        var container = this.container();\n        if (!container) {\n            throw 'Stage has no container. A container is required.';\n        }\n        container.innerHTML = '';\n        this.content = document.createElement('div');\n        this.content.style.position = 'relative';\n        this.content.style.userSelect = 'none';\n        this.content.className = 'konvajs-content';\n        this.content.setAttribute('role', 'presentation');\n        container.appendChild(this.content);\n        this._resizeDOM();\n    }\n    cache() {\n        Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\n        return this;\n    }\n    clearCache() {\n        return this;\n    }\n    batchDraw() {\n        this.getChildren().forEach(function (layer) {\n            layer.batchDraw();\n        });\n        return this;\n    }\n}\nStage.prototype.nodeType = STAGE;\n_registerNode(Stage);\nFactory.addGetterSetter(Stage, 'container');\n","import { Konva } from './Global.js';\nimport { Transform, Util } from './Util.js';\nimport { Factory } from './Factory.js';\nimport { Node } from './Node.js';\nimport { getNumberValidator, getNumberOrAutoValidator, getStringValidator, getBooleanValidator, getStringOrGradientValidator, } from './Validators.js';\nimport { _registerNode } from './Global.js';\nimport * as PointerEvents from './PointerEvents.js';\nvar HAS_SHADOW = 'hasShadow';\nvar SHADOW_RGBA = 'shadowRGBA';\nvar patternImage = 'patternImage';\nvar linearGradient = 'linearGradient';\nvar radialGradient = 'radialGradient';\nlet dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util.createCanvasElement().getContext('2d');\n    return dummyContext;\n}\nexport const shapes = {};\nfunction _fillFunc(context) {\n    context.fill();\n}\nfunction _strokeFunc(context) {\n    context.stroke();\n}\nfunction _fillFuncHit(context) {\n    context.fill();\n}\nfunction _strokeFuncHit(context) {\n    context.stroke();\n}\nfunction _clearHasShadowCache() {\n    this._clearCache(HAS_SHADOW);\n}\nfunction _clearGetShadowRGBACache() {\n    this._clearCache(SHADOW_RGBA);\n}\nfunction _clearFillPatternCache() {\n    this._clearCache(patternImage);\n}\nfunction _clearLinearGradientCache() {\n    this._clearCache(linearGradient);\n}\nfunction _clearRadialGradientCache() {\n    this._clearCache(radialGradient);\n}\nexport class Shape extends Node {\n    constructor(config) {\n        super(config);\n        let key;\n        while (true) {\n            key = Util.getRandomColor();\n            if (key && !(key in shapes)) {\n                break;\n            }\n        }\n        this.colorKey = key;\n        shapes[key] = this;\n    }\n    getContext() {\n        Util.warn('shape.getContext() method is deprecated. Please don not use it.');\n        return this.getLayer().getContext();\n    }\n    getCanvas() {\n        Util.warn('shape.getCanvas() method is deprecated. Please don not use it.');\n        return this.getLayer().getCanvas();\n    }\n    getSceneFunc() {\n        return this.attrs.sceneFunc || this['_sceneFunc'];\n    }\n    getHitFunc() {\n        return this.attrs.hitFunc || this['_hitFunc'];\n    }\n    hasShadow() {\n        return this._getCache(HAS_SHADOW, this._hasShadow);\n    }\n    _hasShadow() {\n        return (this.shadowEnabled() &&\n            this.shadowOpacity() !== 0 &&\n            !!(this.shadowColor() ||\n                this.shadowBlur() ||\n                this.shadowOffsetX() ||\n                this.shadowOffsetY()));\n    }\n    _getFillPattern() {\n        return this._getCache(patternImage, this.__getFillPattern);\n    }\n    __getFillPattern() {\n        if (this.fillPatternImage()) {\n            var ctx = getDummyContext();\n            const pattern = ctx.createPattern(this.fillPatternImage(), this.fillPatternRepeat() || 'repeat');\n            if (pattern && pattern.setTransform) {\n                const tr = new Transform();\n                tr.translate(this.fillPatternX(), this.fillPatternY());\n                tr.rotate(Konva.getAngle(this.fillPatternRotation()));\n                tr.scale(this.fillPatternScaleX(), this.fillPatternScaleY());\n                tr.translate(-1 * this.fillPatternOffsetX(), -1 * this.fillPatternOffsetY());\n                const m = tr.getMatrix();\n                pattern.setTransform({\n                    a: m[0],\n                    b: m[1],\n                    c: m[2],\n                    d: m[3],\n                    e: m[4],\n                    f: m[5],\n                });\n            }\n            return pattern;\n        }\n    }\n    _getLinearGradient() {\n        return this._getCache(linearGradient, this.__getLinearGradient);\n    }\n    __getLinearGradient() {\n        var colorStops = this.fillLinearGradientColorStops();\n        if (colorStops) {\n            var ctx = getDummyContext();\n            var start = this.fillLinearGradientStartPoint();\n            var end = this.fillLinearGradientEndPoint();\n            var grd = ctx.createLinearGradient(start.x, start.y, end.x, end.y);\n            for (var n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    _getRadialGradient() {\n        return this._getCache(radialGradient, this.__getRadialGradient);\n    }\n    __getRadialGradient() {\n        var colorStops = this.fillRadialGradientColorStops();\n        if (colorStops) {\n            var ctx = getDummyContext();\n            var start = this.fillRadialGradientStartPoint();\n            var end = this.fillRadialGradientEndPoint();\n            var grd = ctx.createRadialGradient(start.x, start.y, this.fillRadialGradientStartRadius(), end.x, end.y, this.fillRadialGradientEndRadius());\n            for (var n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    getShadowRGBA() {\n        return this._getCache(SHADOW_RGBA, this._getShadowRGBA);\n    }\n    _getShadowRGBA() {\n        if (this.hasShadow()) {\n            var rgba = Util.colorToRGBA(this.shadowColor());\n            return ('rgba(' +\n                rgba.r +\n                ',' +\n                rgba.g +\n                ',' +\n                rgba.b +\n                ',' +\n                rgba.a * (this.shadowOpacity() || 1) +\n                ')');\n        }\n    }\n    hasFill() {\n        return this._calculate('hasFill', [\n            'fillEnabled',\n            'fill',\n            'fillPatternImage',\n            'fillLinearGradientColorStops',\n            'fillRadialGradientColorStops',\n        ], () => {\n            return (this.fillEnabled() &&\n                !!(this.fill() ||\n                    this.fillPatternImage() ||\n                    this.fillLinearGradientColorStops() ||\n                    this.fillRadialGradientColorStops()));\n        });\n    }\n    hasStroke() {\n        return this._calculate('hasStroke', [\n            'strokeEnabled',\n            'strokeWidth',\n            'stroke',\n            'strokeLinearGradientColorStops',\n        ], () => {\n            return (this.strokeEnabled() &&\n                this.strokeWidth() &&\n                !!(this.stroke() || this.strokeLinearGradientColorStops()));\n        });\n    }\n    hasHitStroke() {\n        const width = this.hitStrokeWidth();\n        if (width === 'auto') {\n            return this.hasStroke();\n        }\n        return this.strokeEnabled() && !!width;\n    }\n    intersects(point) {\n        var stage = this.getStage(), bufferHitCanvas = stage.bufferHitCanvas, p;\n        bufferHitCanvas.getContext().clear();\n        this.drawHit(bufferHitCanvas, null, true);\n        p = bufferHitCanvas.context.getImageData(Math.round(point.x), Math.round(point.y), 1, 1).data;\n        return p[3] > 0;\n    }\n    destroy() {\n        Node.prototype.destroy.call(this);\n        delete shapes[this.colorKey];\n        delete this.colorKey;\n        return this;\n    }\n    _useBufferCanvas(forceFill) {\n        var _a;\n        if (!this.getStage()) {\n            return false;\n        }\n        const perfectDrawEnabled = (_a = this.attrs.perfectDrawEnabled) !== null && _a !== void 0 ? _a : true;\n        if (!perfectDrawEnabled) {\n            return false;\n        }\n        const hasFill = forceFill || this.hasFill();\n        const hasStroke = this.hasStroke();\n        const isTransparent = this.getAbsoluteOpacity() !== 1;\n        if (hasFill && hasStroke && isTransparent) {\n            return true;\n        }\n        const hasShadow = this.hasShadow();\n        const strokeForShadow = this.shadowForStrokeEnabled();\n        if (hasFill && hasStroke && hasShadow && strokeForShadow) {\n            return true;\n        }\n        return false;\n    }\n    setStrokeHitEnabled(val) {\n        Util.warn('strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead.');\n        if (val) {\n            this.hitStrokeWidth('auto');\n        }\n        else {\n            this.hitStrokeWidth(0);\n        }\n    }\n    getStrokeHitEnabled() {\n        if (this.hitStrokeWidth() === 0) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n    getSelfRect() {\n        var size = this.size();\n        return {\n            x: this._centroid ? -size.width / 2 : 0,\n            y: this._centroid ? -size.height / 2 : 0,\n            width: size.width,\n            height: size.height,\n        };\n    }\n    getClientRect(config = {}) {\n        const skipTransform = config.skipTransform;\n        const relativeTo = config.relativeTo;\n        const fillRect = this.getSelfRect();\n        const applyStroke = !config.skipStroke && this.hasStroke();\n        const strokeWidth = (applyStroke && this.strokeWidth()) || 0;\n        const fillAndStrokeWidth = fillRect.width + strokeWidth;\n        const fillAndStrokeHeight = fillRect.height + strokeWidth;\n        const applyShadow = !config.skipShadow && this.hasShadow();\n        const shadowOffsetX = applyShadow ? this.shadowOffsetX() : 0;\n        const shadowOffsetY = applyShadow ? this.shadowOffsetY() : 0;\n        const preWidth = fillAndStrokeWidth + Math.abs(shadowOffsetX);\n        const preHeight = fillAndStrokeHeight + Math.abs(shadowOffsetY);\n        const blurRadius = (applyShadow && this.shadowBlur()) || 0;\n        const width = preWidth + blurRadius * 2;\n        const height = preHeight + blurRadius * 2;\n        let roundingOffset = 0;\n        if (Math.round(strokeWidth / 2) !== strokeWidth / 2) {\n            roundingOffset = 1;\n        }\n        const rect = {\n            width: width + roundingOffset,\n            height: height + roundingOffset,\n            x: -Math.round(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetX, 0) +\n                fillRect.x,\n            y: -Math.round(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetY, 0) +\n                fillRect.y,\n        };\n        if (!skipTransform) {\n            return this._transformedRect(rect, relativeTo);\n        }\n        return rect;\n    }\n    drawScene(can, top) {\n        var layer = this.getLayer(), canvas = can || layer.getCanvas(), context = canvas.getContext(), cachedCanvas = this._getCanvasCache(), drawFunc = this.getSceneFunc(), hasShadow = this.hasShadow(), stage, bufferCanvas, bufferContext;\n        var skipBuffer = canvas.isCache;\n        var cachingSelf = top === this;\n        if (!this.isVisible() && !cachingSelf) {\n            return this;\n        }\n        if (cachedCanvas) {\n            context.save();\n            var m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        if (this._useBufferCanvas() && !skipBuffer) {\n            stage = this.getStage();\n            bufferCanvas = stage.bufferCanvas;\n            bufferContext = bufferCanvas.getContext();\n            bufferContext.clear();\n            bufferContext.save();\n            bufferContext._applyLineJoin(this);\n            var o = this.getAbsoluteTransform(top).getMatrix();\n            bufferContext.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n            drawFunc.call(this, bufferContext, this);\n            bufferContext.restore();\n            var ratio = bufferCanvas.pixelRatio;\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            context._applyOpacity(this);\n            context._applyGlobalCompositeOperation(this);\n            context.drawImage(bufferCanvas._canvas, 0, 0, bufferCanvas.width / ratio, bufferCanvas.height / ratio);\n        }\n        else {\n            context._applyLineJoin(this);\n            if (!cachingSelf) {\n                var o = this.getAbsoluteTransform(top).getMatrix();\n                context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n                context._applyOpacity(this);\n                context._applyGlobalCompositeOperation(this);\n            }\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            drawFunc.call(this, context, this);\n        }\n        context.restore();\n        return this;\n    }\n    drawHit(can, top, skipDragCheck = false) {\n        if (!this.shouldDrawHit(top, skipDragCheck)) {\n            return this;\n        }\n        var layer = this.getLayer(), canvas = can || layer.hitCanvas, context = canvas && canvas.getContext(), drawFunc = this.hitFunc() || this.sceneFunc(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (!this.colorKey) {\n            Util.warn('Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()');\n        }\n        if (cachedHitCanvas) {\n            context.save();\n            var m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        context._applyLineJoin(this);\n        const selfCache = this === top;\n        if (!selfCache) {\n            var o = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n        }\n        drawFunc.call(this, context, this);\n        context.restore();\n        return this;\n    }\n    drawHitFromCache(alphaThreshold = 0) {\n        var cachedCanvas = this._getCanvasCache(), sceneCanvas = this._getCachedSceneCanvas(), hitCanvas = cachedCanvas.hit, hitContext = hitCanvas.getContext(), hitWidth = hitCanvas.getWidth(), hitHeight = hitCanvas.getHeight(), hitImageData, hitData, len, rgbColorKey, i, alpha;\n        hitContext.clear();\n        hitContext.drawImage(sceneCanvas._canvas, 0, 0, hitWidth, hitHeight);\n        try {\n            hitImageData = hitContext.getImageData(0, 0, hitWidth, hitHeight);\n            hitData = hitImageData.data;\n            len = hitData.length;\n            rgbColorKey = Util._hexToRgb(this.colorKey);\n            for (i = 0; i < len; i += 4) {\n                alpha = hitData[i + 3];\n                if (alpha > alphaThreshold) {\n                    hitData[i] = rgbColorKey.r;\n                    hitData[i + 1] = rgbColorKey.g;\n                    hitData[i + 2] = rgbColorKey.b;\n                    hitData[i + 3] = 255;\n                }\n                else {\n                    hitData[i + 3] = 0;\n                }\n            }\n            hitContext.putImageData(hitImageData, 0, 0);\n        }\n        catch (e) {\n            Util.error('Unable to draw hit graph from cached scene canvas. ' + e.message);\n        }\n        return this;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n}\nShape.prototype._fillFunc = _fillFunc;\nShape.prototype._strokeFunc = _strokeFunc;\nShape.prototype._fillFuncHit = _fillFuncHit;\nShape.prototype._strokeFuncHit = _strokeFuncHit;\nShape.prototype._centroid = false;\nShape.prototype.nodeType = 'Shape';\n_registerNode(Shape);\nShape.prototype.eventListeners = {};\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearHasShadowCache);\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearGetShadowRGBACache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetX.konva fillPatternOffsetY.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotation.konva', _clearFillPatternCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva', _clearLinearGradientCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva', _clearRadialGradientCache);\nFactory.addGetterSetter(Shape, 'stroke', undefined, getStringOrGradientValidator());\nFactory.addGetterSetter(Shape, 'strokeWidth', 2, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillAfterStrokeEnabled', false);\nFactory.addGetterSetter(Shape, 'hitStrokeWidth', 'auto', getNumberOrAutoValidator());\nFactory.addGetterSetter(Shape, 'strokeHitEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'perfectDrawEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'shadowForStrokeEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Shape, 'lineJoin');\nFactory.addGetterSetter(Shape, 'lineCap');\nFactory.addGetterSetter(Shape, 'sceneFunc');\nFactory.addGetterSetter(Shape, 'hitFunc');\nFactory.addGetterSetter(Shape, 'dash');\nFactory.addGetterSetter(Shape, 'dashOffset', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowColor', undefined, getStringValidator());\nFactory.addGetterSetter(Shape, 'shadowBlur', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowOpacity', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'shadowOffset', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'shadowOffsetX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'shadowOffsetY', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternImage');\nFactory.addGetterSetter(Shape, 'fill', undefined, getStringOrGradientValidator());\nFactory.addGetterSetter(Shape, 'fillPatternX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternY', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillLinearGradientColorStops');\nFactory.addGetterSetter(Shape, 'strokeLinearGradientColorStops');\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartRadius', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndRadius', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientColorStops');\nFactory.addGetterSetter(Shape, 'fillPatternRepeat', 'repeat');\nFactory.addGetterSetter(Shape, 'fillEnabled', true);\nFactory.addGetterSetter(Shape, 'strokeEnabled', true);\nFactory.addGetterSetter(Shape, 'shadowEnabled', true);\nFactory.addGetterSetter(Shape, 'dashEnabled', true);\nFactory.addGetterSetter(Shape, 'strokeScaleEnabled', true);\nFactory.addGetterSetter(Shape, 'fillPriority', 'color');\nFactory.addComponentsGetterSetter(Shape, 'fillPatternOffset', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'fillPatternOffsetX', 0, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternOffsetY', 0, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'fillPatternScale', ['x', 'y']);\nFactory.addGetterSetter(Shape, 'fillPatternScaleX', 1, getNumberValidator());\nFactory.addGetterSetter(Shape, 'fillPatternScaleY', 1, getNumberValidator());\nFactory.addComponentsGetterSetter(Shape, 'fillLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addComponentsGetterSetter(Shape, 'strokeLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillLinearGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'fillLinearGradientStartPointY', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientStartPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addComponentsGetterSetter(Shape, 'strokeLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillLinearGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'fillLinearGradientEndPointY', 0);\nFactory.addGetterSetter(Shape, 'strokeLinearGradientEndPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillRadialGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartPointX', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientStartPointY', 0);\nFactory.addComponentsGetterSetter(Shape, 'fillRadialGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndPointX', 0);\nFactory.addGetterSetter(Shape, 'fillRadialGradientEndPointY', 0);\nFactory.addGetterSetter(Shape, 'fillPatternRotation', 0);\nFactory.backCompat(Shape, {\n    dashArray: 'dash',\n    getDashArray: 'getDash',\n    setDashArray: 'getDash',\n    drawFunc: 'sceneFunc',\n    getDrawFunc: 'getSceneFunc',\n    setDrawFunc: 'setSceneFunc',\n    drawHitFunc: 'hitFunc',\n    getDrawHitFunc: 'getHitFunc',\n    setDrawHitFunc: 'setHitFunc',\n});\n","import { Util } from './Util.js';\nimport { Container } from './Container.js';\nimport { Node } from './Node.js';\nimport { Factory } from './Factory.js';\nimport { SceneCanvas, HitCanvas } from './Canvas.js';\nimport { getBooleanValidator } from './Validators.js';\nimport { shapes } from './Shape.js';\nimport { _registerNode } from './Global.js';\nvar HASH = '#', BEFORE_DRAW = 'beforeDraw', DRAW = 'draw', INTERSECTION_OFFSETS = [\n    { x: 0, y: 0 },\n    { x: -1, y: -1 },\n    { x: 1, y: -1 },\n    { x: 1, y: 1 },\n    { x: -1, y: 1 },\n], INTERSECTION_OFFSETS_LEN = INTERSECTION_OFFSETS.length;\nexport class Layer extends Container {\n    constructor(config) {\n        super(config);\n        this.canvas = new SceneCanvas();\n        this.hitCanvas = new HitCanvas({\n            pixelRatio: 1,\n        });\n        this._waitingForDraw = false;\n        this.on('visibleChange.konva', this._checkVisibility);\n        this._checkVisibility();\n        this.on('imageSmoothingEnabledChange.konva', this._setSmoothEnabled);\n        this._setSmoothEnabled();\n    }\n    createPNGStream() {\n        const c = this.canvas._canvas;\n        return c.createPNGStream();\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    getNativeCanvasElement() {\n        return this.canvas._canvas;\n    }\n    getHitCanvas() {\n        return this.hitCanvas;\n    }\n    getContext() {\n        return this.getCanvas().getContext();\n    }\n    clear(bounds) {\n        this.getContext().clear(bounds);\n        this.getHitCanvas().getContext().clear(bounds);\n        return this;\n    }\n    setZIndex(index) {\n        super.setZIndex(index);\n        var stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            if (index < stage.children.length - 1) {\n                stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[index + 1].getCanvas()._canvas);\n            }\n            else {\n                stage.content.appendChild(this.getNativeCanvasElement());\n            }\n        }\n        return this;\n    }\n    moveToTop() {\n        Node.prototype.moveToTop.call(this);\n        var stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveUp() {\n        var moved = Node.prototype.moveUp.call(this);\n        if (!moved) {\n            return false;\n        }\n        var stage = this.getStage();\n        if (!stage || !stage.content) {\n            return false;\n        }\n        stage.content.removeChild(this.getNativeCanvasElement());\n        if (this.index < stage.children.length - 1) {\n            stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[this.index + 1].getCanvas()._canvas);\n        }\n        else {\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveDown() {\n        if (Node.prototype.moveDown.call(this)) {\n            var stage = this.getStage();\n            if (stage) {\n                var children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[this.index + 1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (Node.prototype.moveToBottom.call(this)) {\n            var stage = this.getStage();\n            if (stage) {\n                var children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    getLayer() {\n        return this;\n    }\n    remove() {\n        var _canvas = this.getNativeCanvasElement();\n        Node.prototype.remove.call(this);\n        if (_canvas && _canvas.parentNode && Util._isInDocument(_canvas)) {\n            _canvas.parentNode.removeChild(_canvas);\n        }\n        return this;\n    }\n    getStage() {\n        return this.parent;\n    }\n    setSize({ width, height }) {\n        this.canvas.setSize(width, height);\n        this.hitCanvas.setSize(width, height);\n        this._setSmoothEnabled();\n        return this;\n    }\n    _validateAdd(child) {\n        var type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util.throw('You may only add groups and shapes to a layer.');\n        }\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        config.width = config.width || this.getWidth();\n        config.height = config.height || this.getHeight();\n        config.x = config.x !== undefined ? config.x : this.x();\n        config.y = config.y !== undefined ? config.y : this.y();\n        return Node.prototype._toKonvaCanvas.call(this, config);\n    }\n    _checkVisibility() {\n        const visible = this.visible();\n        if (visible) {\n            this.canvas._canvas.style.display = 'block';\n        }\n        else {\n            this.canvas._canvas.style.display = 'none';\n        }\n    }\n    _setSmoothEnabled() {\n        this.getContext()._context.imageSmoothingEnabled =\n            this.imageSmoothingEnabled();\n    }\n    getWidth() {\n        if (this.parent) {\n            return this.parent.width();\n        }\n    }\n    setWidth() {\n        Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n    }\n    getHeight() {\n        if (this.parent) {\n            return this.parent.height();\n        }\n    }\n    setHeight() {\n        Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n    }\n    batchDraw() {\n        if (!this._waitingForDraw) {\n            this._waitingForDraw = true;\n            Util.requestAnimFrame(() => {\n                this.draw();\n                this._waitingForDraw = false;\n            });\n        }\n        return this;\n    }\n    getIntersection(pos) {\n        if (!this.isListening() || !this.isVisible()) {\n            return null;\n        }\n        var spiralSearchDistance = 1;\n        var continueSearch = false;\n        while (true) {\n            for (let i = 0; i < INTERSECTION_OFFSETS_LEN; i++) {\n                const intersectionOffset = INTERSECTION_OFFSETS[i];\n                const obj = this._getIntersection({\n                    x: pos.x + intersectionOffset.x * spiralSearchDistance,\n                    y: pos.y + intersectionOffset.y * spiralSearchDistance,\n                });\n                const shape = obj.shape;\n                if (shape) {\n                    return shape;\n                }\n                continueSearch = !!obj.antialiased;\n                if (!obj.antialiased) {\n                    break;\n                }\n            }\n            if (continueSearch) {\n                spiralSearchDistance += 1;\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    _getIntersection(pos) {\n        const ratio = this.hitCanvas.pixelRatio;\n        const p = this.hitCanvas.context.getImageData(Math.round(pos.x * ratio), Math.round(pos.y * ratio), 1, 1).data;\n        const p3 = p[3];\n        if (p3 === 255) {\n            const colorKey = Util._rgbToHex(p[0], p[1], p[2]);\n            const shape = shapes[HASH + colorKey];\n            if (shape) {\n                return {\n                    shape: shape,\n                };\n            }\n            return {\n                antialiased: true,\n            };\n        }\n        else if (p3 > 0) {\n            return {\n                antialiased: true,\n            };\n        }\n        return {};\n    }\n    drawScene(can, top) {\n        var layer = this.getLayer(), canvas = can || (layer && layer.getCanvas());\n        this._fire(BEFORE_DRAW, {\n            node: this,\n        });\n        if (this.clearBeforeDraw()) {\n            canvas.getContext().clear();\n        }\n        Container.prototype.drawScene.call(this, canvas, top);\n        this._fire(DRAW, {\n            node: this,\n        });\n        return this;\n    }\n    drawHit(can, top) {\n        var layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas);\n        if (layer && layer.clearBeforeDraw()) {\n            layer.getHitCanvas().getContext().clear();\n        }\n        Container.prototype.drawHit.call(this, canvas, top);\n        return this;\n    }\n    enableHitGraph() {\n        this.hitGraphEnabled(true);\n        return this;\n    }\n    disableHitGraph() {\n        this.hitGraphEnabled(false);\n        return this;\n    }\n    setHitGraphEnabled(val) {\n        Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        this.listening(val);\n    }\n    getHitGraphEnabled(val) {\n        Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        return this.listening();\n    }\n    toggleHitCanvas() {\n        if (!this.parent || !this.parent['content']) {\n            return;\n        }\n        var parent = this.parent;\n        var added = !!this.hitCanvas._canvas.parentNode;\n        if (added) {\n            parent.content.removeChild(this.hitCanvas._canvas);\n        }\n        else {\n            parent.content.appendChild(this.hitCanvas._canvas);\n        }\n    }\n}\nLayer.prototype.nodeType = 'Layer';\n_registerNode(Layer);\nFactory.addGetterSetter(Layer, 'imageSmoothingEnabled', true);\nFactory.addGetterSetter(Layer, 'clearBeforeDraw', true);\nFactory.addGetterSetter(Layer, 'hitGraphEnabled', true, getBooleanValidator());\n","import { Util } from './Util.js';\nimport { Layer } from './Layer.js';\nimport { _registerNode } from './Global.js';\nexport class FastLayer extends Layer {\n    constructor(attrs) {\n        super(attrs);\n        this.listening(false);\n        Util.warn('Konva.Fast layer is deprecated. Please use \"new Konva.Layer({ listening: false })\" instead.');\n    }\n}\nFastLayer.prototype.nodeType = 'FastLayer';\n_registerNode(FastLayer);\n","import { Util } from './Util.js';\nimport { Container } from './Container.js';\nimport { _registerNode } from './Global.js';\nexport class Group extends Container {\n    _validateAdd(child) {\n        var type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util.throw('You may only add groups and shapes to groups.');\n        }\n    }\n}\nGroup.prototype.nodeType = 'Group';\n_registerNode(Group);\n","import { glob } from './Global.js';\nimport { Util } from './Util.js';\nvar now = (function () {\n    if (glob.performance && glob.performance.now) {\n        return function () {\n            return glob.performance.now();\n        };\n    }\n    return function () {\n        return new Date().getTime();\n    };\n})();\nexport class Animation {\n    constructor(func, layers) {\n        this.id = Animation.animIdCounter++;\n        this.frame = {\n            time: 0,\n            timeDiff: 0,\n            lastTime: now(),\n            frameRate: 0,\n        };\n        this.func = func;\n        this.setLayers(layers);\n    }\n    setLayers(layers) {\n        var lays = [];\n        if (!layers) {\n            lays = [];\n        }\n        else if (layers.length > 0) {\n            lays = layers;\n        }\n        else {\n            lays = [layers];\n        }\n        this.layers = lays;\n        return this;\n    }\n    getLayers() {\n        return this.layers;\n    }\n    addLayer(layer) {\n        var layers = this.layers, len = layers.length, n;\n        for (n = 0; n < len; n++) {\n            if (layers[n]._id === layer._id) {\n                return false;\n            }\n        }\n        this.layers.push(layer);\n        return true;\n    }\n    isRunning() {\n        var a = Animation, animations = a.animations, len = animations.length, n;\n        for (n = 0; n < len; n++) {\n            if (animations[n].id === this.id) {\n                return true;\n            }\n        }\n        return false;\n    }\n    start() {\n        this.stop();\n        this.frame.timeDiff = 0;\n        this.frame.lastTime = now();\n        Animation._addAnimation(this);\n        return this;\n    }\n    stop() {\n        Animation._removeAnimation(this);\n        return this;\n    }\n    _updateFrameObject(time) {\n        this.frame.timeDiff = time - this.frame.lastTime;\n        this.frame.lastTime = time;\n        this.frame.time += this.frame.timeDiff;\n        this.frame.frameRate = 1000 / this.frame.timeDiff;\n    }\n    static _addAnimation(anim) {\n        this.animations.push(anim);\n        this._handleAnimation();\n    }\n    static _removeAnimation(anim) {\n        var id = anim.id, animations = this.animations, len = animations.length, n;\n        for (n = 0; n < len; n++) {\n            if (animations[n].id === id) {\n                this.animations.splice(n, 1);\n                break;\n            }\n        }\n    }\n    static _runFrames() {\n        var layerHash = {}, animations = this.animations, anim, layers, func, n, i, layersLen, layer, key, needRedraw;\n        for (n = 0; n < animations.length; n++) {\n            anim = animations[n];\n            layers = anim.layers;\n            func = anim.func;\n            anim._updateFrameObject(now());\n            layersLen = layers.length;\n            if (func) {\n                needRedraw = func.call(anim, anim.frame) !== false;\n            }\n            else {\n                needRedraw = true;\n            }\n            if (!needRedraw) {\n                continue;\n            }\n            for (i = 0; i < layersLen; i++) {\n                layer = layers[i];\n                if (layer._id !== undefined) {\n                    layerHash[layer._id] = layer;\n                }\n            }\n        }\n        for (key in layerHash) {\n            if (!layerHash.hasOwnProperty(key)) {\n                continue;\n            }\n            layerHash[key].batchDraw();\n        }\n    }\n    static _animationLoop() {\n        var Anim = Animation;\n        if (Anim.animations.length) {\n            Anim._runFrames();\n            Util.requestAnimFrame(Anim._animationLoop);\n        }\n        else {\n            Anim.animRunning = false;\n        }\n    }\n    static _handleAnimation() {\n        if (!this.animRunning) {\n            this.animRunning = true;\n            Util.requestAnimFrame(this._animationLoop);\n        }\n    }\n}\nAnimation.animations = [];\nAnimation.animIdCounter = 0;\nAnimation.animRunning = false;\n","import { Util } from './Util.js';\nimport { Animation } from './Animation.js';\nimport { Node } from './Node.js';\nimport { Konva } from './Global.js';\nvar blacklist = {\n    node: 1,\n    duration: 1,\n    easing: 1,\n    onFinish: 1,\n    yoyo: 1,\n}, PAUSED = 1, PLAYING = 2, REVERSING = 3, idCounter = 0, colorAttrs = ['fill', 'stroke', 'shadowColor'];\nclass TweenEngine {\n    constructor(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    }\n    fire(str) {\n        var handler = this[str];\n        if (handler) {\n            handler();\n        }\n    }\n    setTime(t) {\n        if (t > this.duration) {\n            if (this.yoyo) {\n                this._time = this.duration;\n                this.reverse();\n            }\n            else {\n                this.finish();\n            }\n        }\n        else if (t < 0) {\n            if (this.yoyo) {\n                this._time = 0;\n                this.play();\n            }\n            else {\n                this.reset();\n            }\n        }\n        else {\n            this._time = t;\n            this.update();\n        }\n    }\n    getTime() {\n        return this._time;\n    }\n    setPosition(p) {\n        this.prevPos = this._pos;\n        this.propFunc(p);\n        this._pos = p;\n    }\n    getPosition(t) {\n        if (t === undefined) {\n            t = this._time;\n        }\n        return this.func(t, this.begin, this._change, this.duration);\n    }\n    play() {\n        this.state = PLAYING;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onPlay');\n    }\n    reverse() {\n        this.state = REVERSING;\n        this._time = this.duration - this._time;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onReverse');\n    }\n    seek(t) {\n        this.pause();\n        this._time = t;\n        this.update();\n        this.fire('onSeek');\n    }\n    reset() {\n        this.pause();\n        this._time = 0;\n        this.update();\n        this.fire('onReset');\n    }\n    finish() {\n        this.pause();\n        this._time = this.duration;\n        this.update();\n        this.fire('onFinish');\n    }\n    update() {\n        this.setPosition(this.getPosition(this._time));\n        this.fire('onUpdate');\n    }\n    onEnterFrame() {\n        var t = this.getTimer() - this._startTime;\n        if (this.state === PLAYING) {\n            this.setTime(t);\n        }\n        else if (this.state === REVERSING) {\n            this.setTime(this.duration - t);\n        }\n    }\n    pause() {\n        this.state = PAUSED;\n        this.fire('onPause');\n    }\n    getTimer() {\n        return new Date().getTime();\n    }\n}\nexport class Tween {\n    constructor(config) {\n        var that = this, node = config.node, nodeId = node._id, duration, easing = config.easing || Easings.Linear, yoyo = !!config.yoyo, key;\n        if (typeof config.duration === 'undefined') {\n            duration = 0.3;\n        }\n        else if (config.duration === 0) {\n            duration = 0.001;\n        }\n        else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n        var layers = node.getLayer() ||\n            (node instanceof Konva['Stage'] ? node.getLayers() : null);\n        if (!layers) {\n            Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n        }\n        this.anim = new Animation(function () {\n            that.tween.onEnterFrame();\n        }, layers);\n        this.tween = new TweenEngine(key, function (i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n        this._addListeners();\n        if (!Tween.attrs[nodeId]) {\n            Tween.attrs[nodeId] = {};\n        }\n        if (!Tween.attrs[nodeId][this._id]) {\n            Tween.attrs[nodeId][this._id] = {};\n        }\n        if (!Tween.tweens[nodeId]) {\n            Tween.tweens[nodeId] = {};\n        }\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n        this.reset();\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n        this.onUpdate = config.onUpdate;\n    }\n    _addAttr(key, end) {\n        var node = this.node, nodeId = node._id, start, diff, tweenId, n, len, trueEnd, trueStart, endRGBA;\n        tweenId = Tween.tweens[nodeId][key];\n        if (tweenId) {\n            delete Tween.attrs[nodeId][tweenId][key];\n        }\n        start = node.getAttr(key);\n        if (Util._isArray(end)) {\n            diff = [];\n            len = Math.max(end.length, start.length);\n            if (key === 'points' && end.length !== start.length) {\n                if (end.length > start.length) {\n                    trueStart = start;\n                    start = Util._prepareArrayForTween(start, end, node.closed());\n                }\n                else {\n                    trueEnd = end;\n                    end = Util._prepareArrayForTween(end, start, node.closed());\n                }\n            }\n            if (key.indexOf('fill') === 0) {\n                for (n = 0; n < len; n++) {\n                    if (n % 2 === 0) {\n                        diff.push(end[n] - start[n]);\n                    }\n                    else {\n                        var startRGBA = Util.colorToRGBA(start[n]);\n                        endRGBA = Util.colorToRGBA(end[n]);\n                        start[n] = startRGBA;\n                        diff.push({\n                            r: endRGBA.r - startRGBA.r,\n                            g: endRGBA.g - startRGBA.g,\n                            b: endRGBA.b - startRGBA.b,\n                            a: endRGBA.a - startRGBA.a,\n                        });\n                    }\n                }\n            }\n            else {\n                for (n = 0; n < len; n++) {\n                    diff.push(end[n] - start[n]);\n                }\n            }\n        }\n        else if (colorAttrs.indexOf(key) !== -1) {\n            start = Util.colorToRGBA(start);\n            endRGBA = Util.colorToRGBA(end);\n            diff = {\n                r: endRGBA.r - start.r,\n                g: endRGBA.g - start.g,\n                b: endRGBA.b - start.b,\n                a: endRGBA.a - start.a,\n            };\n        }\n        else {\n            diff = end - start;\n        }\n        Tween.attrs[nodeId][this._id][key] = {\n            start: start,\n            diff: diff,\n            end: end,\n            trueEnd: trueEnd,\n            trueStart: trueStart,\n        };\n        Tween.tweens[nodeId][key] = this._id;\n    }\n    _tweenFunc(i) {\n        var node = this.node, attrs = Tween.attrs[node._id][this._id], key, attr, start, diff, newVal, n, len, end;\n        for (key in attrs) {\n            attr = attrs[key];\n            start = attr.start;\n            diff = attr.diff;\n            end = attr.end;\n            if (Util._isArray(start)) {\n                newVal = [];\n                len = Math.max(start.length, end.length);\n                if (key.indexOf('fill') === 0) {\n                    for (n = 0; n < len; n++) {\n                        if (n % 2 === 0) {\n                            newVal.push((start[n] || 0) + diff[n] * i);\n                        }\n                        else {\n                            newVal.push('rgba(' +\n                                Math.round(start[n].r + diff[n].r * i) +\n                                ',' +\n                                Math.round(start[n].g + diff[n].g * i) +\n                                ',' +\n                                Math.round(start[n].b + diff[n].b * i) +\n                                ',' +\n                                (start[n].a + diff[n].a * i) +\n                                ')');\n                        }\n                    }\n                }\n                else {\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + diff[n] * i);\n                    }\n                }\n            }\n            else if (colorAttrs.indexOf(key) !== -1) {\n                newVal =\n                    'rgba(' +\n                        Math.round(start.r + diff.r * i) +\n                        ',' +\n                        Math.round(start.g + diff.g * i) +\n                        ',' +\n                        Math.round(start.b + diff.b * i) +\n                        ',' +\n                        (start.a + diff.a * i) +\n                        ')';\n            }\n            else {\n                newVal = start + diff * i;\n            }\n            node.setAttr(key, newVal);\n        }\n    }\n    _addListeners() {\n        this.tween.onPlay = () => {\n            this.anim.start();\n        };\n        this.tween.onReverse = () => {\n            this.anim.start();\n        };\n        this.tween.onPause = () => {\n            this.anim.stop();\n        };\n        this.tween.onFinish = () => {\n            var node = this.node;\n            var attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueEnd) {\n                node.setAttr('points', attrs.points.trueEnd);\n            }\n            if (this.onFinish) {\n                this.onFinish.call(this);\n            }\n        };\n        this.tween.onReset = () => {\n            var node = this.node;\n            var attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueStart) {\n                node.points(attrs.points.trueStart);\n            }\n            if (this.onReset) {\n                this.onReset();\n            }\n        };\n        this.tween.onUpdate = () => {\n            if (this.onUpdate) {\n                this.onUpdate.call(this);\n            }\n        };\n    }\n    play() {\n        this.tween.play();\n        return this;\n    }\n    reverse() {\n        this.tween.reverse();\n        return this;\n    }\n    reset() {\n        this.tween.reset();\n        return this;\n    }\n    seek(t) {\n        this.tween.seek(t * 1000);\n        return this;\n    }\n    pause() {\n        this.tween.pause();\n        return this;\n    }\n    finish() {\n        this.tween.finish();\n        return this;\n    }\n    destroy() {\n        var nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId], key;\n        this.pause();\n        for (key in attrs) {\n            delete Tween.tweens[nodeId][key];\n        }\n        delete Tween.attrs[nodeId][thisId];\n    }\n}\nTween.attrs = {};\nTween.tweens = {};\nNode.prototype.to = function (params) {\n    var onFinish = params.onFinish;\n    params.node = this;\n    params.onFinish = function () {\n        this.destroy();\n        if (onFinish) {\n            onFinish();\n        }\n    };\n    var tween = new Tween(params);\n    tween.play();\n};\nexport const Easings = {\n    BackEaseIn(t, b, c, d) {\n        var s = 1.70158;\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    BackEaseOut(t, b, c, d) {\n        var s = 1.70158;\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    BackEaseInOut(t, b, c, d) {\n        var s = 1.70158;\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n        }\n        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    },\n    ElasticEaseIn(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (-(a *\n            Math.pow(2, 10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);\n    },\n    ElasticEaseOut(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n            c +\n            b);\n    },\n    ElasticEaseInOut(t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return (-0.5 *\n                (a *\n                    Math.pow(2, 10 * (t -= 1)) *\n                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +\n                b);\n        }\n        return (a *\n            Math.pow(2, -10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            c +\n            b);\n    },\n    BounceEaseOut(t, b, c, d) {\n        if ((t /= d) < 1 / 2.75) {\n            return c * (7.5625 * t * t) + b;\n        }\n        else if (t < 2 / 2.75) {\n            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        }\n        else if (t < 2.5 / 2.75) {\n            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        }\n        else {\n            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    },\n    BounceEaseIn(t, b, c, d) {\n        return c - Easings.BounceEaseOut(d - t, 0, c, d) + b;\n    },\n    BounceEaseInOut(t, b, c, d) {\n        if (t < d / 2) {\n            return Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n        }\n        else {\n            return Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n    },\n    EaseIn(t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n    EaseOut(t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n    EaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t + b;\n        }\n        return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n    StrongEaseIn(t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n    StrongEaseOut(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    StrongEaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t * t * t * t + b;\n        }\n        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n    Linear(t, b, c, d) {\n        return (c * t) / d + b;\n    },\n};\n","import { Konva as Global } from './Global.js';\nimport { Util, Transform } from './Util.js';\nimport { Node } from './Node.js';\nimport { Container } from './Container.js';\nimport { Stage, stages } from './Stage.js';\nimport { Layer } from './Layer.js';\nimport { FastLayer } from './FastLayer.js';\nimport { Group } from './Group.js';\nimport { DD } from './DragAndDrop.js';\nimport { Shape, shapes } from './Shape.js';\nimport { Animation } from './Animation.js';\nimport { Tween, Easings } from './Tween.js';\nimport { Context } from './Context.js';\nimport { Canvas } from './Canvas.js';\nexport const Konva = Util._assign(Global, {\n    Util,\n    Transform,\n    Node,\n    Container,\n    Stage,\n    stages,\n    Layer,\n    FastLayer,\n    Group,\n    DD,\n    Shape,\n    shapes,\n    Animation,\n    Tween,\n    Easings,\n    Context,\n    Canvas,\n});\nexport default Konva;\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { Konva } from '../Global.js';\nimport { getNumberValidator, getBooleanValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Arc extends Shape {\n    _sceneFunc(context) {\n        var angle = Konva.getAngle(this.angle()), clockwise = this.clockwise();\n        context.beginPath();\n        context.arc(0, 0, this.outerRadius(), 0, angle, clockwise);\n        context.arc(0, 0, this.innerRadius(), angle, 0, !clockwise);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.outerRadius() * 2;\n    }\n    getHeight() {\n        return this.outerRadius() * 2;\n    }\n    setWidth(width) {\n        this.outerRadius(width / 2);\n    }\n    setHeight(height) {\n        this.outerRadius(height / 2);\n    }\n}\nArc.prototype._centroid = true;\nArc.prototype.className = 'Arc';\nArc.prototype._attrsAffectingSize = ['innerRadius', 'outerRadius'];\n_registerNode(Arc);\nFactory.addGetterSetter(Arc, 'innerRadius', 0, getNumberValidator());\nFactory.addGetterSetter(Arc, 'outerRadius', 0, getNumberValidator());\nFactory.addGetterSetter(Arc, 'angle', 0, getNumberValidator());\nFactory.addGetterSetter(Arc, 'clockwise', false, getBooleanValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator, getNumberArrayValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nfunction getControlPoints(x0, y0, x1, y1, x2, y2, t) {\n    var d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2)), d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)), fa = (t * d01) / (d01 + d12), fb = (t * d12) / (d01 + d12), p1x = x1 - fa * (x2 - x0), p1y = y1 - fa * (y2 - y0), p2x = x1 + fb * (x2 - x0), p2y = y1 + fb * (y2 - y0);\n    return [p1x, p1y, p2x, p2y];\n}\nfunction expandPoints(p, tension) {\n    var len = p.length, allPoints = [], n, cp;\n    for (n = 2; n < len - 2; n += 2) {\n        cp = getControlPoints(p[n - 2], p[n - 1], p[n], p[n + 1], p[n + 2], p[n + 3], tension);\n        if (isNaN(cp[0])) {\n            continue;\n        }\n        allPoints.push(cp[0]);\n        allPoints.push(cp[1]);\n        allPoints.push(p[n]);\n        allPoints.push(p[n + 1]);\n        allPoints.push(cp[2]);\n        allPoints.push(cp[3]);\n    }\n    return allPoints;\n}\nexport class Line extends Shape {\n    constructor(config) {\n        super(config);\n        this.on('pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva', function () {\n            this._clearCache('tensionPoints');\n        });\n    }\n    _sceneFunc(context) {\n        var points = this.points(), length = points.length, tension = this.tension(), closed = this.closed(), bezier = this.bezier(), tp, len, n;\n        if (!length) {\n            return;\n        }\n        context.beginPath();\n        context.moveTo(points[0], points[1]);\n        if (tension !== 0 && length > 4) {\n            tp = this.getTensionPoints();\n            len = tp.length;\n            n = closed ? 0 : 4;\n            if (!closed) {\n                context.quadraticCurveTo(tp[0], tp[1], tp[2], tp[3]);\n            }\n            while (n < len - 2) {\n                context.bezierCurveTo(tp[n++], tp[n++], tp[n++], tp[n++], tp[n++], tp[n++]);\n            }\n            if (!closed) {\n                context.quadraticCurveTo(tp[len - 2], tp[len - 1], points[length - 2], points[length - 1]);\n            }\n        }\n        else if (bezier) {\n            n = 2;\n            while (n < length) {\n                context.bezierCurveTo(points[n++], points[n++], points[n++], points[n++], points[n++], points[n++]);\n            }\n        }\n        else {\n            for (n = 2; n < length; n += 2) {\n                context.lineTo(points[n], points[n + 1]);\n            }\n        }\n        if (closed) {\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        else {\n            context.strokeShape(this);\n        }\n    }\n    getTensionPoints() {\n        return this._getCache('tensionPoints', this._getTensionPoints);\n    }\n    _getTensionPoints() {\n        if (this.closed()) {\n            return this._getTensionPointsClosed();\n        }\n        else {\n            return expandPoints(this.points(), this.tension());\n        }\n    }\n    _getTensionPointsClosed() {\n        var p = this.points(), len = p.length, tension = this.tension(), firstControlPoints = getControlPoints(p[len - 2], p[len - 1], p[0], p[1], p[2], p[3], tension), lastControlPoints = getControlPoints(p[len - 4], p[len - 3], p[len - 2], p[len - 1], p[0], p[1], tension), middle = expandPoints(p, tension), tp = [firstControlPoints[2], firstControlPoints[3]]\n            .concat(middle)\n            .concat([\n            lastControlPoints[0],\n            lastControlPoints[1],\n            p[len - 2],\n            p[len - 1],\n            lastControlPoints[2],\n            lastControlPoints[3],\n            firstControlPoints[0],\n            firstControlPoints[1],\n            p[0],\n            p[1],\n        ]);\n        return tp;\n    }\n    getWidth() {\n        return this.getSelfRect().width;\n    }\n    getHeight() {\n        return this.getSelfRect().height;\n    }\n    getSelfRect() {\n        var points = this.points();\n        if (points.length < 4) {\n            return {\n                x: points[0] || 0,\n                y: points[1] || 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (this.tension() !== 0) {\n            points = [\n                points[0],\n                points[1],\n                ...this._getTensionPoints(),\n                points[points.length - 2],\n                points[points.length - 1],\n            ];\n        }\n        else {\n            points = this.points();\n        }\n        var minX = points[0];\n        var maxX = points[0];\n        var minY = points[1];\n        var maxY = points[1];\n        var x, y;\n        for (var i = 0; i < points.length / 2; i++) {\n            x = points[i * 2];\n            y = points[i * 2 + 1];\n            minX = Math.min(minX, x);\n            maxX = Math.max(maxX, x);\n            minY = Math.min(minY, y);\n            maxY = Math.max(maxY, y);\n        }\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n}\nLine.prototype.className = 'Line';\nLine.prototype._attrsAffectingSize = ['points', 'bezier', 'tension'];\n_registerNode(Line);\nFactory.addGetterSetter(Line, 'closed', false);\nFactory.addGetterSetter(Line, 'bezier', false);\nFactory.addGetterSetter(Line, 'tension', 0, getNumberValidator());\nFactory.addGetterSetter(Line, 'points', [], getNumberArrayValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { _registerNode } from '../Global.js';\nexport class Path extends Shape {\n    constructor(config) {\n        super(config);\n        this.dataArray = [];\n        this.pathLength = 0;\n        this.dataArray = Path.parsePathData(this.data());\n        this.pathLength = 0;\n        for (var i = 0; i < this.dataArray.length; ++i) {\n            this.pathLength += this.dataArray[i].pathLength;\n        }\n        this.on('dataChange.konva', function () {\n            this.dataArray = Path.parsePathData(this.data());\n            this.pathLength = 0;\n            for (var i = 0; i < this.dataArray.length; ++i) {\n                this.pathLength += this.dataArray[i].pathLength;\n            }\n        });\n    }\n    _sceneFunc(context) {\n        var ca = this.dataArray;\n        context.beginPath();\n        var isClosed = false;\n        for (var n = 0; n < ca.length; n++) {\n            var c = ca[n].command;\n            var p = ca[n].points;\n            switch (c) {\n                case 'L':\n                    context.lineTo(p[0], p[1]);\n                    break;\n                case 'M':\n                    context.moveTo(p[0], p[1]);\n                    break;\n                case 'C':\n                    context.bezierCurveTo(p[0], p[1], p[2], p[3], p[4], p[5]);\n                    break;\n                case 'Q':\n                    context.quadraticCurveTo(p[0], p[1], p[2], p[3]);\n                    break;\n                case 'A':\n                    var cx = p[0], cy = p[1], rx = p[2], ry = p[3], theta = p[4], dTheta = p[5], psi = p[6], fs = p[7];\n                    var r = rx > ry ? rx : ry;\n                    var scaleX = rx > ry ? 1 : rx / ry;\n                    var scaleY = rx > ry ? ry / rx : 1;\n                    context.translate(cx, cy);\n                    context.rotate(psi);\n                    context.scale(scaleX, scaleY);\n                    context.arc(0, 0, r, theta, theta + dTheta, 1 - fs);\n                    context.scale(1 / scaleX, 1 / scaleY);\n                    context.rotate(-psi);\n                    context.translate(-cx, -cy);\n                    break;\n                case 'z':\n                    isClosed = true;\n                    context.closePath();\n                    break;\n            }\n        }\n        if (!isClosed && !this.hasFill()) {\n            context.strokeShape(this);\n        }\n        else {\n            context.fillStrokeShape(this);\n        }\n    }\n    getSelfRect() {\n        var points = [];\n        this.dataArray.forEach(function (data) {\n            if (data.command === 'A') {\n                var start = data.points[4];\n                var dTheta = data.points[5];\n                var end = data.points[4] + dTheta;\n                var inc = Math.PI / 180.0;\n                if (Math.abs(start - end) < inc) {\n                    inc = Math.abs(start - end);\n                }\n                if (dTheta < 0) {\n                    for (let t = start - inc; t > end; t -= inc) {\n                        const point = Path.getPointOnEllipticalArc(data.points[0], data.points[1], data.points[2], data.points[3], t, 0);\n                        points.push(point.x, point.y);\n                    }\n                }\n                else {\n                    for (let t = start + inc; t < end; t += inc) {\n                        const point = Path.getPointOnEllipticalArc(data.points[0], data.points[1], data.points[2], data.points[3], t, 0);\n                        points.push(point.x, point.y);\n                    }\n                }\n            }\n            else if (data.command === 'C') {\n                for (let t = 0.0; t <= 1; t += 0.01) {\n                    const point = Path.getPointOnCubicBezier(t, data.start.x, data.start.y, data.points[0], data.points[1], data.points[2], data.points[3], data.points[4], data.points[5]);\n                    points.push(point.x, point.y);\n                }\n            }\n            else {\n                points = points.concat(data.points);\n            }\n        });\n        var minX = points[0];\n        var maxX = points[0];\n        var minY = points[1];\n        var maxY = points[1];\n        var x, y;\n        for (var i = 0; i < points.length / 2; i++) {\n            x = points[i * 2];\n            y = points[i * 2 + 1];\n            if (!isNaN(x)) {\n                minX = Math.min(minX, x);\n                maxX = Math.max(maxX, x);\n            }\n            if (!isNaN(y)) {\n                minY = Math.min(minY, y);\n                maxY = Math.max(maxY, y);\n            }\n        }\n        return {\n            x: Math.round(minX),\n            y: Math.round(minY),\n            width: Math.round(maxX - minX),\n            height: Math.round(maxY - minY),\n        };\n    }\n    getLength() {\n        return this.pathLength;\n    }\n    getPointAtLength(length) {\n        var point, i = 0, ii = this.dataArray.length;\n        if (!ii) {\n            return null;\n        }\n        while (i < ii && length > this.dataArray[i].pathLength) {\n            length -= this.dataArray[i].pathLength;\n            ++i;\n        }\n        if (i === ii) {\n            point = this.dataArray[i - 1].points.slice(-2);\n            return {\n                x: point[0],\n                y: point[1],\n            };\n        }\n        if (length < 0.01) {\n            point = this.dataArray[i].points.slice(0, 2);\n            return {\n                x: point[0],\n                y: point[1],\n            };\n        }\n        var cp = this.dataArray[i];\n        var p = cp.points;\n        switch (cp.command) {\n            case 'L':\n                return Path.getPointOnLine(length, cp.start.x, cp.start.y, p[0], p[1]);\n            case 'C':\n                return Path.getPointOnCubicBezier(length / cp.pathLength, cp.start.x, cp.start.y, p[0], p[1], p[2], p[3], p[4], p[5]);\n            case 'Q':\n                return Path.getPointOnQuadraticBezier(length / cp.pathLength, cp.start.x, cp.start.y, p[0], p[1], p[2], p[3]);\n            case 'A':\n                var cx = p[0], cy = p[1], rx = p[2], ry = p[3], theta = p[4], dTheta = p[5], psi = p[6];\n                theta += (dTheta * length) / cp.pathLength;\n                return Path.getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi);\n        }\n        return null;\n    }\n    static getLineLength(x1, y1, x2, y2) {\n        return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    }\n    static getPointOnLine(dist, P1x, P1y, P2x, P2y, fromX, fromY) {\n        if (fromX === undefined) {\n            fromX = P1x;\n        }\n        if (fromY === undefined) {\n            fromY = P1y;\n        }\n        var m = (P2y - P1y) / (P2x - P1x + 0.00000001);\n        var run = Math.sqrt((dist * dist) / (1 + m * m));\n        if (P2x < P1x) {\n            run *= -1;\n        }\n        var rise = m * run;\n        var pt;\n        if (P2x === P1x) {\n            pt = {\n                x: fromX,\n                y: fromY + rise,\n            };\n        }\n        else if ((fromY - P1y) / (fromX - P1x + 0.00000001) === m) {\n            pt = {\n                x: fromX + run,\n                y: fromY + rise,\n            };\n        }\n        else {\n            var ix, iy;\n            var len = this.getLineLength(P1x, P1y, P2x, P2y);\n            var u = (fromX - P1x) * (P2x - P1x) + (fromY - P1y) * (P2y - P1y);\n            u = u / (len * len);\n            ix = P1x + u * (P2x - P1x);\n            iy = P1y + u * (P2y - P1y);\n            var pRise = this.getLineLength(fromX, fromY, ix, iy);\n            var pRun = Math.sqrt(dist * dist - pRise * pRise);\n            run = Math.sqrt((pRun * pRun) / (1 + m * m));\n            if (P2x < P1x) {\n                run *= -1;\n            }\n            rise = m * run;\n            pt = {\n                x: ix + run,\n                y: iy + rise,\n            };\n        }\n        return pt;\n    }\n    static getPointOnCubicBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y, P4x, P4y) {\n        function CB1(t) {\n            return t * t * t;\n        }\n        function CB2(t) {\n            return 3 * t * t * (1 - t);\n        }\n        function CB3(t) {\n            return 3 * t * (1 - t) * (1 - t);\n        }\n        function CB4(t) {\n            return (1 - t) * (1 - t) * (1 - t);\n        }\n        var x = P4x * CB1(pct) + P3x * CB2(pct) + P2x * CB3(pct) + P1x * CB4(pct);\n        var y = P4y * CB1(pct) + P3y * CB2(pct) + P2y * CB3(pct) + P1y * CB4(pct);\n        return {\n            x: x,\n            y: y,\n        };\n    }\n    static getPointOnQuadraticBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y) {\n        function QB1(t) {\n            return t * t;\n        }\n        function QB2(t) {\n            return 2 * t * (1 - t);\n        }\n        function QB3(t) {\n            return (1 - t) * (1 - t);\n        }\n        var x = P3x * QB1(pct) + P2x * QB2(pct) + P1x * QB3(pct);\n        var y = P3y * QB1(pct) + P2y * QB2(pct) + P1y * QB3(pct);\n        return {\n            x: x,\n            y: y,\n        };\n    }\n    static getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi) {\n        var cosPsi = Math.cos(psi), sinPsi = Math.sin(psi);\n        var pt = {\n            x: rx * Math.cos(theta),\n            y: ry * Math.sin(theta),\n        };\n        return {\n            x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n            y: cy + (pt.x * sinPsi + pt.y * cosPsi),\n        };\n    }\n    static parsePathData(data) {\n        if (!data) {\n            return [];\n        }\n        var cs = data;\n        var cc = [\n            'm',\n            'M',\n            'l',\n            'L',\n            'v',\n            'V',\n            'h',\n            'H',\n            'z',\n            'Z',\n            'c',\n            'C',\n            'q',\n            'Q',\n            't',\n            'T',\n            's',\n            'S',\n            'a',\n            'A',\n        ];\n        cs = cs.replace(new RegExp(' ', 'g'), ',');\n        for (var n = 0; n < cc.length; n++) {\n            cs = cs.replace(new RegExp(cc[n], 'g'), '|' + cc[n]);\n        }\n        var arr = cs.split('|');\n        var ca = [];\n        var coords = [];\n        var cpx = 0;\n        var cpy = 0;\n        var re = /([-+]?((\\d+\\.\\d+)|((\\d+)|(\\.\\d+)))(?:e[-+]?\\d+)?)/gi;\n        var match;\n        for (n = 1; n < arr.length; n++) {\n            var str = arr[n];\n            var c = str.charAt(0);\n            str = str.slice(1);\n            coords.length = 0;\n            while ((match = re.exec(str))) {\n                coords.push(match[0]);\n            }\n            var p = [];\n            for (var j = 0, jlen = coords.length; j < jlen; j++) {\n                if (coords[j] === '00') {\n                    p.push(0, 0);\n                    continue;\n                }\n                var parsed = parseFloat(coords[j]);\n                if (!isNaN(parsed)) {\n                    p.push(parsed);\n                }\n                else {\n                    p.push(0);\n                }\n            }\n            while (p.length > 0) {\n                if (isNaN(p[0])) {\n                    break;\n                }\n                var cmd = null;\n                var points = [];\n                var startX = cpx, startY = cpy;\n                var prevCmd, ctlPtx, ctlPty;\n                var rx, ry, psi, fa, fs, x1, y1;\n                switch (c) {\n                    case 'l':\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'L':\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n                    case 'm':\n                        var dx = p.shift();\n                        var dy = p.shift();\n                        cpx += dx;\n                        cpy += dy;\n                        cmd = 'M';\n                        if (ca.length > 2 && ca[ca.length - 1].command === 'z') {\n                            for (var idx = ca.length - 2; idx >= 0; idx--) {\n                                if (ca[idx].command === 'M') {\n                                    cpx = ca[idx].points[0] + dx;\n                                    cpy = ca[idx].points[1] + dy;\n                                    break;\n                                }\n                            }\n                        }\n                        points.push(cpx, cpy);\n                        c = 'l';\n                        break;\n                    case 'M':\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'M';\n                        points.push(cpx, cpy);\n                        c = 'L';\n                        break;\n                    case 'h':\n                        cpx += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'H':\n                        cpx = p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'v':\n                        cpy += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'V':\n                        cpy = p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'C':\n                        points.push(p.shift(), p.shift(), p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n                    case 'c':\n                        points.push(cpx + p.shift(), cpy + p.shift(), cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'S':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if (prevCmd.command === 'C') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[2]);\n                            ctlPty = cpy + (cpy - prevCmd.points[3]);\n                        }\n                        points.push(ctlPtx, ctlPty, p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 's':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if (prevCmd.command === 'C') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[2]);\n                            ctlPty = cpy + (cpy - prevCmd.points[3]);\n                        }\n                        points.push(ctlPtx, ctlPty, cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'Q':\n                        points.push(p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n                    case 'q':\n                        points.push(cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'Q';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'T':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if (prevCmd.command === 'Q') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[0]);\n                            ctlPty = cpy + (cpy - prevCmd.points[1]);\n                        }\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'Q';\n                        points.push(ctlPtx, ctlPty, cpx, cpy);\n                        break;\n                    case 't':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if (prevCmd.command === 'Q') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[0]);\n                            ctlPty = cpy + (cpy - prevCmd.points[1]);\n                        }\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'Q';\n                        points.push(ctlPtx, ctlPty, cpx, cpy);\n                        break;\n                    case 'A':\n                        rx = p.shift();\n                        ry = p.shift();\n                        psi = p.shift();\n                        fa = p.shift();\n                        fs = p.shift();\n                        x1 = cpx;\n                        y1 = cpy;\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'A';\n                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);\n                        break;\n                    case 'a':\n                        rx = p.shift();\n                        ry = p.shift();\n                        psi = p.shift();\n                        fa = p.shift();\n                        fs = p.shift();\n                        x1 = cpx;\n                        y1 = cpy;\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'A';\n                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);\n                        break;\n                }\n                ca.push({\n                    command: cmd || c,\n                    points: points,\n                    start: {\n                        x: startX,\n                        y: startY,\n                    },\n                    pathLength: this.calcLength(startX, startY, cmd || c, points),\n                });\n            }\n            if (c === 'z' || c === 'Z') {\n                ca.push({\n                    command: 'z',\n                    points: [],\n                    start: undefined,\n                    pathLength: 0,\n                });\n            }\n        }\n        return ca;\n    }\n    static calcLength(x, y, cmd, points) {\n        var len, p1, p2, t;\n        var path = Path;\n        switch (cmd) {\n            case 'L':\n                return path.getLineLength(x, y, points[0], points[1]);\n            case 'C':\n                len = 0.0;\n                p1 = path.getPointOnCubicBezier(0, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n                for (t = 0.01; t <= 1; t += 0.01) {\n                    p2 = path.getPointOnCubicBezier(t, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n                    len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                    p1 = p2;\n                }\n                return len;\n            case 'Q':\n                len = 0.0;\n                p1 = path.getPointOnQuadraticBezier(0, x, y, points[0], points[1], points[2], points[3]);\n                for (t = 0.01; t <= 1; t += 0.01) {\n                    p2 = path.getPointOnQuadraticBezier(t, x, y, points[0], points[1], points[2], points[3]);\n                    len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                    p1 = p2;\n                }\n                return len;\n            case 'A':\n                len = 0.0;\n                var start = points[4];\n                var dTheta = points[5];\n                var end = points[4] + dTheta;\n                var inc = Math.PI / 180.0;\n                if (Math.abs(start - end) < inc) {\n                    inc = Math.abs(start - end);\n                }\n                p1 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);\n                if (dTheta < 0) {\n                    for (t = start - inc; t > end; t -= inc) {\n                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                        p1 = p2;\n                    }\n                }\n                else {\n                    for (t = start + inc; t < end; t += inc) {\n                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                        p1 = p2;\n                    }\n                }\n                p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);\n                len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                return len;\n        }\n        return 0;\n    }\n    static convertEndpointToCenterParameterization(x1, y1, x2, y2, fa, fs, rx, ry, psiDeg) {\n        var psi = psiDeg * (Math.PI / 180.0);\n        var xp = (Math.cos(psi) * (x1 - x2)) / 2.0 + (Math.sin(psi) * (y1 - y2)) / 2.0;\n        var yp = (-1 * Math.sin(psi) * (x1 - x2)) / 2.0 +\n            (Math.cos(psi) * (y1 - y2)) / 2.0;\n        var lambda = (xp * xp) / (rx * rx) + (yp * yp) / (ry * ry);\n        if (lambda > 1) {\n            rx *= Math.sqrt(lambda);\n            ry *= Math.sqrt(lambda);\n        }\n        var f = Math.sqrt((rx * rx * (ry * ry) - rx * rx * (yp * yp) - ry * ry * (xp * xp)) /\n            (rx * rx * (yp * yp) + ry * ry * (xp * xp)));\n        if (fa === fs) {\n            f *= -1;\n        }\n        if (isNaN(f)) {\n            f = 0;\n        }\n        var cxp = (f * rx * yp) / ry;\n        var cyp = (f * -ry * xp) / rx;\n        var cx = (x1 + x2) / 2.0 + Math.cos(psi) * cxp - Math.sin(psi) * cyp;\n        var cy = (y1 + y2) / 2.0 + Math.sin(psi) * cxp + Math.cos(psi) * cyp;\n        var vMag = function (v) {\n            return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n        };\n        var vRatio = function (u, v) {\n            return (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v));\n        };\n        var vAngle = function (u, v) {\n            return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));\n        };\n        var theta = vAngle([1, 0], [(xp - cxp) / rx, (yp - cyp) / ry]);\n        var u = [(xp - cxp) / rx, (yp - cyp) / ry];\n        var v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];\n        var dTheta = vAngle(u, v);\n        if (vRatio(u, v) <= -1) {\n            dTheta = Math.PI;\n        }\n        if (vRatio(u, v) >= 1) {\n            dTheta = 0;\n        }\n        if (fs === 0 && dTheta > 0) {\n            dTheta = dTheta - 2 * Math.PI;\n        }\n        if (fs === 1 && dTheta < 0) {\n            dTheta = dTheta + 2 * Math.PI;\n        }\n        return [cx, cy, rx, ry, theta, dTheta, psi, fs];\n    }\n}\nPath.prototype.className = 'Path';\nPath.prototype._attrsAffectingSize = ['data'];\n_registerNode(Path);\nFactory.addGetterSetter(Path, 'data');\n","import { Factory } from '../Factory.js';\nimport { Line } from './Line.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nimport { Path } from './Path.js';\nexport class Arrow extends Line {\n    _sceneFunc(ctx) {\n        super._sceneFunc(ctx);\n        var PI2 = Math.PI * 2;\n        var points = this.points();\n        var tp = points;\n        var fromTension = this.tension() !== 0 && points.length > 4;\n        if (fromTension) {\n            tp = this.getTensionPoints();\n        }\n        var length = this.pointerLength();\n        var n = points.length;\n        var dx, dy;\n        if (fromTension) {\n            const lp = [\n                tp[tp.length - 4],\n                tp[tp.length - 3],\n                tp[tp.length - 2],\n                tp[tp.length - 1],\n                points[n - 2],\n                points[n - 1],\n            ];\n            const lastLength = Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);\n            const previous = Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);\n            dx = points[n - 2] - previous.x;\n            dy = points[n - 1] - previous.y;\n        }\n        else {\n            dx = points[n - 2] - points[n - 4];\n            dy = points[n - 1] - points[n - 3];\n        }\n        var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n        var width = this.pointerWidth();\n        if (this.pointerAtEnding()) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[n - 2], points[n - 1]);\n            ctx.rotate(radians);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n        }\n        if (this.pointerAtBeginning()) {\n            ctx.save();\n            ctx.translate(points[0], points[1]);\n            if (fromTension) {\n                dx = (tp[0] + tp[2]) / 2 - points[0];\n                dy = (tp[1] + tp[3]) / 2 - points[1];\n            }\n            else {\n                dx = points[2] - points[0];\n                dy = points[3] - points[1];\n            }\n            ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n        }\n        var isDashEnabled = this.dashEnabled();\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = false;\n            ctx.setLineDash([]);\n        }\n        ctx.fillStrokeShape(this);\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = true;\n        }\n    }\n    getSelfRect() {\n        const lineRect = super.getSelfRect();\n        const offset = this.pointerWidth() / 2;\n        return {\n            x: lineRect.x - offset,\n            y: lineRect.y - offset,\n            width: lineRect.width + offset * 2,\n            height: lineRect.height + offset * 2,\n        };\n    }\n}\nArrow.prototype.className = 'Arrow';\n_registerNode(Arrow);\nFactory.addGetterSetter(Arrow, 'pointerLength', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerWidth', 10, getNumberValidator());\nFactory.addGetterSetter(Arrow, 'pointerAtBeginning', false);\nFactory.addGetterSetter(Arrow, 'pointerAtEnding', true);\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Circle extends Shape {\n    _sceneFunc(context) {\n        context.beginPath();\n        context.arc(0, 0, this.attrs.radius || 0, 0, Math.PI * 2, false);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.radius() * 2;\n    }\n    getHeight() {\n        return this.radius() * 2;\n    }\n    setWidth(width) {\n        if (this.radius() !== width / 2) {\n            this.radius(width / 2);\n        }\n    }\n    setHeight(height) {\n        if (this.radius() !== height / 2) {\n            this.radius(height / 2);\n        }\n    }\n}\nCircle.prototype._centroid = true;\nCircle.prototype.className = 'Circle';\nCircle.prototype._attrsAffectingSize = ['radius'];\n_registerNode(Circle);\nFactory.addGetterSetter(Circle, 'radius', 0, getNumberValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Ellipse extends Shape {\n    _sceneFunc(context) {\n        var rx = this.radiusX(), ry = this.radiusY();\n        context.beginPath();\n        context.save();\n        if (rx !== ry) {\n            context.scale(1, ry / rx);\n        }\n        context.arc(0, 0, rx, 0, Math.PI * 2, false);\n        context.restore();\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.radiusX() * 2;\n    }\n    getHeight() {\n        return this.radiusY() * 2;\n    }\n    setWidth(width) {\n        this.radiusX(width / 2);\n    }\n    setHeight(height) {\n        this.radiusY(height / 2);\n    }\n}\nEllipse.prototype.className = 'Ellipse';\nEllipse.prototype._centroid = true;\nEllipse.prototype._attrsAffectingSize = ['radiusX', 'radiusY'];\n_registerNode(Ellipse);\nFactory.addComponentsGetterSetter(Ellipse, 'radius', ['x', 'y']);\nFactory.addGetterSetter(Ellipse, 'radiusX', 0, getNumberValidator());\nFactory.addGetterSetter(Ellipse, 'radiusY', 0, getNumberValidator());\n","import { Util } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Image extends Shape {\n    constructor(attrs) {\n        super(attrs);\n        this.on('imageChange.konva', () => {\n            this._setImageLoad();\n        });\n        this._setImageLoad();\n    }\n    _setImageLoad() {\n        const image = this.image();\n        if (image && image['addEventListener']) {\n            image['addEventListener']('load', () => {\n                this._requestDraw();\n            });\n        }\n    }\n    _useBufferCanvas() {\n        return super._useBufferCanvas(true);\n    }\n    _sceneFunc(context) {\n        const width = this.getWidth();\n        const height = this.getHeight();\n        const image = this.attrs.image;\n        let params;\n        if (image) {\n            const cropWidth = this.attrs.cropWidth;\n            const cropHeight = this.attrs.cropHeight;\n            if (cropWidth && cropHeight) {\n                params = [\n                    image,\n                    this.cropX(),\n                    this.cropY(),\n                    cropWidth,\n                    cropHeight,\n                    0,\n                    0,\n                    width,\n                    height,\n                ];\n            }\n            else {\n                params = [image, 0, 0, width, height];\n            }\n        }\n        if (this.hasFill() || this.hasStroke()) {\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        if (image) {\n            context.drawImage.apply(context, params);\n        }\n    }\n    _hitFunc(context) {\n        var width = this.width(), height = this.height();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        var _a, _b;\n        return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.width;\n    }\n    getHeight() {\n        var _a, _b;\n        return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.height;\n    }\n    static fromURL(url, callback) {\n        var img = Util.createImageElement();\n        img.onload = function () {\n            var image = new Image({\n                image: img,\n            });\n            callback(image);\n        };\n        img.crossOrigin = 'Anonymous';\n        img.src = url;\n    }\n}\nImage.prototype.className = 'Image';\n_registerNode(Image);\nFactory.addGetterSetter(Image, 'image');\nFactory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);\nFactory.addGetterSetter(Image, 'cropX', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropY', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropWidth', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropHeight', 0, getNumberValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { Group } from '../Group.js';\nimport { getNumberOrArrayOfNumbersValidator, getNumberValidator, } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nvar ATTR_CHANGE_LIST = [\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'padding',\n    'lineHeight',\n    'text',\n    'width',\n    'height',\n], CHANGE_KONVA = 'Change.konva', NONE = 'none', UP = 'up', RIGHT = 'right', DOWN = 'down', LEFT = 'left', attrChangeListLen = ATTR_CHANGE_LIST.length;\nexport class Label extends Group {\n    constructor(config) {\n        super(config);\n        this.on('add.konva', function (evt) {\n            this._addListeners(evt.child);\n            this._sync();\n        });\n    }\n    getText() {\n        return this.find('Text')[0];\n    }\n    getTag() {\n        return this.find('Tag')[0];\n    }\n    _addListeners(text) {\n        var that = this, n;\n        var func = function () {\n            that._sync();\n        };\n        for (n = 0; n < attrChangeListLen; n++) {\n            text.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, func);\n        }\n    }\n    getWidth() {\n        return this.getText().width();\n    }\n    getHeight() {\n        return this.getText().height();\n    }\n    _sync() {\n        var text = this.getText(), tag = this.getTag(), width, height, pointerDirection, pointerWidth, x, y, pointerHeight;\n        if (text && tag) {\n            width = text.width();\n            height = text.height();\n            pointerDirection = tag.pointerDirection();\n            pointerWidth = tag.pointerWidth();\n            pointerHeight = tag.pointerHeight();\n            x = 0;\n            y = 0;\n            switch (pointerDirection) {\n                case UP:\n                    x = width / 2;\n                    y = -1 * pointerHeight;\n                    break;\n                case RIGHT:\n                    x = width + pointerWidth;\n                    y = height / 2;\n                    break;\n                case DOWN:\n                    x = width / 2;\n                    y = height + pointerHeight;\n                    break;\n                case LEFT:\n                    x = -1 * pointerWidth;\n                    y = height / 2;\n                    break;\n            }\n            tag.setAttrs({\n                x: -1 * x,\n                y: -1 * y,\n                width: width,\n                height: height,\n            });\n            text.setAttrs({\n                x: -1 * x,\n                y: -1 * y,\n            });\n        }\n    }\n}\nLabel.prototype.className = 'Label';\n_registerNode(Label);\nexport class Tag extends Shape {\n    _sceneFunc(context) {\n        var width = this.width(), height = this.height(), pointerDirection = this.pointerDirection(), pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), cornerRadius = this.cornerRadius();\n        let topLeft = 0;\n        let topRight = 0;\n        let bottomLeft = 0;\n        let bottomRight = 0;\n        if (typeof cornerRadius === 'number') {\n            topLeft = topRight = bottomLeft = bottomRight = Math.min(cornerRadius, width / 2, height / 2);\n        }\n        else {\n            topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);\n            topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);\n            bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);\n            bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);\n        }\n        context.beginPath();\n        context.moveTo(topLeft, 0);\n        if (pointerDirection === UP) {\n            context.lineTo((width - pointerWidth) / 2, 0);\n            context.lineTo(width / 2, -1 * pointerHeight);\n            context.lineTo((width + pointerWidth) / 2, 0);\n        }\n        context.lineTo(width - topRight, 0);\n        context.arc(width - topRight, topRight, topRight, (Math.PI * 3) / 2, 0, false);\n        if (pointerDirection === RIGHT) {\n            context.lineTo(width, (height - pointerHeight) / 2);\n            context.lineTo(width + pointerWidth, height / 2);\n            context.lineTo(width, (height + pointerHeight) / 2);\n        }\n        context.lineTo(width, height - bottomRight);\n        context.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, false);\n        if (pointerDirection === DOWN) {\n            context.lineTo((width + pointerWidth) / 2, height);\n            context.lineTo(width / 2, height + pointerHeight);\n            context.lineTo((width - pointerWidth) / 2, height);\n        }\n        context.lineTo(bottomLeft, height);\n        context.arc(bottomLeft, height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);\n        if (pointerDirection === LEFT) {\n            context.lineTo(0, (height + pointerHeight) / 2);\n            context.lineTo(-1 * pointerWidth, height / 2);\n            context.lineTo(0, (height - pointerHeight) / 2);\n        }\n        context.lineTo(0, topLeft);\n        context.arc(topLeft, topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getSelfRect() {\n        var x = 0, y = 0, pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), direction = this.pointerDirection(), width = this.width(), height = this.height();\n        if (direction === UP) {\n            y -= pointerHeight;\n            height += pointerHeight;\n        }\n        else if (direction === DOWN) {\n            height += pointerHeight;\n        }\n        else if (direction === LEFT) {\n            x -= pointerWidth * 1.5;\n            width += pointerWidth;\n        }\n        else if (direction === RIGHT) {\n            width += pointerWidth * 1.5;\n        }\n        return {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n        };\n    }\n}\nTag.prototype.className = 'Tag';\n_registerNode(Tag);\nFactory.addGetterSetter(Tag, 'pointerDirection', NONE);\nFactory.addGetterSetter(Tag, 'pointerWidth', 0, getNumberValidator());\nFactory.addGetterSetter(Tag, 'pointerHeight', 0, getNumberValidator());\nFactory.addGetterSetter(Tag, 'cornerRadius', 0, getNumberOrArrayOfNumbersValidator(4));\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { _registerNode } from '../Global.js';\nimport { getNumberOrArrayOfNumbersValidator } from '../Validators.js';\nexport class Rect extends Shape {\n    _sceneFunc(context) {\n        var cornerRadius = this.cornerRadius(), width = this.width(), height = this.height();\n        context.beginPath();\n        if (!cornerRadius) {\n            context.rect(0, 0, width, height);\n        }\n        else {\n            let topLeft = 0;\n            let topRight = 0;\n            let bottomLeft = 0;\n            let bottomRight = 0;\n            if (typeof cornerRadius === 'number') {\n                topLeft = topRight = bottomLeft = bottomRight = Math.min(cornerRadius, width / 2, height / 2);\n            }\n            else {\n                topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);\n                topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);\n                bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);\n                bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);\n            }\n            context.moveTo(topLeft, 0);\n            context.lineTo(width - topRight, 0);\n            context.arc(width - topRight, topRight, topRight, (Math.PI * 3) / 2, 0, false);\n            context.lineTo(width, height - bottomRight);\n            context.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, false);\n            context.lineTo(bottomLeft, height);\n            context.arc(bottomLeft, height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);\n            context.lineTo(0, topLeft);\n            context.arc(topLeft, topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n}\nRect.prototype.className = 'Rect';\n_registerNode(Rect);\nFactory.addGetterSetter(Rect, 'cornerRadius', 0, getNumberOrArrayOfNumbersValidator(4));\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class RegularPolygon extends Shape {\n    _sceneFunc(context) {\n        const points = this._getPoints();\n        context.beginPath();\n        context.moveTo(points[0].x, points[0].y);\n        for (var n = 1; n < points.length; n++) {\n            context.lineTo(points[n].x, points[n].y);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    _getPoints() {\n        const sides = this.attrs.sides;\n        const radius = this.attrs.radius || 0;\n        const points = [];\n        for (var n = 0; n < sides; n++) {\n            points.push({\n                x: radius * Math.sin((n * 2 * Math.PI) / sides),\n                y: -1 * radius * Math.cos((n * 2 * Math.PI) / sides),\n            });\n        }\n        return points;\n    }\n    getSelfRect() {\n        const points = this._getPoints();\n        var minX = points[0].x;\n        var maxX = points[0].y;\n        var minY = points[0].x;\n        var maxY = points[0].y;\n        points.forEach((point) => {\n            minX = Math.min(minX, point.x);\n            maxX = Math.max(maxX, point.x);\n            minY = Math.min(minY, point.y);\n            maxY = Math.max(maxY, point.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    getWidth() {\n        return this.radius() * 2;\n    }\n    getHeight() {\n        return this.radius() * 2;\n    }\n    setWidth(width) {\n        this.radius(width / 2);\n    }\n    setHeight(height) {\n        this.radius(height / 2);\n    }\n}\nRegularPolygon.prototype.className = 'RegularPolygon';\nRegularPolygon.prototype._centroid = true;\nRegularPolygon.prototype._attrsAffectingSize = ['radius'];\n_registerNode(RegularPolygon);\nFactory.addGetterSetter(RegularPolygon, 'radius', 0, getNumberValidator());\nFactory.addGetterSetter(RegularPolygon, 'sides', 0, getNumberValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nvar PIx2 = Math.PI * 2;\nexport class Ring extends Shape {\n    _sceneFunc(context) {\n        context.beginPath();\n        context.arc(0, 0, this.innerRadius(), 0, PIx2, false);\n        context.moveTo(this.outerRadius(), 0);\n        context.arc(0, 0, this.outerRadius(), PIx2, 0, true);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.outerRadius() * 2;\n    }\n    getHeight() {\n        return this.outerRadius() * 2;\n    }\n    setWidth(width) {\n        this.outerRadius(width / 2);\n    }\n    setHeight(height) {\n        this.outerRadius(height / 2);\n    }\n}\nRing.prototype.className = 'Ring';\nRing.prototype._centroid = true;\nRing.prototype._attrsAffectingSize = ['innerRadius', 'outerRadius'];\n_registerNode(Ring);\nFactory.addGetterSetter(Ring, 'innerRadius', 0, getNumberValidator());\nFactory.addGetterSetter(Ring, 'outerRadius', 0, getNumberValidator());\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { Animation } from '../Animation.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Sprite extends Shape {\n    constructor(config) {\n        super(config);\n        this._updated = true;\n        this.anim = new Animation(() => {\n            var updated = this._updated;\n            this._updated = false;\n            return updated;\n        });\n        this.on('animationChange.konva', function () {\n            this.frameIndex(0);\n        });\n        this.on('frameIndexChange.konva', function () {\n            this._updated = true;\n        });\n        this.on('frameRateChange.konva', function () {\n            if (!this.anim.isRunning()) {\n                return;\n            }\n            clearInterval(this.interval);\n            this._setInterval();\n        });\n    }\n    _sceneFunc(context) {\n        var anim = this.animation(), index = this.frameIndex(), ix4 = index * 4, set = this.animations()[anim], offsets = this.frameOffsets(), x = set[ix4 + 0], y = set[ix4 + 1], width = set[ix4 + 2], height = set[ix4 + 3], image = this.image();\n        if (this.hasFill() || this.hasStroke()) {\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        if (image) {\n            if (offsets) {\n                var offset = offsets[anim], ix2 = index * 2;\n                context.drawImage(image, x, y, width, height, offset[ix2 + 0], offset[ix2 + 1], width, height);\n            }\n            else {\n                context.drawImage(image, x, y, width, height, 0, 0, width, height);\n            }\n        }\n    }\n    _hitFunc(context) {\n        var anim = this.animation(), index = this.frameIndex(), ix4 = index * 4, set = this.animations()[anim], offsets = this.frameOffsets(), width = set[ix4 + 2], height = set[ix4 + 3];\n        context.beginPath();\n        if (offsets) {\n            var offset = offsets[anim];\n            var ix2 = index * 2;\n            context.rect(offset[ix2 + 0], offset[ix2 + 1], width, height);\n        }\n        else {\n            context.rect(0, 0, width, height);\n        }\n        context.closePath();\n        context.fillShape(this);\n    }\n    _useBufferCanvas() {\n        return super._useBufferCanvas(true);\n    }\n    _setInterval() {\n        var that = this;\n        this.interval = setInterval(function () {\n            that._updateIndex();\n        }, 1000 / this.frameRate());\n    }\n    start() {\n        if (this.isRunning()) {\n            return;\n        }\n        var layer = this.getLayer();\n        this.anim.setLayers(layer);\n        this._setInterval();\n        this.anim.start();\n    }\n    stop() {\n        this.anim.stop();\n        clearInterval(this.interval);\n    }\n    isRunning() {\n        return this.anim.isRunning();\n    }\n    _updateIndex() {\n        var index = this.frameIndex(), animation = this.animation(), animations = this.animations(), anim = animations[animation], len = anim.length / 4;\n        if (index < len - 1) {\n            this.frameIndex(index + 1);\n        }\n        else {\n            this.frameIndex(0);\n        }\n    }\n}\nSprite.prototype.className = 'Sprite';\n_registerNode(Sprite);\nFactory.addGetterSetter(Sprite, 'animation');\nFactory.addGetterSetter(Sprite, 'animations');\nFactory.addGetterSetter(Sprite, 'frameOffsets');\nFactory.addGetterSetter(Sprite, 'image');\nFactory.addGetterSetter(Sprite, 'frameIndex', 0, getNumberValidator());\nFactory.addGetterSetter(Sprite, 'frameRate', 17, getNumberValidator());\nFactory.backCompat(Sprite, {\n    index: 'frameIndex',\n    getIndex: 'getFrameIndex',\n    setIndex: 'setFrameIndex',\n});\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Star extends Shape {\n    _sceneFunc(context) {\n        var innerRadius = this.innerRadius(), outerRadius = this.outerRadius(), numPoints = this.numPoints();\n        context.beginPath();\n        context.moveTo(0, 0 - outerRadius);\n        for (var n = 1; n < numPoints * 2; n++) {\n            var radius = n % 2 === 0 ? outerRadius : innerRadius;\n            var x = radius * Math.sin((n * Math.PI) / numPoints);\n            var y = -1 * radius * Math.cos((n * Math.PI) / numPoints);\n            context.lineTo(x, y);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.outerRadius() * 2;\n    }\n    getHeight() {\n        return this.outerRadius() * 2;\n    }\n    setWidth(width) {\n        this.outerRadius(width / 2);\n    }\n    setHeight(height) {\n        this.outerRadius(height / 2);\n    }\n}\nStar.prototype.className = 'Star';\nStar.prototype._centroid = true;\nStar.prototype._attrsAffectingSize = ['innerRadius', 'outerRadius'];\n_registerNode(Star);\nFactory.addGetterSetter(Star, 'numPoints', 5, getNumberValidator());\nFactory.addGetterSetter(Star, 'innerRadius', 0, getNumberValidator());\nFactory.addGetterSetter(Star, 'outerRadius', 0, getNumberValidator());\n","import { Util } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator, getStringValidator, getNumberOrAutoValidator, getBooleanValidator, } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport function stringToArray(string) {\n    return Array.from(string);\n}\nvar AUTO = 'auto', CENTER = 'center', JUSTIFY = 'justify', CHANGE_KONVA = 'Change.konva', CONTEXT_2D = '2d', DASH = '-', LEFT = 'left', TEXT = 'text', TEXT_UPPER = 'Text', TOP = 'top', BOTTOM = 'bottom', MIDDLE = 'middle', NORMAL = 'normal', PX_SPACE = 'px ', SPACE = ' ', RIGHT = 'right', WORD = 'word', CHAR = 'char', NONE = 'none', ELLIPSIS = '', ATTR_CHANGE_LIST = [\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'fontVariant',\n    'padding',\n    'align',\n    'verticalAlign',\n    'lineHeight',\n    'text',\n    'width',\n    'height',\n    'wrap',\n    'ellipsis',\n    'letterSpacing',\n], attrChangeListLen = ATTR_CHANGE_LIST.length;\nfunction normalizeFontFamily(fontFamily) {\n    return fontFamily\n        .split(',')\n        .map((family) => {\n        family = family.trim();\n        const hasSpace = family.indexOf(' ') >= 0;\n        const hasQuotes = family.indexOf('\"') >= 0 || family.indexOf(\"'\") >= 0;\n        if (hasSpace && !hasQuotes) {\n            family = `\"${family}\"`;\n        }\n        return family;\n    })\n        .join(', ');\n}\nvar dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util.createCanvasElement().getContext(CONTEXT_2D);\n    return dummyContext;\n}\nfunction _fillFunc(context) {\n    context.fillText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction _strokeFunc(context) {\n    context.strokeText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction checkDefaultFill(config) {\n    config = config || {};\n    if (!config.fillLinearGradientColorStops &&\n        !config.fillRadialGradientColorStops &&\n        !config.fillPatternImage) {\n        config.fill = config.fill || 'black';\n    }\n    return config;\n}\nexport class Text extends Shape {\n    constructor(config) {\n        super(checkDefaultFill(config));\n        this._partialTextX = 0;\n        this._partialTextY = 0;\n        for (var n = 0; n < attrChangeListLen; n++) {\n            this.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, this._setTextData);\n        }\n        this._setTextData();\n    }\n    _sceneFunc(context) {\n        var textArr = this.textArr, textArrLen = textArr.length;\n        if (!this.text()) {\n            return;\n        }\n        var padding = this.padding(), fontSize = this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, verticalAlign = this.verticalAlign(), alignY = 0, align = this.align(), totalWidth = this.getWidth(), letterSpacing = this.letterSpacing(), fill = this.fill(), textDecoration = this.textDecoration(), shouldUnderline = textDecoration.indexOf('underline') !== -1, shouldLineThrough = textDecoration.indexOf('line-through') !== -1, n;\n        var translateY = 0;\n        var translateY = lineHeightPx / 2;\n        var lineTranslateX = 0;\n        var lineTranslateY = 0;\n        context.setAttr('font', this._getContextFont());\n        context.setAttr('textBaseline', MIDDLE);\n        context.setAttr('textAlign', LEFT);\n        if (verticalAlign === MIDDLE) {\n            alignY = (this.getHeight() - textArrLen * lineHeightPx - padding * 2) / 2;\n        }\n        else if (verticalAlign === BOTTOM) {\n            alignY = this.getHeight() - textArrLen * lineHeightPx - padding * 2;\n        }\n        context.translate(padding, alignY + padding);\n        for (n = 0; n < textArrLen; n++) {\n            var lineTranslateX = 0;\n            var lineTranslateY = 0;\n            var obj = textArr[n], text = obj.text, width = obj.width, lastLine = n !== textArrLen - 1, spacesNumber, oneWord, lineWidth;\n            context.save();\n            if (align === RIGHT) {\n                lineTranslateX += totalWidth - width - padding * 2;\n            }\n            else if (align === CENTER) {\n                lineTranslateX += (totalWidth - width - padding * 2) / 2;\n            }\n            if (shouldUnderline) {\n                context.save();\n                context.beginPath();\n                context.moveTo(lineTranslateX, translateY + lineTranslateY + Math.round(fontSize / 2));\n                spacesNumber = text.split(' ').length - 1;\n                oneWord = spacesNumber === 0;\n                lineWidth =\n                    align === JUSTIFY && lastLine && !oneWord\n                        ? totalWidth - padding * 2\n                        : width;\n                context.lineTo(lineTranslateX + Math.round(lineWidth), translateY + lineTranslateY + Math.round(fontSize / 2));\n                context.lineWidth = fontSize / 15;\n                context.strokeStyle = fill;\n                context.stroke();\n                context.restore();\n            }\n            if (shouldLineThrough) {\n                context.save();\n                context.beginPath();\n                context.moveTo(lineTranslateX, translateY + lineTranslateY);\n                spacesNumber = text.split(' ').length - 1;\n                oneWord = spacesNumber === 0;\n                lineWidth =\n                    align === JUSTIFY && lastLine && !oneWord\n                        ? totalWidth - padding * 2\n                        : width;\n                context.lineTo(lineTranslateX + Math.round(lineWidth), translateY + lineTranslateY);\n                context.lineWidth = fontSize / 15;\n                context.strokeStyle = fill;\n                context.stroke();\n                context.restore();\n            }\n            if (letterSpacing !== 0 || align === JUSTIFY) {\n                spacesNumber = text.split(' ').length - 1;\n                var array = stringToArray(text);\n                for (var li = 0; li < array.length; li++) {\n                    var letter = array[li];\n                    if (letter === ' ' && n !== textArrLen - 1 && align === JUSTIFY) {\n                        lineTranslateX += (totalWidth - padding * 2 - width) / spacesNumber;\n                    }\n                    this._partialTextX = lineTranslateX;\n                    this._partialTextY = translateY + lineTranslateY;\n                    this._partialText = letter;\n                    context.fillStrokeShape(this);\n                    lineTranslateX += this.measureSize(letter).width + letterSpacing;\n                }\n            }\n            else {\n                this._partialTextX = lineTranslateX;\n                this._partialTextY = translateY + lineTranslateY;\n                this._partialText = text;\n                context.fillStrokeShape(this);\n            }\n            context.restore();\n            if (textArrLen > 1) {\n                translateY += lineHeightPx;\n            }\n        }\n    }\n    _hitFunc(context) {\n        var width = this.getWidth(), height = this.getHeight();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    setText(text) {\n        var str = Util._isString(text)\n            ? text\n            : text === null || text === undefined\n                ? ''\n                : text + '';\n        this._setAttr(TEXT, str);\n        return this;\n    }\n    getWidth() {\n        var isAuto = this.attrs.width === AUTO || this.attrs.width === undefined;\n        return isAuto ? this.getTextWidth() + this.padding() * 2 : this.attrs.width;\n    }\n    getHeight() {\n        var isAuto = this.attrs.height === AUTO || this.attrs.height === undefined;\n        return isAuto\n            ? this.fontSize() * this.textArr.length * this.lineHeight() +\n                this.padding() * 2\n            : this.attrs.height;\n    }\n    getTextWidth() {\n        return this.textWidth;\n    }\n    getTextHeight() {\n        Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');\n        return this.textHeight;\n    }\n    measureSize(text) {\n        var _context = getDummyContext(), fontSize = this.fontSize(), metrics;\n        _context.save();\n        _context.font = this._getContextFont();\n        metrics = _context.measureText(text);\n        _context.restore();\n        return {\n            width: metrics.width,\n            height: fontSize,\n        };\n    }\n    _getContextFont() {\n        return (this.fontStyle() +\n            SPACE +\n            this.fontVariant() +\n            SPACE +\n            (this.fontSize() + PX_SPACE) +\n            normalizeFontFamily(this.fontFamily()));\n    }\n    _addTextLine(line) {\n        if (this.align() === JUSTIFY) {\n            line = line.trim();\n        }\n        var width = this._getTextWidth(line);\n        return this.textArr.push({ text: line, width: width });\n    }\n    _getTextWidth(text) {\n        var letterSpacing = this.letterSpacing();\n        var length = text.length;\n        return (getDummyContext().measureText(text).width +\n            (length ? letterSpacing * (length - 1) : 0));\n    }\n    _setTextData() {\n        var lines = this.text().split('\\n'), fontSize = +this.fontSize(), textWidth = 0, lineHeightPx = this.lineHeight() * fontSize, width = this.attrs.width, height = this.attrs.height, fixedWidth = width !== AUTO && width !== undefined, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxWidth = width - padding * 2, maxHeightPx = height - padding * 2, currentHeightPx = 0, wrap = this.wrap(), shouldWrap = wrap !== NONE, wrapAtWord = wrap !== CHAR && shouldWrap, shouldAddEllipsis = this.ellipsis();\n        this.textArr = [];\n        getDummyContext().font = this._getContextFont();\n        var additionalWidth = shouldAddEllipsis ? this._getTextWidth(ELLIPSIS) : 0;\n        for (var i = 0, max = lines.length; i < max; ++i) {\n            var line = lines[i];\n            var lineWidth = this._getTextWidth(line);\n            if (fixedWidth && lineWidth > maxWidth) {\n                while (line.length > 0) {\n                    var low = 0, high = line.length, match = '', matchWidth = 0;\n                    while (low < high) {\n                        var mid = (low + high) >>> 1, substr = line.slice(0, mid + 1), substrWidth = this._getTextWidth(substr) + additionalWidth;\n                        if (substrWidth <= maxWidth) {\n                            low = mid + 1;\n                            match = substr;\n                            matchWidth = substrWidth;\n                        }\n                        else {\n                            high = mid;\n                        }\n                    }\n                    if (match) {\n                        if (wrapAtWord) {\n                            var wrapIndex;\n                            var nextChar = line[match.length];\n                            var nextIsSpaceOrDash = nextChar === SPACE || nextChar === DASH;\n                            if (nextIsSpaceOrDash && matchWidth <= maxWidth) {\n                                wrapIndex = match.length;\n                            }\n                            else {\n                                wrapIndex =\n                                    Math.max(match.lastIndexOf(SPACE), match.lastIndexOf(DASH)) +\n                                        1;\n                            }\n                            if (wrapIndex > 0) {\n                                low = wrapIndex;\n                                match = match.slice(0, low);\n                                matchWidth = this._getTextWidth(match);\n                            }\n                        }\n                        match = match.trimRight();\n                        this._addTextLine(match);\n                        textWidth = Math.max(textWidth, matchWidth);\n                        currentHeightPx += lineHeightPx;\n                        if (!shouldWrap ||\n                            (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx)) {\n                            var lastLine = this.textArr[this.textArr.length - 1];\n                            if (lastLine) {\n                                if (shouldAddEllipsis) {\n                                    var haveSpace = this._getTextWidth(lastLine.text + ELLIPSIS) < maxWidth;\n                                    if (!haveSpace) {\n                                        lastLine.text = lastLine.text.slice(0, lastLine.text.length - 3);\n                                    }\n                                    this.textArr.splice(this.textArr.length - 1, 1);\n                                    this._addTextLine(lastLine.text + ELLIPSIS);\n                                }\n                            }\n                            break;\n                        }\n                        line = line.slice(low);\n                        line = line.trimLeft();\n                        if (line.length > 0) {\n                            lineWidth = this._getTextWidth(line);\n                            if (lineWidth <= maxWidth) {\n                                this._addTextLine(line);\n                                currentHeightPx += lineHeightPx;\n                                textWidth = Math.max(textWidth, lineWidth);\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n            else {\n                this._addTextLine(line);\n                currentHeightPx += lineHeightPx;\n                textWidth = Math.max(textWidth, lineWidth);\n            }\n            if (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx) {\n                break;\n            }\n        }\n        this.textHeight = fontSize;\n        this.textWidth = textWidth;\n    }\n    getStrokeScaleEnabled() {\n        return true;\n    }\n}\nText.prototype._fillFunc = _fillFunc;\nText.prototype._strokeFunc = _strokeFunc;\nText.prototype.className = TEXT_UPPER;\nText.prototype._attrsAffectingSize = [\n    'text',\n    'fontSize',\n    'padding',\n    'wrap',\n    'lineHeight',\n    'letterSpacing',\n];\n_registerNode(Text);\nFactory.overWriteSetter(Text, 'width', getNumberOrAutoValidator());\nFactory.overWriteSetter(Text, 'height', getNumberOrAutoValidator());\nFactory.addGetterSetter(Text, 'fontFamily', 'Arial');\nFactory.addGetterSetter(Text, 'fontSize', 12, getNumberValidator());\nFactory.addGetterSetter(Text, 'fontStyle', NORMAL);\nFactory.addGetterSetter(Text, 'fontVariant', NORMAL);\nFactory.addGetterSetter(Text, 'padding', 0, getNumberValidator());\nFactory.addGetterSetter(Text, 'align', LEFT);\nFactory.addGetterSetter(Text, 'verticalAlign', TOP);\nFactory.addGetterSetter(Text, 'lineHeight', 1, getNumberValidator());\nFactory.addGetterSetter(Text, 'wrap', WORD);\nFactory.addGetterSetter(Text, 'ellipsis', false, getBooleanValidator());\nFactory.addGetterSetter(Text, 'letterSpacing', 0, getNumberValidator());\nFactory.addGetterSetter(Text, 'text', '', getStringValidator());\nFactory.addGetterSetter(Text, 'textDecoration', '');\n","import { Util } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { Path } from './Path.js';\nimport { Text, stringToArray } from './Text.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nvar EMPTY_STRING = '', NORMAL = 'normal';\nfunction _fillFunc(context) {\n    context.fillText(this.partialText, 0, 0);\n}\nfunction _strokeFunc(context) {\n    context.strokeText(this.partialText, 0, 0);\n}\nexport class TextPath extends Shape {\n    constructor(config) {\n        super(config);\n        this.dummyCanvas = Util.createCanvasElement();\n        this.dataArray = [];\n        this.dataArray = Path.parsePathData(this.attrs.data);\n        this.on('dataChange.konva', function () {\n            this.dataArray = Path.parsePathData(this.attrs.data);\n            this._setTextData();\n        });\n        this.on('textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva', this._setTextData);\n        this._setTextData();\n    }\n    _sceneFunc(context) {\n        context.setAttr('font', this._getContextFont());\n        context.setAttr('textBaseline', this.textBaseline());\n        context.setAttr('textAlign', 'left');\n        context.save();\n        var textDecoration = this.textDecoration();\n        var fill = this.fill();\n        var fontSize = this.fontSize();\n        var glyphInfo = this.glyphInfo;\n        if (textDecoration === 'underline') {\n            context.beginPath();\n        }\n        for (var i = 0; i < glyphInfo.length; i++) {\n            context.save();\n            var p0 = glyphInfo[i].p0;\n            context.translate(p0.x, p0.y);\n            context.rotate(glyphInfo[i].rotation);\n            this.partialText = glyphInfo[i].text;\n            context.fillStrokeShape(this);\n            if (textDecoration === 'underline') {\n                if (i === 0) {\n                    context.moveTo(0, fontSize / 2 + 1);\n                }\n                context.lineTo(fontSize, fontSize / 2 + 1);\n            }\n            context.restore();\n        }\n        if (textDecoration === 'underline') {\n            context.strokeStyle = fill;\n            context.lineWidth = fontSize / 20;\n            context.stroke();\n        }\n        context.restore();\n    }\n    _hitFunc(context) {\n        context.beginPath();\n        var glyphInfo = this.glyphInfo;\n        if (glyphInfo.length >= 1) {\n            var p0 = glyphInfo[0].p0;\n            context.moveTo(p0.x, p0.y);\n        }\n        for (var i = 0; i < glyphInfo.length; i++) {\n            var p1 = glyphInfo[i].p1;\n            context.lineTo(p1.x, p1.y);\n        }\n        context.setAttr('lineWidth', this.fontSize());\n        context.setAttr('strokeStyle', this.colorKey);\n        context.stroke();\n    }\n    getTextWidth() {\n        return this.textWidth;\n    }\n    getTextHeight() {\n        Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');\n        return this.textHeight;\n    }\n    setText(text) {\n        return Text.prototype.setText.call(this, text);\n    }\n    _getContextFont() {\n        return Text.prototype._getContextFont.call(this);\n    }\n    _getTextSize(text) {\n        var dummyCanvas = this.dummyCanvas;\n        var _context = dummyCanvas.getContext('2d');\n        _context.save();\n        _context.font = this._getContextFont();\n        var metrics = _context.measureText(text);\n        _context.restore();\n        return {\n            width: metrics.width,\n            height: parseInt(this.attrs.fontSize, 10),\n        };\n    }\n    _setTextData() {\n        var that = this;\n        var size = this._getTextSize(this.attrs.text);\n        var letterSpacing = this.letterSpacing();\n        var align = this.align();\n        var kerningFunc = this.kerningFunc();\n        this.textWidth = size.width;\n        this.textHeight = size.height;\n        var textFullWidth = Math.max(this.textWidth + ((this.attrs.text || '').length - 1) * letterSpacing, 0);\n        this.glyphInfo = [];\n        var fullPathWidth = 0;\n        for (var l = 0; l < that.dataArray.length; l++) {\n            if (that.dataArray[l].pathLength > 0) {\n                fullPathWidth += that.dataArray[l].pathLength;\n            }\n        }\n        var offset = 0;\n        if (align === 'center') {\n            offset = Math.max(0, fullPathWidth / 2 - textFullWidth / 2);\n        }\n        if (align === 'right') {\n            offset = Math.max(0, fullPathWidth - textFullWidth);\n        }\n        var charArr = stringToArray(this.text());\n        var spacesNumber = this.text().split(' ').length - 1;\n        var p0, p1, pathCmd;\n        var pIndex = -1;\n        var currentT = 0;\n        var getNextPathSegment = function () {\n            currentT = 0;\n            var pathData = that.dataArray;\n            for (var j = pIndex + 1; j < pathData.length; j++) {\n                if (pathData[j].pathLength > 0) {\n                    pIndex = j;\n                    return pathData[j];\n                }\n                else if (pathData[j].command === 'M') {\n                    p0 = {\n                        x: pathData[j].points[0],\n                        y: pathData[j].points[1],\n                    };\n                }\n            }\n            return {};\n        };\n        var findSegmentToFitCharacter = function (c) {\n            var glyphWidth = that._getTextSize(c).width + letterSpacing;\n            if (c === ' ' && align === 'justify') {\n                glyphWidth += (fullPathWidth - textFullWidth) / spacesNumber;\n            }\n            var currLen = 0;\n            var attempts = 0;\n            p1 = undefined;\n            while (Math.abs(glyphWidth - currLen) / glyphWidth > 0.01 &&\n                attempts < 20) {\n                attempts++;\n                var cumulativePathLength = currLen;\n                while (pathCmd === undefined) {\n                    pathCmd = getNextPathSegment();\n                    if (pathCmd &&\n                        cumulativePathLength + pathCmd.pathLength < glyphWidth) {\n                        cumulativePathLength += pathCmd.pathLength;\n                        pathCmd = undefined;\n                    }\n                }\n                if (pathCmd === {} || p0 === undefined) {\n                    return undefined;\n                }\n                var needNewSegment = false;\n                switch (pathCmd.command) {\n                    case 'L':\n                        if (Path.getLineLength(p0.x, p0.y, pathCmd.points[0], pathCmd.points[1]) > glyphWidth) {\n                            p1 = Path.getPointOnLine(glyphWidth, p0.x, p0.y, pathCmd.points[0], pathCmd.points[1], p0.x, p0.y);\n                        }\n                        else {\n                            pathCmd = undefined;\n                        }\n                        break;\n                    case 'A':\n                        var start = pathCmd.points[4];\n                        var dTheta = pathCmd.points[5];\n                        var end = pathCmd.points[4] + dTheta;\n                        if (currentT === 0) {\n                            currentT = start + 0.00000001;\n                        }\n                        else if (glyphWidth > currLen) {\n                            currentT += ((Math.PI / 180.0) * dTheta) / Math.abs(dTheta);\n                        }\n                        else {\n                            currentT -= ((Math.PI / 360.0) * dTheta) / Math.abs(dTheta);\n                        }\n                        if ((dTheta < 0 && currentT < end) ||\n                            (dTheta >= 0 && currentT > end)) {\n                            currentT = end;\n                            needNewSegment = true;\n                        }\n                        p1 = Path.getPointOnEllipticalArc(pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3], currentT, pathCmd.points[6]);\n                        break;\n                    case 'C':\n                        if (currentT === 0) {\n                            if (glyphWidth > pathCmd.pathLength) {\n                                currentT = 0.00000001;\n                            }\n                            else {\n                                currentT = glyphWidth / pathCmd.pathLength;\n                            }\n                        }\n                        else if (glyphWidth > currLen) {\n                            currentT += (glyphWidth - currLen) / pathCmd.pathLength / 2;\n                        }\n                        else {\n                            currentT = Math.max(currentT - (currLen - glyphWidth) / pathCmd.pathLength / 2, 0);\n                        }\n                        if (currentT > 1.0) {\n                            currentT = 1.0;\n                            needNewSegment = true;\n                        }\n                        p1 = Path.getPointOnCubicBezier(currentT, pathCmd.start.x, pathCmd.start.y, pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3], pathCmd.points[4], pathCmd.points[5]);\n                        break;\n                    case 'Q':\n                        if (currentT === 0) {\n                            currentT = glyphWidth / pathCmd.pathLength;\n                        }\n                        else if (glyphWidth > currLen) {\n                            currentT += (glyphWidth - currLen) / pathCmd.pathLength;\n                        }\n                        else {\n                            currentT -= (currLen - glyphWidth) / pathCmd.pathLength;\n                        }\n                        if (currentT > 1.0) {\n                            currentT = 1.0;\n                            needNewSegment = true;\n                        }\n                        p1 = Path.getPointOnQuadraticBezier(currentT, pathCmd.start.x, pathCmd.start.y, pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3]);\n                        break;\n                }\n                if (p1 !== undefined) {\n                    currLen = Path.getLineLength(p0.x, p0.y, p1.x, p1.y);\n                }\n                if (needNewSegment) {\n                    needNewSegment = false;\n                    pathCmd = undefined;\n                }\n            }\n        };\n        var testChar = 'C';\n        var glyphWidth = that._getTextSize(testChar).width + letterSpacing;\n        var lettersInOffset = offset / glyphWidth - 1;\n        for (var k = 0; k < lettersInOffset; k++) {\n            findSegmentToFitCharacter(testChar);\n            if (p0 === undefined || p1 === undefined) {\n                break;\n            }\n            p0 = p1;\n        }\n        for (var i = 0; i < charArr.length; i++) {\n            findSegmentToFitCharacter(charArr[i]);\n            if (p0 === undefined || p1 === undefined) {\n                break;\n            }\n            var width = Path.getLineLength(p0.x, p0.y, p1.x, p1.y);\n            var kern = 0;\n            if (kerningFunc) {\n                try {\n                    kern = kerningFunc(charArr[i - 1], charArr[i]) * this.fontSize();\n                }\n                catch (e) {\n                    kern = 0;\n                }\n            }\n            p0.x += kern;\n            p1.x += kern;\n            this.textWidth += kern;\n            var midpoint = Path.getPointOnLine(kern + width / 2.0, p0.x, p0.y, p1.x, p1.y);\n            var rotation = Math.atan2(p1.y - p0.y, p1.x - p0.x);\n            this.glyphInfo.push({\n                transposeX: midpoint.x,\n                transposeY: midpoint.y,\n                text: charArr[i],\n                rotation: rotation,\n                p0: p0,\n                p1: p1,\n            });\n            p0 = p1;\n        }\n    }\n    getSelfRect() {\n        if (!this.glyphInfo.length) {\n            return {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        var points = [];\n        this.glyphInfo.forEach(function (info) {\n            points.push(info.p0.x);\n            points.push(info.p0.y);\n            points.push(info.p1.x);\n            points.push(info.p1.y);\n        });\n        var minX = points[0] || 0;\n        var maxX = points[0] || 0;\n        var minY = points[1] || 0;\n        var maxY = points[1] || 0;\n        var x, y;\n        for (var i = 0; i < points.length / 2; i++) {\n            x = points[i * 2];\n            y = points[i * 2 + 1];\n            minX = Math.min(minX, x);\n            maxX = Math.max(maxX, x);\n            minY = Math.min(minY, y);\n            maxY = Math.max(maxY, y);\n        }\n        var fontSize = this.fontSize();\n        return {\n            x: minX - fontSize / 2,\n            y: minY - fontSize / 2,\n            width: maxX - minX + fontSize,\n            height: maxY - minY + fontSize,\n        };\n    }\n}\nTextPath.prototype._fillFunc = _fillFunc;\nTextPath.prototype._strokeFunc = _strokeFunc;\nTextPath.prototype._fillFuncHit = _fillFunc;\nTextPath.prototype._strokeFuncHit = _strokeFunc;\nTextPath.prototype.className = 'TextPath';\nTextPath.prototype._attrsAffectingSize = ['text', 'fontSize', 'data'];\n_registerNode(TextPath);\nFactory.addGetterSetter(TextPath, 'data');\nFactory.addGetterSetter(TextPath, 'fontFamily', 'Arial');\nFactory.addGetterSetter(TextPath, 'fontSize', 12, getNumberValidator());\nFactory.addGetterSetter(TextPath, 'fontStyle', NORMAL);\nFactory.addGetterSetter(TextPath, 'align', 'left');\nFactory.addGetterSetter(TextPath, 'letterSpacing', 0, getNumberValidator());\nFactory.addGetterSetter(TextPath, 'textBaseline', 'middle');\nFactory.addGetterSetter(TextPath, 'fontVariant', NORMAL);\nFactory.addGetterSetter(TextPath, 'text', EMPTY_STRING);\nFactory.addGetterSetter(TextPath, 'textDecoration', null);\nFactory.addGetterSetter(TextPath, 'kerningFunc', null);\n","import { Util, Transform } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { Shape } from '../Shape.js';\nimport { Rect } from './Rect.js';\nimport { Group } from '../Group.js';\nimport { Konva } from '../Global.js';\nimport { getBooleanValidator, getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nvar EVENTS_NAME = 'tr-konva';\nvar ATTR_CHANGE_LIST = [\n    'resizeEnabledChange',\n    'rotateAnchorOffsetChange',\n    'rotateEnabledChange',\n    'enabledAnchorsChange',\n    'anchorSizeChange',\n    'borderEnabledChange',\n    'borderStrokeChange',\n    'borderStrokeWidthChange',\n    'borderDashChange',\n    'anchorStrokeChange',\n    'anchorStrokeWidthChange',\n    'anchorFillChange',\n    'anchorCornerRadiusChange',\n    'ignoreStrokeChange',\n]\n    .map((e) => e + `.${EVENTS_NAME}`)\n    .join(' ');\nvar NODES_RECT = 'nodesRect';\nvar TRANSFORM_CHANGE_STR = [\n    'widthChange',\n    'heightChange',\n    'scaleXChange',\n    'scaleYChange',\n    'skewXChange',\n    'skewYChange',\n    'rotationChange',\n    'offsetXChange',\n    'offsetYChange',\n    'transformsEnabledChange',\n    'strokeWidthChange',\n]\n    .map((e) => e + `.${EVENTS_NAME}`)\n    .join(' ');\nvar ANGLES = {\n    'top-left': -45,\n    'top-center': 0,\n    'top-right': 45,\n    'middle-right': -90,\n    'middle-left': 90,\n    'bottom-left': -135,\n    'bottom-center': 180,\n    'bottom-right': 135,\n};\nconst TOUCH_DEVICE = 'ontouchstart' in Konva._global;\nfunction getCursor(anchorName, rad) {\n    if (anchorName === 'rotater') {\n        return 'crosshair';\n    }\n    rad += Util.degToRad(ANGLES[anchorName] || 0);\n    var angle = ((Util.radToDeg(rad) % 360) + 360) % 360;\n    if (Util._inRange(angle, 315 + 22.5, 360) || Util._inRange(angle, 0, 22.5)) {\n        return 'ns-resize';\n    }\n    else if (Util._inRange(angle, 45 - 22.5, 45 + 22.5)) {\n        return 'nesw-resize';\n    }\n    else if (Util._inRange(angle, 90 - 22.5, 90 + 22.5)) {\n        return 'ew-resize';\n    }\n    else if (Util._inRange(angle, 135 - 22.5, 135 + 22.5)) {\n        return 'nwse-resize';\n    }\n    else if (Util._inRange(angle, 180 - 22.5, 180 + 22.5)) {\n        return 'ns-resize';\n    }\n    else if (Util._inRange(angle, 225 - 22.5, 225 + 22.5)) {\n        return 'nesw-resize';\n    }\n    else if (Util._inRange(angle, 270 - 22.5, 270 + 22.5)) {\n        return 'ew-resize';\n    }\n    else if (Util._inRange(angle, 315 - 22.5, 315 + 22.5)) {\n        return 'nwse-resize';\n    }\n    else {\n        Util.error('Transformer has unknown angle for cursor detection: ' + angle);\n        return 'pointer';\n    }\n}\nvar ANCHORS_NAMES = [\n    'top-left',\n    'top-center',\n    'top-right',\n    'middle-right',\n    'middle-left',\n    'bottom-left',\n    'bottom-center',\n    'bottom-right',\n];\nvar MAX_SAFE_INTEGER = 100000000;\nfunction getCenter(shape) {\n    return {\n        x: shape.x +\n            (shape.width / 2) * Math.cos(shape.rotation) +\n            (shape.height / 2) * Math.sin(-shape.rotation),\n        y: shape.y +\n            (shape.height / 2) * Math.cos(shape.rotation) +\n            (shape.width / 2) * Math.sin(shape.rotation),\n    };\n}\nfunction rotateAroundPoint(shape, angleRad, point) {\n    const x = point.x +\n        (shape.x - point.x) * Math.cos(angleRad) -\n        (shape.y - point.y) * Math.sin(angleRad);\n    const y = point.y +\n        (shape.x - point.x) * Math.sin(angleRad) +\n        (shape.y - point.y) * Math.cos(angleRad);\n    return Object.assign(Object.assign({}, shape), { rotation: shape.rotation + angleRad, x,\n        y });\n}\nfunction rotateAroundCenter(shape, deltaRad) {\n    const center = getCenter(shape);\n    return rotateAroundPoint(shape, deltaRad, center);\n}\nfunction getSnap(snaps, newRotationRad, tol) {\n    let snapped = newRotationRad;\n    for (let i = 0; i < snaps.length; i++) {\n        const angle = Konva.getAngle(snaps[i]);\n        const absDiff = Math.abs(angle - newRotationRad) % (Math.PI * 2);\n        const dif = Math.min(absDiff, Math.PI * 2 - absDiff);\n        if (dif < tol) {\n            snapped = angle;\n        }\n    }\n    return snapped;\n}\nexport class Transformer extends Group {\n    constructor(config) {\n        super(config);\n        this._transforming = false;\n        this._createElements();\n        this._handleMouseMove = this._handleMouseMove.bind(this);\n        this._handleMouseUp = this._handleMouseUp.bind(this);\n        this.update = this.update.bind(this);\n        this.on(ATTR_CHANGE_LIST, this.update);\n        if (this.getNode()) {\n            this.update();\n        }\n    }\n    attachTo(node) {\n        this.setNode(node);\n        return this;\n    }\n    setNode(node) {\n        Util.warn('tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead.');\n        return this.setNodes([node]);\n    }\n    getNode() {\n        return this._nodes && this._nodes[0];\n    }\n    setNodes(nodes = []) {\n        if (this._nodes && this._nodes.length) {\n            this.detach();\n        }\n        this._nodes = nodes;\n        if (nodes.length === 1) {\n            this.rotation(nodes[0].getAbsoluteRotation());\n        }\n        else {\n            this.rotation(0);\n        }\n        this._nodes.forEach((node) => {\n            const additionalEvents = node._attrsAffectingSize\n                .map((prop) => prop + 'Change.' + EVENTS_NAME)\n                .join(' ');\n            const onChange = () => {\n                if (this.nodes().length === 1) {\n                    this.rotation(this.nodes()[0].getAbsoluteRotation());\n                }\n                this._resetTransformCache();\n                if (!this._transforming && !this.isDragging()) {\n                    this.update();\n                }\n            };\n            node.on(additionalEvents, onChange);\n            node.on(TRANSFORM_CHANGE_STR, onChange);\n            node.on(`absoluteTransformChange.${EVENTS_NAME}`, onChange);\n            node.on(`xChange.${EVENTS_NAME} yChange.${EVENTS_NAME}`, onChange);\n            this._proxyDrag(node);\n        });\n        this._resetTransformCache();\n        var elementsCreated = !!this.findOne('.top-left');\n        if (elementsCreated) {\n            this.update();\n        }\n        return this;\n    }\n    _proxyDrag(node) {\n        let lastPos;\n        node.on(`dragstart.${EVENTS_NAME}`, (e) => {\n            lastPos = node.getAbsolutePosition();\n            if (!this.isDragging() && node !== this.findOne('.back')) {\n                this.startDrag(e, false);\n            }\n        });\n        node.on(`dragmove.${EVENTS_NAME}`, (e) => {\n            if (!lastPos) {\n                return;\n            }\n            const abs = node.getAbsolutePosition();\n            const dx = abs.x - lastPos.x;\n            const dy = abs.y - lastPos.y;\n            this.nodes().forEach((otherNode) => {\n                if (otherNode === node) {\n                    return;\n                }\n                if (otherNode.isDragging()) {\n                    return;\n                }\n                const otherAbs = otherNode.getAbsolutePosition();\n                otherNode.setAbsolutePosition({\n                    x: otherAbs.x + dx,\n                    y: otherAbs.y + dy,\n                });\n                otherNode.startDrag(e);\n            });\n            lastPos = null;\n        });\n    }\n    getNodes() {\n        return this._nodes || [];\n    }\n    getActiveAnchor() {\n        return this._movingAnchorName;\n    }\n    detach() {\n        if (this._nodes) {\n            this._nodes.forEach((node) => {\n                node.off('.' + EVENTS_NAME);\n            });\n        }\n        this._nodes = [];\n        this._resetTransformCache();\n    }\n    _resetTransformCache() {\n        this._clearCache(NODES_RECT);\n        this._clearCache('transform');\n        this._clearSelfAndDescendantCache('absoluteTransform');\n    }\n    _getNodeRect() {\n        return this._getCache(NODES_RECT, this.__getNodeRect);\n    }\n    __getNodeShape(node, rot = this.rotation(), relative) {\n        var rect = node.getClientRect({\n            skipTransform: true,\n            skipShadow: true,\n            skipStroke: this.ignoreStroke(),\n        });\n        var absScale = node.getAbsoluteScale(relative);\n        var absPos = node.getAbsolutePosition(relative);\n        var dx = rect.x * absScale.x - node.offsetX() * absScale.x;\n        var dy = rect.y * absScale.y - node.offsetY() * absScale.y;\n        const rotation = (Konva.getAngle(node.getAbsoluteRotation()) + Math.PI * 2) %\n            (Math.PI * 2);\n        const box = {\n            x: absPos.x + dx * Math.cos(rotation) + dy * Math.sin(-rotation),\n            y: absPos.y + dy * Math.cos(rotation) + dx * Math.sin(rotation),\n            width: rect.width * absScale.x,\n            height: rect.height * absScale.y,\n            rotation: rotation,\n        };\n        return rotateAroundPoint(box, -Konva.getAngle(rot), {\n            x: 0,\n            y: 0,\n        });\n    }\n    __getNodeRect() {\n        var node = this.getNode();\n        if (!node) {\n            return {\n                x: -MAX_SAFE_INTEGER,\n                y: -MAX_SAFE_INTEGER,\n                width: 0,\n                height: 0,\n                rotation: 0,\n            };\n        }\n        const totalPoints = [];\n        this.nodes().map((node) => {\n            const box = node.getClientRect({\n                skipTransform: true,\n                skipShadow: true,\n                skipStroke: this.ignoreStroke(),\n            });\n            var points = [\n                { x: box.x, y: box.y },\n                { x: box.x + box.width, y: box.y },\n                { x: box.x + box.width, y: box.y + box.height },\n                { x: box.x, y: box.y + box.height },\n            ];\n            var trans = node.getAbsoluteTransform();\n            points.forEach(function (point) {\n                var transformed = trans.point(point);\n                totalPoints.push(transformed);\n            });\n        });\n        const tr = new Transform();\n        tr.rotate(-Konva.getAngle(this.rotation()));\n        var minX, minY, maxX, maxY;\n        totalPoints.forEach(function (point) {\n            var transformed = tr.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        tr.invert();\n        const p = tr.point({ x: minX, y: minY });\n        return {\n            x: p.x,\n            y: p.y,\n            width: maxX - minX,\n            height: maxY - minY,\n            rotation: Konva.getAngle(this.rotation()),\n        };\n    }\n    getX() {\n        return this._getNodeRect().x;\n    }\n    getY() {\n        return this._getNodeRect().y;\n    }\n    getWidth() {\n        return this._getNodeRect().width;\n    }\n    getHeight() {\n        return this._getNodeRect().height;\n    }\n    _createElements() {\n        this._createBack();\n        ANCHORS_NAMES.forEach(function (name) {\n            this._createAnchor(name);\n        }.bind(this));\n        this._createAnchor('rotater');\n    }\n    _createAnchor(name) {\n        var anchor = new Rect({\n            stroke: 'rgb(0, 161, 255)',\n            fill: 'white',\n            strokeWidth: 1,\n            name: name + ' _anchor',\n            dragDistance: 0,\n            draggable: true,\n            hitStrokeWidth: TOUCH_DEVICE ? 10 : 'auto',\n        });\n        var self = this;\n        anchor.on('mousedown touchstart', function (e) {\n            self._handleMouseDown(e);\n        });\n        anchor.on('dragstart', (e) => {\n            anchor.stopDrag();\n            e.cancelBubble = true;\n        });\n        anchor.on('dragend', (e) => {\n            e.cancelBubble = true;\n        });\n        anchor.on('mouseenter', () => {\n            var rad = Konva.getAngle(this.rotation());\n            var cursor = getCursor(name, rad);\n            anchor.getStage().content &&\n                (anchor.getStage().content.style.cursor = cursor);\n            this._cursorChange = true;\n        });\n        anchor.on('mouseout', () => {\n            anchor.getStage().content &&\n                (anchor.getStage().content.style.cursor = '');\n            this._cursorChange = false;\n        });\n        this.add(anchor);\n    }\n    _createBack() {\n        var back = new Shape({\n            name: 'back',\n            width: 0,\n            height: 0,\n            draggable: true,\n            sceneFunc(ctx) {\n                var tr = this.getParent();\n                var padding = tr.padding();\n                ctx.beginPath();\n                ctx.rect(-padding, -padding, this.width() + padding * 2, this.height() + padding * 2);\n                ctx.moveTo(this.width() / 2, -padding);\n                if (tr.rotateEnabled()) {\n                    ctx.lineTo(this.width() / 2, -tr.rotateAnchorOffset() * Util._sign(this.height()) - padding);\n                }\n                ctx.fillStrokeShape(this);\n            },\n            hitFunc: (ctx, shape) => {\n                if (!this.shouldOverdrawWholeArea()) {\n                    return;\n                }\n                var padding = this.padding();\n                ctx.beginPath();\n                ctx.rect(-padding, -padding, shape.width() + padding * 2, shape.height() + padding * 2);\n                ctx.fillStrokeShape(shape);\n            },\n        });\n        this.add(back);\n        this._proxyDrag(back);\n        back.on('dragstart', (e) => {\n            e.cancelBubble = true;\n        });\n        back.on('dragmove', (e) => {\n            e.cancelBubble = true;\n        });\n        back.on('dragend', (e) => {\n            e.cancelBubble = true;\n        });\n    }\n    _handleMouseDown(e) {\n        this._movingAnchorName = e.target.name().split(' ')[0];\n        var attrs = this._getNodeRect();\n        var width = attrs.width;\n        var height = attrs.height;\n        var hypotenuse = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));\n        this.sin = Math.abs(height / hypotenuse);\n        this.cos = Math.abs(width / hypotenuse);\n        if (typeof window !== 'undefined') {\n            window.addEventListener('mousemove', this._handleMouseMove);\n            window.addEventListener('touchmove', this._handleMouseMove);\n            window.addEventListener('mouseup', this._handleMouseUp, true);\n            window.addEventListener('touchend', this._handleMouseUp, true);\n        }\n        this._transforming = true;\n        var ap = e.target.getAbsolutePosition();\n        var pos = e.target.getStage().getPointerPosition();\n        this._anchorDragOffset = {\n            x: pos.x - ap.x,\n            y: pos.y - ap.y,\n        };\n        this._fire('transformstart', { evt: e, target: this.getNode() });\n        this._nodes.forEach((target) => {\n            target._fire('transformstart', { evt: e, target });\n        });\n    }\n    _handleMouseMove(e) {\n        var x, y, newHypotenuse;\n        var anchorNode = this.findOne('.' + this._movingAnchorName);\n        var stage = anchorNode.getStage();\n        stage.setPointersPositions(e);\n        const pp = stage.getPointerPosition();\n        var newNodePos = {\n            x: pp.x - this._anchorDragOffset.x,\n            y: pp.y - this._anchorDragOffset.y,\n        };\n        const oldAbs = anchorNode.getAbsolutePosition();\n        anchorNode.setAbsolutePosition(newNodePos);\n        const newAbs = anchorNode.getAbsolutePosition();\n        if (oldAbs.x === newAbs.x && oldAbs.y === newAbs.y) {\n            return;\n        }\n        if (this._movingAnchorName === 'rotater') {\n            var attrs = this._getNodeRect();\n            x = anchorNode.x() - attrs.width / 2;\n            y = -anchorNode.y() + attrs.height / 2;\n            let delta = Math.atan2(-y, x) + Math.PI / 2;\n            if (attrs.height < 0) {\n                delta -= Math.PI;\n            }\n            var oldRotation = Konva.getAngle(this.rotation());\n            const newRotation = oldRotation + delta;\n            const tol = Konva.getAngle(this.rotationSnapTolerance());\n            const snappedRot = getSnap(this.rotationSnaps(), newRotation, tol);\n            const diff = snappedRot - attrs.rotation;\n            const shape = rotateAroundCenter(attrs, diff);\n            this._fitNodesInto(shape, e);\n            return;\n        }\n        var keepProportion = this.keepRatio() || e.shiftKey;\n        var centeredScaling = this.centeredScaling() || e.altKey;\n        if (this._movingAnchorName === 'top-left') {\n            if (keepProportion) {\n                var comparePoint = centeredScaling\n                    ? {\n                        x: this.width() / 2,\n                        y: this.height() / 2,\n                    }\n                    : {\n                        x: this.findOne('.bottom-right').x(),\n                        y: this.findOne('.bottom-right').y(),\n                    };\n                newHypotenuse = Math.sqrt(Math.pow(comparePoint.x - anchorNode.x(), 2) +\n                    Math.pow(comparePoint.y - anchorNode.y(), 2));\n                var reverseX = this.findOne('.top-left').x() > comparePoint.x ? -1 : 1;\n                var reverseY = this.findOne('.top-left').y() > comparePoint.y ? -1 : 1;\n                x = newHypotenuse * this.cos * reverseX;\n                y = newHypotenuse * this.sin * reverseY;\n                this.findOne('.top-left').x(comparePoint.x - x);\n                this.findOne('.top-left').y(comparePoint.y - y);\n            }\n        }\n        else if (this._movingAnchorName === 'top-center') {\n            this.findOne('.top-left').y(anchorNode.y());\n        }\n        else if (this._movingAnchorName === 'top-right') {\n            if (keepProportion) {\n                var comparePoint = centeredScaling\n                    ? {\n                        x: this.width() / 2,\n                        y: this.height() / 2,\n                    }\n                    : {\n                        x: this.findOne('.bottom-left').x(),\n                        y: this.findOne('.bottom-left').y(),\n                    };\n                newHypotenuse = Math.sqrt(Math.pow(anchorNode.x() - comparePoint.x, 2) +\n                    Math.pow(comparePoint.y - anchorNode.y(), 2));\n                var reverseX = this.findOne('.top-right').x() < comparePoint.x ? -1 : 1;\n                var reverseY = this.findOne('.top-right').y() > comparePoint.y ? -1 : 1;\n                x = newHypotenuse * this.cos * reverseX;\n                y = newHypotenuse * this.sin * reverseY;\n                this.findOne('.top-right').x(comparePoint.x + x);\n                this.findOne('.top-right').y(comparePoint.y - y);\n            }\n            var pos = anchorNode.position();\n            this.findOne('.top-left').y(pos.y);\n            this.findOne('.bottom-right').x(pos.x);\n        }\n        else if (this._movingAnchorName === 'middle-left') {\n            this.findOne('.top-left').x(anchorNode.x());\n        }\n        else if (this._movingAnchorName === 'middle-right') {\n            this.findOne('.bottom-right').x(anchorNode.x());\n        }\n        else if (this._movingAnchorName === 'bottom-left') {\n            if (keepProportion) {\n                var comparePoint = centeredScaling\n                    ? {\n                        x: this.width() / 2,\n                        y: this.height() / 2,\n                    }\n                    : {\n                        x: this.findOne('.top-right').x(),\n                        y: this.findOne('.top-right').y(),\n                    };\n                newHypotenuse = Math.sqrt(Math.pow(comparePoint.x - anchorNode.x(), 2) +\n                    Math.pow(anchorNode.y() - comparePoint.y, 2));\n                var reverseX = comparePoint.x < anchorNode.x() ? -1 : 1;\n                var reverseY = anchorNode.y() < comparePoint.y ? -1 : 1;\n                x = newHypotenuse * this.cos * reverseX;\n                y = newHypotenuse * this.sin * reverseY;\n                anchorNode.x(comparePoint.x - x);\n                anchorNode.y(comparePoint.y + y);\n            }\n            pos = anchorNode.position();\n            this.findOne('.top-left').x(pos.x);\n            this.findOne('.bottom-right').y(pos.y);\n        }\n        else if (this._movingAnchorName === 'bottom-center') {\n            this.findOne('.bottom-right').y(anchorNode.y());\n        }\n        else if (this._movingAnchorName === 'bottom-right') {\n            if (keepProportion) {\n                var comparePoint = centeredScaling\n                    ? {\n                        x: this.width() / 2,\n                        y: this.height() / 2,\n                    }\n                    : {\n                        x: this.findOne('.top-left').x(),\n                        y: this.findOne('.top-left').y(),\n                    };\n                newHypotenuse = Math.sqrt(Math.pow(anchorNode.x() - comparePoint.x, 2) +\n                    Math.pow(anchorNode.y() - comparePoint.y, 2));\n                var reverseX = this.findOne('.bottom-right').x() < comparePoint.x ? -1 : 1;\n                var reverseY = this.findOne('.bottom-right').y() < comparePoint.y ? -1 : 1;\n                x = newHypotenuse * this.cos * reverseX;\n                y = newHypotenuse * this.sin * reverseY;\n                this.findOne('.bottom-right').x(comparePoint.x + x);\n                this.findOne('.bottom-right').y(comparePoint.y + y);\n            }\n        }\n        else {\n            console.error(new Error('Wrong position argument of selection resizer: ' +\n                this._movingAnchorName));\n        }\n        var centeredScaling = this.centeredScaling() || e.altKey;\n        if (centeredScaling) {\n            var topLeft = this.findOne('.top-left');\n            var bottomRight = this.findOne('.bottom-right');\n            var topOffsetX = topLeft.x();\n            var topOffsetY = topLeft.y();\n            var bottomOffsetX = this.getWidth() - bottomRight.x();\n            var bottomOffsetY = this.getHeight() - bottomRight.y();\n            bottomRight.move({\n                x: -topOffsetX,\n                y: -topOffsetY,\n            });\n            topLeft.move({\n                x: bottomOffsetX,\n                y: bottomOffsetY,\n            });\n        }\n        var absPos = this.findOne('.top-left').getAbsolutePosition();\n        x = absPos.x;\n        y = absPos.y;\n        var width = this.findOne('.bottom-right').x() - this.findOne('.top-left').x();\n        var height = this.findOne('.bottom-right').y() - this.findOne('.top-left').y();\n        this._fitNodesInto({\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            rotation: Konva.getAngle(this.rotation()),\n        }, e);\n    }\n    _handleMouseUp(e) {\n        this._removeEvents(e);\n    }\n    getAbsoluteTransform() {\n        return this.getTransform();\n    }\n    _removeEvents(e) {\n        if (this._transforming) {\n            this._transforming = false;\n            if (typeof window !== 'undefined') {\n                window.removeEventListener('mousemove', this._handleMouseMove);\n                window.removeEventListener('touchmove', this._handleMouseMove);\n                window.removeEventListener('mouseup', this._handleMouseUp, true);\n                window.removeEventListener('touchend', this._handleMouseUp, true);\n            }\n            var node = this.getNode();\n            this._fire('transformend', { evt: e, target: node });\n            if (node) {\n                this._nodes.forEach((target) => {\n                    target._fire('transformend', { evt: e, target });\n                });\n            }\n            this._movingAnchorName = null;\n        }\n    }\n    _fitNodesInto(newAttrs, evt) {\n        var oldAttrs = this._getNodeRect();\n        const minSize = 1;\n        if (Util._inRange(newAttrs.width, -this.padding() * 2 - minSize, minSize)) {\n            this.update();\n            return;\n        }\n        if (Util._inRange(newAttrs.height, -this.padding() * 2 - minSize, minSize)) {\n            this.update();\n            return;\n        }\n        const allowNegativeScale = this.flipEnabled();\n        var t = new Transform();\n        t.rotate(Konva.getAngle(this.rotation()));\n        if (this._movingAnchorName &&\n            newAttrs.width < 0 &&\n            this._movingAnchorName.indexOf('left') >= 0) {\n            const offset = t.point({\n                x: -this.padding() * 2,\n                y: 0,\n            });\n            newAttrs.x += offset.x;\n            newAttrs.y += offset.y;\n            newAttrs.width += this.padding() * 2;\n            this._movingAnchorName = this._movingAnchorName.replace('left', 'right');\n            this._anchorDragOffset.x -= offset.x;\n            this._anchorDragOffset.y -= offset.y;\n            if (!allowNegativeScale) {\n                this.update();\n                return;\n            }\n        }\n        else if (this._movingAnchorName &&\n            newAttrs.width < 0 &&\n            this._movingAnchorName.indexOf('right') >= 0) {\n            const offset = t.point({\n                x: this.padding() * 2,\n                y: 0,\n            });\n            this._movingAnchorName = this._movingAnchorName.replace('right', 'left');\n            this._anchorDragOffset.x -= offset.x;\n            this._anchorDragOffset.y -= offset.y;\n            newAttrs.width += this.padding() * 2;\n            if (!allowNegativeScale) {\n                this.update();\n                return;\n            }\n        }\n        if (this._movingAnchorName &&\n            newAttrs.height < 0 &&\n            this._movingAnchorName.indexOf('top') >= 0) {\n            const offset = t.point({\n                x: 0,\n                y: -this.padding() * 2,\n            });\n            newAttrs.x += offset.x;\n            newAttrs.y += offset.y;\n            this._movingAnchorName = this._movingAnchorName.replace('top', 'bottom');\n            this._anchorDragOffset.x -= offset.x;\n            this._anchorDragOffset.y -= offset.y;\n            newAttrs.height += this.padding() * 2;\n            if (!allowNegativeScale) {\n                this.update();\n                return;\n            }\n        }\n        else if (this._movingAnchorName &&\n            newAttrs.height < 0 &&\n            this._movingAnchorName.indexOf('bottom') >= 0) {\n            const offset = t.point({\n                x: 0,\n                y: this.padding() * 2,\n            });\n            this._movingAnchorName = this._movingAnchorName.replace('bottom', 'top');\n            this._anchorDragOffset.x -= offset.x;\n            this._anchorDragOffset.y -= offset.y;\n            newAttrs.height += this.padding() * 2;\n            if (!allowNegativeScale) {\n                this.update();\n                return;\n            }\n        }\n        if (this.boundBoxFunc()) {\n            const bounded = this.boundBoxFunc()(oldAttrs, newAttrs);\n            if (bounded) {\n                newAttrs = bounded;\n            }\n            else {\n                Util.warn('boundBoxFunc returned falsy. You should return new bound rect from it!');\n            }\n        }\n        const baseSize = 10000000;\n        const oldTr = new Transform();\n        oldTr.translate(oldAttrs.x, oldAttrs.y);\n        oldTr.rotate(oldAttrs.rotation);\n        oldTr.scale(oldAttrs.width / baseSize, oldAttrs.height / baseSize);\n        const newTr = new Transform();\n        newTr.translate(newAttrs.x, newAttrs.y);\n        newTr.rotate(newAttrs.rotation);\n        newTr.scale(newAttrs.width / baseSize, newAttrs.height / baseSize);\n        const delta = newTr.multiply(oldTr.invert());\n        this._nodes.forEach((node) => {\n            var _a;\n            const parentTransform = node.getParent().getAbsoluteTransform();\n            const localTransform = node.getTransform().copy();\n            localTransform.translate(node.offsetX(), node.offsetY());\n            const newLocalTransform = new Transform();\n            newLocalTransform\n                .multiply(parentTransform.copy().invert())\n                .multiply(delta)\n                .multiply(parentTransform)\n                .multiply(localTransform);\n            const attrs = newLocalTransform.decompose();\n            node.setAttrs(attrs);\n            this._fire('transform', { evt: evt, target: node });\n            node._fire('transform', { evt: evt, target: node });\n            (_a = node.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();\n        });\n        this.rotation(Util._getRotation(newAttrs.rotation));\n        this._resetTransformCache();\n        this.update();\n        this.getLayer().batchDraw();\n    }\n    forceUpdate() {\n        this._resetTransformCache();\n        this.update();\n    }\n    _batchChangeChild(selector, attrs) {\n        const anchor = this.findOne(selector);\n        anchor.setAttrs(attrs);\n    }\n    update() {\n        var _a;\n        var attrs = this._getNodeRect();\n        this.rotation(Util._getRotation(attrs.rotation));\n        var width = attrs.width;\n        var height = attrs.height;\n        var enabledAnchors = this.enabledAnchors();\n        var resizeEnabled = this.resizeEnabled();\n        var padding = this.padding();\n        var anchorSize = this.anchorSize();\n        this.find('._anchor').forEach((node) => {\n            node.setAttrs({\n                width: anchorSize,\n                height: anchorSize,\n                offsetX: anchorSize / 2,\n                offsetY: anchorSize / 2,\n                stroke: this.anchorStroke(),\n                strokeWidth: this.anchorStrokeWidth(),\n                fill: this.anchorFill(),\n                cornerRadius: this.anchorCornerRadius(),\n            });\n        });\n        this._batchChangeChild('.top-left', {\n            x: 0,\n            y: 0,\n            offsetX: anchorSize / 2 + padding,\n            offsetY: anchorSize / 2 + padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('top-left') >= 0,\n        });\n        this._batchChangeChild('.top-center', {\n            x: width / 2,\n            y: 0,\n            offsetY: anchorSize / 2 + padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('top-center') >= 0,\n        });\n        this._batchChangeChild('.top-right', {\n            x: width,\n            y: 0,\n            offsetX: anchorSize / 2 - padding,\n            offsetY: anchorSize / 2 + padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('top-right') >= 0,\n        });\n        this._batchChangeChild('.middle-left', {\n            x: 0,\n            y: height / 2,\n            offsetX: anchorSize / 2 + padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('middle-left') >= 0,\n        });\n        this._batchChangeChild('.middle-right', {\n            x: width,\n            y: height / 2,\n            offsetX: anchorSize / 2 - padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('middle-right') >= 0,\n        });\n        this._batchChangeChild('.bottom-left', {\n            x: 0,\n            y: height,\n            offsetX: anchorSize / 2 + padding,\n            offsetY: anchorSize / 2 - padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('bottom-left') >= 0,\n        });\n        this._batchChangeChild('.bottom-center', {\n            x: width / 2,\n            y: height,\n            offsetY: anchorSize / 2 - padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('bottom-center') >= 0,\n        });\n        this._batchChangeChild('.bottom-right', {\n            x: width,\n            y: height,\n            offsetX: anchorSize / 2 - padding,\n            offsetY: anchorSize / 2 - padding,\n            visible: resizeEnabled && enabledAnchors.indexOf('bottom-right') >= 0,\n        });\n        this._batchChangeChild('.rotater', {\n            x: width / 2,\n            y: -this.rotateAnchorOffset() * Util._sign(height) - padding,\n            visible: this.rotateEnabled(),\n        });\n        this._batchChangeChild('.back', {\n            width: width,\n            height: height,\n            visible: this.borderEnabled(),\n            stroke: this.borderStroke(),\n            strokeWidth: this.borderStrokeWidth(),\n            dash: this.borderDash(),\n            x: 0,\n            y: 0,\n        });\n        (_a = this.getLayer()) === null || _a === void 0 ? void 0 : _a.batchDraw();\n    }\n    isTransforming() {\n        return this._transforming;\n    }\n    stopTransform() {\n        if (this._transforming) {\n            this._removeEvents();\n            var anchorNode = this.findOne('.' + this._movingAnchorName);\n            if (anchorNode) {\n                anchorNode.stopDrag();\n            }\n        }\n    }\n    destroy() {\n        if (this.getStage() && this._cursorChange) {\n            this.getStage().content && (this.getStage().content.style.cursor = '');\n        }\n        Group.prototype.destroy.call(this);\n        this.detach();\n        this._removeEvents();\n        return this;\n    }\n    toObject() {\n        return Node.prototype.toObject.call(this);\n    }\n}\nfunction validateAnchors(val) {\n    if (!(val instanceof Array)) {\n        Util.warn('enabledAnchors value should be an array');\n    }\n    if (val instanceof Array) {\n        val.forEach(function (name) {\n            if (ANCHORS_NAMES.indexOf(name) === -1) {\n                Util.warn('Unknown anchor name: ' +\n                    name +\n                    '. Available names are: ' +\n                    ANCHORS_NAMES.join(', '));\n            }\n        });\n    }\n    return val || [];\n}\nTransformer.prototype.className = 'Transformer';\n_registerNode(Transformer);\nFactory.addGetterSetter(Transformer, 'enabledAnchors', ANCHORS_NAMES, validateAnchors);\nFactory.addGetterSetter(Transformer, 'flipEnabled', true, getBooleanValidator());\nFactory.addGetterSetter(Transformer, 'resizeEnabled', true);\nFactory.addGetterSetter(Transformer, 'anchorSize', 10, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'rotateEnabled', true);\nFactory.addGetterSetter(Transformer, 'rotationSnaps', []);\nFactory.addGetterSetter(Transformer, 'rotateAnchorOffset', 50, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'rotationSnapTolerance', 5, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'borderEnabled', true);\nFactory.addGetterSetter(Transformer, 'anchorStroke', 'rgb(0, 161, 255)');\nFactory.addGetterSetter(Transformer, 'anchorStrokeWidth', 1, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'anchorFill', 'white');\nFactory.addGetterSetter(Transformer, 'anchorCornerRadius', 0, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'borderStroke', 'rgb(0, 161, 255)');\nFactory.addGetterSetter(Transformer, 'borderStrokeWidth', 1, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'borderDash');\nFactory.addGetterSetter(Transformer, 'keepRatio', true);\nFactory.addGetterSetter(Transformer, 'centeredScaling', false);\nFactory.addGetterSetter(Transformer, 'ignoreStroke', false);\nFactory.addGetterSetter(Transformer, 'padding', 0, getNumberValidator());\nFactory.addGetterSetter(Transformer, 'node');\nFactory.addGetterSetter(Transformer, 'nodes');\nFactory.addGetterSetter(Transformer, 'boundBoxFunc');\nFactory.addGetterSetter(Transformer, 'shouldOverdrawWholeArea', false);\nFactory.backCompat(Transformer, {\n    lineEnabled: 'borderEnabled',\n    rotateHandlerOffset: 'rotateAnchorOffset',\n    enabledHandlers: 'enabledAnchors',\n});\n","import { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { Konva } from '../Global.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Wedge extends Shape {\n    _sceneFunc(context) {\n        context.beginPath();\n        context.arc(0, 0, this.radius(), 0, Konva.getAngle(this.angle()), this.clockwise());\n        context.lineTo(0, 0);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        return this.radius() * 2;\n    }\n    getHeight() {\n        return this.radius() * 2;\n    }\n    setWidth(width) {\n        this.radius(width / 2);\n    }\n    setHeight(height) {\n        this.radius(height / 2);\n    }\n}\nWedge.prototype.className = 'Wedge';\nWedge.prototype._centroid = true;\nWedge.prototype._attrsAffectingSize = ['radius'];\n_registerNode(Wedge);\nFactory.addGetterSetter(Wedge, 'radius', 0, getNumberValidator());\nFactory.addGetterSetter(Wedge, 'angle', 0, getNumberValidator());\nFactory.addGetterSetter(Wedge, 'clockwise', false);\nFactory.backCompat(Wedge, {\n    angleDeg: 'angle',\n    getAngleDeg: 'getAngle',\n    setAngleDeg: 'setAngle',\n});\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nfunction BlurStack() {\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n    this.a = 0;\n    this.next = null;\n}\nvar mul_table = [\n    512,\n    512,\n    456,\n    512,\n    328,\n    456,\n    335,\n    512,\n    405,\n    328,\n    271,\n    456,\n    388,\n    335,\n    292,\n    512,\n    454,\n    405,\n    364,\n    328,\n    298,\n    271,\n    496,\n    456,\n    420,\n    388,\n    360,\n    335,\n    312,\n    292,\n    273,\n    512,\n    482,\n    454,\n    428,\n    405,\n    383,\n    364,\n    345,\n    328,\n    312,\n    298,\n    284,\n    271,\n    259,\n    496,\n    475,\n    456,\n    437,\n    420,\n    404,\n    388,\n    374,\n    360,\n    347,\n    335,\n    323,\n    312,\n    302,\n    292,\n    282,\n    273,\n    265,\n    512,\n    497,\n    482,\n    468,\n    454,\n    441,\n    428,\n    417,\n    405,\n    394,\n    383,\n    373,\n    364,\n    354,\n    345,\n    337,\n    328,\n    320,\n    312,\n    305,\n    298,\n    291,\n    284,\n    278,\n    271,\n    265,\n    259,\n    507,\n    496,\n    485,\n    475,\n    465,\n    456,\n    446,\n    437,\n    428,\n    420,\n    412,\n    404,\n    396,\n    388,\n    381,\n    374,\n    367,\n    360,\n    354,\n    347,\n    341,\n    335,\n    329,\n    323,\n    318,\n    312,\n    307,\n    302,\n    297,\n    292,\n    287,\n    282,\n    278,\n    273,\n    269,\n    265,\n    261,\n    512,\n    505,\n    497,\n    489,\n    482,\n    475,\n    468,\n    461,\n    454,\n    447,\n    441,\n    435,\n    428,\n    422,\n    417,\n    411,\n    405,\n    399,\n    394,\n    389,\n    383,\n    378,\n    373,\n    368,\n    364,\n    359,\n    354,\n    350,\n    345,\n    341,\n    337,\n    332,\n    328,\n    324,\n    320,\n    316,\n    312,\n    309,\n    305,\n    301,\n    298,\n    294,\n    291,\n    287,\n    284,\n    281,\n    278,\n    274,\n    271,\n    268,\n    265,\n    262,\n    259,\n    257,\n    507,\n    501,\n    496,\n    491,\n    485,\n    480,\n    475,\n    470,\n    465,\n    460,\n    456,\n    451,\n    446,\n    442,\n    437,\n    433,\n    428,\n    424,\n    420,\n    416,\n    412,\n    408,\n    404,\n    400,\n    396,\n    392,\n    388,\n    385,\n    381,\n    377,\n    374,\n    370,\n    367,\n    363,\n    360,\n    357,\n    354,\n    350,\n    347,\n    344,\n    341,\n    338,\n    335,\n    332,\n    329,\n    326,\n    323,\n    320,\n    318,\n    315,\n    312,\n    310,\n    307,\n    304,\n    302,\n    299,\n    297,\n    294,\n    292,\n    289,\n    287,\n    285,\n    282,\n    280,\n    278,\n    275,\n    273,\n    271,\n    269,\n    267,\n    265,\n    263,\n    261,\n    259,\n];\nvar shg_table = [\n    9,\n    11,\n    12,\n    13,\n    13,\n    14,\n    14,\n    15,\n    15,\n    15,\n    15,\n    16,\n    16,\n    16,\n    16,\n    17,\n    17,\n    17,\n    17,\n    17,\n    17,\n    17,\n    18,\n    18,\n    18,\n    18,\n    18,\n    18,\n    18,\n    18,\n    18,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    19,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    20,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    21,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    22,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    23,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n    24,\n];\nfunction filterGaussBlurRGBA(imageData, radius) {\n    var pixels = imageData.data, width = imageData.width, height = imageData.height;\n    var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum, r_out_sum, g_out_sum, b_out_sum, a_out_sum, r_in_sum, g_in_sum, b_in_sum, a_in_sum, pr, pg, pb, pa, rbs;\n    var div = radius + radius + 1, widthMinus1 = width - 1, heightMinus1 = height - 1, radiusPlus1 = radius + 1, sumFactor = (radiusPlus1 * (radiusPlus1 + 1)) / 2, stackStart = new BlurStack(), stackEnd = null, stack = stackStart, stackIn = null, stackOut = null, mul_sum = mul_table[radius], shg_sum = shg_table[radius];\n    for (i = 1; i < div; i++) {\n        stack = stack.next = new BlurStack();\n        if (i === radiusPlus1) {\n            stackEnd = stack;\n        }\n    }\n    stack.next = stackStart;\n    yw = yi = 0;\n    for (y = 0; y < height; y++) {\n        r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n        a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        a_sum += sumFactor * pa;\n        stack = stackStart;\n        for (i = 0; i < radiusPlus1; i++) {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack.a = pa;\n            stack = stack.next;\n        }\n        for (i = 1; i < radiusPlus1; i++) {\n            p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n            r_sum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = pg = pixels[p + 1]) * rbs;\n            b_sum += (stack.b = pb = pixels[p + 2]) * rbs;\n            a_sum += (stack.a = pa = pixels[p + 3]) * rbs;\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            a_in_sum += pa;\n            stack = stack.next;\n        }\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (x = 0; x < width; x++) {\n            pixels[yi + 3] = pa = (a_sum * mul_sum) >> shg_sum;\n            if (pa !== 0) {\n                pa = 255 / pa;\n                pixels[yi] = ((r_sum * mul_sum) >> shg_sum) * pa;\n                pixels[yi + 1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n                pixels[yi + 2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n            }\n            else {\n                pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n            }\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            a_sum -= a_out_sum;\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            a_out_sum -= stackIn.a;\n            p = (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;\n            r_in_sum += stackIn.r = pixels[p];\n            g_in_sum += stackIn.g = pixels[p + 1];\n            b_in_sum += stackIn.b = pixels[p + 2];\n            a_in_sum += stackIn.a = pixels[p + 3];\n            r_sum += r_in_sum;\n            g_sum += g_in_sum;\n            b_sum += b_in_sum;\n            a_sum += a_in_sum;\n            stackIn = stackIn.next;\n            r_out_sum += pr = stackOut.r;\n            g_out_sum += pg = stackOut.g;\n            b_out_sum += pb = stackOut.b;\n            a_out_sum += pa = stackOut.a;\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            a_in_sum -= pa;\n            stackOut = stackOut.next;\n            yi += 4;\n        }\n        yw += width;\n    }\n    for (x = 0; x < width; x++) {\n        g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;\n        yi = x << 2;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n        a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        a_sum += sumFactor * pa;\n        stack = stackStart;\n        for (i = 0; i < radiusPlus1; i++) {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack.a = pa;\n            stack = stack.next;\n        }\n        yp = width;\n        for (i = 1; i <= radius; i++) {\n            yi = (yp + x) << 2;\n            r_sum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = pg = pixels[yi + 1]) * rbs;\n            b_sum += (stack.b = pb = pixels[yi + 2]) * rbs;\n            a_sum += (stack.a = pa = pixels[yi + 3]) * rbs;\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            a_in_sum += pa;\n            stack = stack.next;\n            if (i < heightMinus1) {\n                yp += width;\n            }\n        }\n        yi = x;\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (y = 0; y < height; y++) {\n            p = yi << 2;\n            pixels[p + 3] = pa = (a_sum * mul_sum) >> shg_sum;\n            if (pa > 0) {\n                pa = 255 / pa;\n                pixels[p] = ((r_sum * mul_sum) >> shg_sum) * pa;\n                pixels[p + 1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n                pixels[p + 2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n            }\n            else {\n                pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;\n            }\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            a_sum -= a_out_sum;\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            a_out_sum -= stackIn.a;\n            p =\n                (x +\n                    ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width) <<\n                    2;\n            r_sum += r_in_sum += stackIn.r = pixels[p];\n            g_sum += g_in_sum += stackIn.g = pixels[p + 1];\n            b_sum += b_in_sum += stackIn.b = pixels[p + 2];\n            a_sum += a_in_sum += stackIn.a = pixels[p + 3];\n            stackIn = stackIn.next;\n            r_out_sum += pr = stackOut.r;\n            g_out_sum += pg = stackOut.g;\n            b_out_sum += pb = stackOut.b;\n            a_out_sum += pa = stackOut.a;\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            a_in_sum -= pa;\n            stackOut = stackOut.next;\n            yi += width;\n        }\n    }\n}\nexport const Blur = function Blur(imageData) {\n    var radius = Math.round(this.blurRadius());\n    if (radius > 0) {\n        filterGaussBlurRGBA(imageData, radius);\n    }\n};\nFactory.addGetterSetter(Node, 'blurRadius', 0, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Brighten = function (imageData) {\n    var brightness = this.brightness() * 255, data = imageData.data, len = data.length, i;\n    for (i = 0; i < len; i += 4) {\n        data[i] += brightness;\n        data[i + 1] += brightness;\n        data[i + 2] += brightness;\n    }\n};\nFactory.addGetterSetter(Node, 'brightness', 0, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Contrast = function (imageData) {\n    var adjust = Math.pow((this.contrast() + 100) / 100, 2);\n    var data = imageData.data, nPixels = data.length, red = 150, green = 150, blue = 150, i;\n    for (i = 0; i < nPixels; i += 4) {\n        red = data[i];\n        green = data[i + 1];\n        blue = data[i + 2];\n        red /= 255;\n        red -= 0.5;\n        red *= adjust;\n        red += 0.5;\n        red *= 255;\n        green /= 255;\n        green -= 0.5;\n        green *= adjust;\n        green += 0.5;\n        green *= 255;\n        blue /= 255;\n        blue -= 0.5;\n        blue *= adjust;\n        blue += 0.5;\n        blue *= 255;\n        red = red < 0 ? 0 : red > 255 ? 255 : red;\n        green = green < 0 ? 0 : green > 255 ? 255 : green;\n        blue = blue < 0 ? 0 : blue > 255 ? 255 : blue;\n        data[i] = red;\n        data[i + 1] = green;\n        data[i + 2] = blue;\n    }\n};\nFactory.addGetterSetter(Node, 'contrast', 0, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { Util } from '../Util.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Emboss = function (imageData) {\n    var strength = this.embossStrength() * 10, greyLevel = this.embossWhiteLevel() * 255, direction = this.embossDirection(), blend = this.embossBlend(), dirY = 0, dirX = 0, data = imageData.data, w = imageData.width, h = imageData.height, w4 = w * 4, y = h;\n    switch (direction) {\n        case 'top-left':\n            dirY = -1;\n            dirX = -1;\n            break;\n        case 'top':\n            dirY = -1;\n            dirX = 0;\n            break;\n        case 'top-right':\n            dirY = -1;\n            dirX = 1;\n            break;\n        case 'right':\n            dirY = 0;\n            dirX = 1;\n            break;\n        case 'bottom-right':\n            dirY = 1;\n            dirX = 1;\n            break;\n        case 'bottom':\n            dirY = 1;\n            dirX = 0;\n            break;\n        case 'bottom-left':\n            dirY = 1;\n            dirX = -1;\n            break;\n        case 'left':\n            dirY = 0;\n            dirX = -1;\n            break;\n        default:\n            Util.error('Unknown emboss direction: ' + direction);\n    }\n    do {\n        var offsetY = (y - 1) * w4;\n        var otherY = dirY;\n        if (y + otherY < 1) {\n            otherY = 0;\n        }\n        if (y + otherY > h) {\n            otherY = 0;\n        }\n        var offsetYOther = (y - 1 + otherY) * w * 4;\n        var x = w;\n        do {\n            var offset = offsetY + (x - 1) * 4;\n            var otherX = dirX;\n            if (x + otherX < 1) {\n                otherX = 0;\n            }\n            if (x + otherX > w) {\n                otherX = 0;\n            }\n            var offsetOther = offsetYOther + (x - 1 + otherX) * 4;\n            var dR = data[offset] - data[offsetOther];\n            var dG = data[offset + 1] - data[offsetOther + 1];\n            var dB = data[offset + 2] - data[offsetOther + 2];\n            var dif = dR;\n            var absDif = dif > 0 ? dif : -dif;\n            var absG = dG > 0 ? dG : -dG;\n            var absB = dB > 0 ? dB : -dB;\n            if (absG > absDif) {\n                dif = dG;\n            }\n            if (absB > absDif) {\n                dif = dB;\n            }\n            dif *= strength;\n            if (blend) {\n                var r = data[offset] + dif;\n                var g = data[offset + 1] + dif;\n                var b = data[offset + 2] + dif;\n                data[offset] = r > 255 ? 255 : r < 0 ? 0 : r;\n                data[offset + 1] = g > 255 ? 255 : g < 0 ? 0 : g;\n                data[offset + 2] = b > 255 ? 255 : b < 0 ? 0 : b;\n            }\n            else {\n                var grey = greyLevel - dif;\n                if (grey < 0) {\n                    grey = 0;\n                }\n                else if (grey > 255) {\n                    grey = 255;\n                }\n                data[offset] = data[offset + 1] = data[offset + 2] = grey;\n            }\n        } while (--x);\n    } while (--y);\n};\nFactory.addGetterSetter(Node, 'embossStrength', 0.5, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'embossWhiteLevel', 0.5, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'embossDirection', 'top-left', null, Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'embossBlend', false, null, Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nfunction remap(fromValue, fromMin, fromMax, toMin, toMax) {\n    var fromRange = fromMax - fromMin, toRange = toMax - toMin, toValue;\n    if (fromRange === 0) {\n        return toMin + toRange / 2;\n    }\n    if (toRange === 0) {\n        return toMin;\n    }\n    toValue = (fromValue - fromMin) / fromRange;\n    toValue = toRange * toValue + toMin;\n    return toValue;\n}\nexport const Enhance = function (imageData) {\n    var data = imageData.data, nSubPixels = data.length, rMin = data[0], rMax = rMin, r, gMin = data[1], gMax = gMin, g, bMin = data[2], bMax = bMin, b, i;\n    var enhanceAmount = this.enhance();\n    if (enhanceAmount === 0) {\n        return;\n    }\n    for (i = 0; i < nSubPixels; i += 4) {\n        r = data[i + 0];\n        if (r < rMin) {\n            rMin = r;\n        }\n        else if (r > rMax) {\n            rMax = r;\n        }\n        g = data[i + 1];\n        if (g < gMin) {\n            gMin = g;\n        }\n        else if (g > gMax) {\n            gMax = g;\n        }\n        b = data[i + 2];\n        if (b < bMin) {\n            bMin = b;\n        }\n        else if (b > bMax) {\n            bMax = b;\n        }\n    }\n    if (rMax === rMin) {\n        rMax = 255;\n        rMin = 0;\n    }\n    if (gMax === gMin) {\n        gMax = 255;\n        gMin = 0;\n    }\n    if (bMax === bMin) {\n        bMax = 255;\n        bMin = 0;\n    }\n    var rMid, rGoalMax, rGoalMin, gMid, gGoalMax, gGoalMin, bMid, bGoalMax, bGoalMin;\n    if (enhanceAmount > 0) {\n        rGoalMax = rMax + enhanceAmount * (255 - rMax);\n        rGoalMin = rMin - enhanceAmount * (rMin - 0);\n        gGoalMax = gMax + enhanceAmount * (255 - gMax);\n        gGoalMin = gMin - enhanceAmount * (gMin - 0);\n        bGoalMax = bMax + enhanceAmount * (255 - bMax);\n        bGoalMin = bMin - enhanceAmount * (bMin - 0);\n    }\n    else {\n        rMid = (rMax + rMin) * 0.5;\n        rGoalMax = rMax + enhanceAmount * (rMax - rMid);\n        rGoalMin = rMin + enhanceAmount * (rMin - rMid);\n        gMid = (gMax + gMin) * 0.5;\n        gGoalMax = gMax + enhanceAmount * (gMax - gMid);\n        gGoalMin = gMin + enhanceAmount * (gMin - gMid);\n        bMid = (bMax + bMin) * 0.5;\n        bGoalMax = bMax + enhanceAmount * (bMax - bMid);\n        bGoalMin = bMin + enhanceAmount * (bMin - bMid);\n    }\n    for (i = 0; i < nSubPixels; i += 4) {\n        data[i + 0] = remap(data[i + 0], rMin, rMax, rGoalMin, rGoalMax);\n        data[i + 1] = remap(data[i + 1], gMin, gMax, gGoalMin, gGoalMax);\n        data[i + 2] = remap(data[i + 2], bMin, bMax, bGoalMin, bGoalMax);\n    }\n};\nFactory.addGetterSetter(Node, 'enhance', 0, getNumberValidator(), Factory.afterSetFilter);\n","export const Grayscale = function (imageData) {\n    var data = imageData.data, len = data.length, i, brightness;\n    for (i = 0; i < len; i += 4) {\n        brightness = 0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2];\n        data[i] = brightness;\n        data[i + 1] = brightness;\n        data[i + 2] = brightness;\n    }\n};\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nFactory.addGetterSetter(Node, 'hue', 0, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'saturation', 0, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'luminance', 0, getNumberValidator(), Factory.afterSetFilter);\nexport const HSL = function (imageData) {\n    var data = imageData.data, nPixels = data.length, v = 1, s = Math.pow(2, this.saturation()), h = Math.abs(this.hue() + 360) % 360, l = this.luminance() * 127, i;\n    var vsu = v * s * Math.cos((h * Math.PI) / 180), vsw = v * s * Math.sin((h * Math.PI) / 180);\n    var rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw, rg = 0.587 * v - 0.587 * vsu + 0.33 * vsw, rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;\n    var gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw, gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw, gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;\n    var br = 0.299 * v - 0.3 * vsu + 1.25 * vsw, bg = 0.587 * v - 0.586 * vsu - 1.05 * vsw, bb = 0.114 * v + 0.886 * vsu - 0.2 * vsw;\n    var r, g, b, a;\n    for (i = 0; i < nPixels; i += 4) {\n        r = data[i + 0];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n        data[i + 0] = rr * r + rg * g + rb * b + l;\n        data[i + 1] = gr * r + gg * g + gb * b + l;\n        data[i + 2] = br * r + bg * g + bb * b + l;\n        data[i + 3] = a;\n    }\n};\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const HSV = function (imageData) {\n    var data = imageData.data, nPixels = data.length, v = Math.pow(2, this.value()), s = Math.pow(2, this.saturation()), h = Math.abs(this.hue() + 360) % 360, i;\n    var vsu = v * s * Math.cos((h * Math.PI) / 180), vsw = v * s * Math.sin((h * Math.PI) / 180);\n    var rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw, rg = 0.587 * v - 0.587 * vsu + 0.33 * vsw, rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;\n    var gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw, gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw, gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;\n    var br = 0.299 * v - 0.3 * vsu + 1.25 * vsw, bg = 0.587 * v - 0.586 * vsu - 1.05 * vsw, bb = 0.114 * v + 0.886 * vsu - 0.2 * vsw;\n    var r, g, b, a;\n    for (i = 0; i < nPixels; i += 4) {\n        r = data[i + 0];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n        data[i + 0] = rr * r + rg * g + rb * b;\n        data[i + 1] = gr * r + gg * g + gb * b;\n        data[i + 2] = br * r + bg * g + bb * b;\n        data[i + 3] = a;\n    }\n};\nFactory.addGetterSetter(Node, 'hue', 0, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'saturation', 0, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'value', 0, getNumberValidator(), Factory.afterSetFilter);\n","export const Invert = function (imageData) {\n    var data = imageData.data, len = data.length, i;\n    for (i = 0; i < len; i += 4) {\n        data[i] = 255 - data[i];\n        data[i + 1] = 255 - data[i + 1];\n        data[i + 2] = 255 - data[i + 2];\n    }\n};\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { Util } from '../Util.js';\nimport { getNumberValidator } from '../Validators.js';\nvar ToPolar = function (src, dst, opt) {\n    var srcPixels = src.data, dstPixels = dst.data, xSize = src.width, ySize = src.height, xMid = opt.polarCenterX || xSize / 2, yMid = opt.polarCenterY || ySize / 2, i, x, y, r = 0, g = 0, b = 0, a = 0;\n    var rad, rMax = Math.sqrt(xMid * xMid + yMid * yMid);\n    x = xSize - xMid;\n    y = ySize - yMid;\n    rad = Math.sqrt(x * x + y * y);\n    rMax = rad > rMax ? rad : rMax;\n    var rSize = ySize, tSize = xSize, radius, theta;\n    var conversion = ((360 / tSize) * Math.PI) / 180, sin, cos;\n    for (theta = 0; theta < tSize; theta += 1) {\n        sin = Math.sin(theta * conversion);\n        cos = Math.cos(theta * conversion);\n        for (radius = 0; radius < rSize; radius += 1) {\n            x = Math.floor(xMid + ((rMax * radius) / rSize) * cos);\n            y = Math.floor(yMid + ((rMax * radius) / rSize) * sin);\n            i = (y * xSize + x) * 4;\n            r = srcPixels[i + 0];\n            g = srcPixels[i + 1];\n            b = srcPixels[i + 2];\n            a = srcPixels[i + 3];\n            i = (theta + radius * xSize) * 4;\n            dstPixels[i + 0] = r;\n            dstPixels[i + 1] = g;\n            dstPixels[i + 2] = b;\n            dstPixels[i + 3] = a;\n        }\n    }\n};\nvar FromPolar = function (src, dst, opt) {\n    var srcPixels = src.data, dstPixels = dst.data, xSize = src.width, ySize = src.height, xMid = opt.polarCenterX || xSize / 2, yMid = opt.polarCenterY || ySize / 2, i, x, y, dx, dy, r = 0, g = 0, b = 0, a = 0;\n    var rad, rMax = Math.sqrt(xMid * xMid + yMid * yMid);\n    x = xSize - xMid;\n    y = ySize - yMid;\n    rad = Math.sqrt(x * x + y * y);\n    rMax = rad > rMax ? rad : rMax;\n    var rSize = ySize, tSize = xSize, radius, theta, phaseShift = opt.polarRotation || 0;\n    var x1, y1;\n    for (x = 0; x < xSize; x += 1) {\n        for (y = 0; y < ySize; y += 1) {\n            dx = x - xMid;\n            dy = y - yMid;\n            radius = (Math.sqrt(dx * dx + dy * dy) * rSize) / rMax;\n            theta = ((Math.atan2(dy, dx) * 180) / Math.PI + 360 + phaseShift) % 360;\n            theta = (theta * tSize) / 360;\n            x1 = Math.floor(theta);\n            y1 = Math.floor(radius);\n            i = (y1 * xSize + x1) * 4;\n            r = srcPixels[i + 0];\n            g = srcPixels[i + 1];\n            b = srcPixels[i + 2];\n            a = srcPixels[i + 3];\n            i = (y * xSize + x) * 4;\n            dstPixels[i + 0] = r;\n            dstPixels[i + 1] = g;\n            dstPixels[i + 2] = b;\n            dstPixels[i + 3] = a;\n        }\n    }\n};\nexport const Kaleidoscope = function (imageData) {\n    var xSize = imageData.width, ySize = imageData.height;\n    var x, y, xoff, i, r, g, b, a, srcPos, dstPos;\n    var power = Math.round(this.kaleidoscopePower());\n    var angle = Math.round(this.kaleidoscopeAngle());\n    var offset = Math.floor((xSize * (angle % 360)) / 360);\n    if (power < 1) {\n        return;\n    }\n    var tempCanvas = Util.createCanvasElement();\n    tempCanvas.width = xSize;\n    tempCanvas.height = ySize;\n    var scratchData = tempCanvas\n        .getContext('2d')\n        .getImageData(0, 0, xSize, ySize);\n    ToPolar(imageData, scratchData, {\n        polarCenterX: xSize / 2,\n        polarCenterY: ySize / 2,\n    });\n    var minSectionSize = xSize / Math.pow(2, power);\n    while (minSectionSize <= 8) {\n        minSectionSize = minSectionSize * 2;\n        power -= 1;\n    }\n    minSectionSize = Math.ceil(minSectionSize);\n    var sectionSize = minSectionSize;\n    var xStart = 0, xEnd = sectionSize, xDelta = 1;\n    if (offset + minSectionSize > xSize) {\n        xStart = sectionSize;\n        xEnd = 0;\n        xDelta = -1;\n    }\n    for (y = 0; y < ySize; y += 1) {\n        for (x = xStart; x !== xEnd; x += xDelta) {\n            xoff = Math.round(x + offset) % xSize;\n            srcPos = (xSize * y + xoff) * 4;\n            r = scratchData.data[srcPos + 0];\n            g = scratchData.data[srcPos + 1];\n            b = scratchData.data[srcPos + 2];\n            a = scratchData.data[srcPos + 3];\n            dstPos = (xSize * y + x) * 4;\n            scratchData.data[dstPos + 0] = r;\n            scratchData.data[dstPos + 1] = g;\n            scratchData.data[dstPos + 2] = b;\n            scratchData.data[dstPos + 3] = a;\n        }\n    }\n    for (y = 0; y < ySize; y += 1) {\n        sectionSize = Math.floor(minSectionSize);\n        for (i = 0; i < power; i += 1) {\n            for (x = 0; x < sectionSize + 1; x += 1) {\n                srcPos = (xSize * y + x) * 4;\n                r = scratchData.data[srcPos + 0];\n                g = scratchData.data[srcPos + 1];\n                b = scratchData.data[srcPos + 2];\n                a = scratchData.data[srcPos + 3];\n                dstPos = (xSize * y + sectionSize * 2 - x - 1) * 4;\n                scratchData.data[dstPos + 0] = r;\n                scratchData.data[dstPos + 1] = g;\n                scratchData.data[dstPos + 2] = b;\n                scratchData.data[dstPos + 3] = a;\n            }\n            sectionSize *= 2;\n        }\n    }\n    FromPolar(scratchData, imageData, { polarRotation: 0 });\n};\nFactory.addGetterSetter(Node, 'kaleidoscopePower', 2, getNumberValidator(), Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'kaleidoscopeAngle', 0, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nfunction pixelAt(idata, x, y) {\n    var idx = (y * idata.width + x) * 4;\n    var d = [];\n    d.push(idata.data[idx++], idata.data[idx++], idata.data[idx++], idata.data[idx++]);\n    return d;\n}\nfunction rgbDistance(p1, p2) {\n    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) +\n        Math.pow(p1[1] - p2[1], 2) +\n        Math.pow(p1[2] - p2[2], 2));\n}\nfunction rgbMean(pTab) {\n    var m = [0, 0, 0];\n    for (var i = 0; i < pTab.length; i++) {\n        m[0] += pTab[i][0];\n        m[1] += pTab[i][1];\n        m[2] += pTab[i][2];\n    }\n    m[0] /= pTab.length;\n    m[1] /= pTab.length;\n    m[2] /= pTab.length;\n    return m;\n}\nfunction backgroundMask(idata, threshold) {\n    var rgbv_no = pixelAt(idata, 0, 0);\n    var rgbv_ne = pixelAt(idata, idata.width - 1, 0);\n    var rgbv_so = pixelAt(idata, 0, idata.height - 1);\n    var rgbv_se = pixelAt(idata, idata.width - 1, idata.height - 1);\n    var thres = threshold || 10;\n    if (rgbDistance(rgbv_no, rgbv_ne) < thres &&\n        rgbDistance(rgbv_ne, rgbv_se) < thres &&\n        rgbDistance(rgbv_se, rgbv_so) < thres &&\n        rgbDistance(rgbv_so, rgbv_no) < thres) {\n        var mean = rgbMean([rgbv_ne, rgbv_no, rgbv_se, rgbv_so]);\n        var mask = [];\n        for (var i = 0; i < idata.width * idata.height; i++) {\n            var d = rgbDistance(mean, [\n                idata.data[i * 4],\n                idata.data[i * 4 + 1],\n                idata.data[i * 4 + 2],\n            ]);\n            mask[i] = d < thres ? 0 : 255;\n        }\n        return mask;\n    }\n}\nfunction applyMask(idata, mask) {\n    for (var i = 0; i < idata.width * idata.height; i++) {\n        idata.data[4 * i + 3] = mask[i];\n    }\n}\nfunction erodeMask(mask, sw, sh) {\n    var weights = [1, 1, 1, 1, 0, 1, 1, 1, 1];\n    var side = Math.round(Math.sqrt(weights.length));\n    var halfSide = Math.floor(side / 2);\n    var maskResult = [];\n    for (var y = 0; y < sh; y++) {\n        for (var x = 0; x < sw; x++) {\n            var so = y * sw + x;\n            var a = 0;\n            for (var cy = 0; cy < side; cy++) {\n                for (var cx = 0; cx < side; cx++) {\n                    var scy = y + cy - halfSide;\n                    var scx = x + cx - halfSide;\n                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n                        var srcOff = scy * sw + scx;\n                        var wt = weights[cy * side + cx];\n                        a += mask[srcOff] * wt;\n                    }\n                }\n            }\n            maskResult[so] = a === 255 * 8 ? 255 : 0;\n        }\n    }\n    return maskResult;\n}\nfunction dilateMask(mask, sw, sh) {\n    var weights = [1, 1, 1, 1, 1, 1, 1, 1, 1];\n    var side = Math.round(Math.sqrt(weights.length));\n    var halfSide = Math.floor(side / 2);\n    var maskResult = [];\n    for (var y = 0; y < sh; y++) {\n        for (var x = 0; x < sw; x++) {\n            var so = y * sw + x;\n            var a = 0;\n            for (var cy = 0; cy < side; cy++) {\n                for (var cx = 0; cx < side; cx++) {\n                    var scy = y + cy - halfSide;\n                    var scx = x + cx - halfSide;\n                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n                        var srcOff = scy * sw + scx;\n                        var wt = weights[cy * side + cx];\n                        a += mask[srcOff] * wt;\n                    }\n                }\n            }\n            maskResult[so] = a >= 255 * 4 ? 255 : 0;\n        }\n    }\n    return maskResult;\n}\nfunction smoothEdgeMask(mask, sw, sh) {\n    var weights = [1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9];\n    var side = Math.round(Math.sqrt(weights.length));\n    var halfSide = Math.floor(side / 2);\n    var maskResult = [];\n    for (var y = 0; y < sh; y++) {\n        for (var x = 0; x < sw; x++) {\n            var so = y * sw + x;\n            var a = 0;\n            for (var cy = 0; cy < side; cy++) {\n                for (var cx = 0; cx < side; cx++) {\n                    var scy = y + cy - halfSide;\n                    var scx = x + cx - halfSide;\n                    if (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n                        var srcOff = scy * sw + scx;\n                        var wt = weights[cy * side + cx];\n                        a += mask[srcOff] * wt;\n                    }\n                }\n            }\n            maskResult[so] = a;\n        }\n    }\n    return maskResult;\n}\nexport const Mask = function (imageData) {\n    var threshold = this.threshold(), mask = backgroundMask(imageData, threshold);\n    if (mask) {\n        mask = erodeMask(mask, imageData.width, imageData.height);\n        mask = dilateMask(mask, imageData.width, imageData.height);\n        mask = smoothEdgeMask(mask, imageData.width, imageData.height);\n        applyMask(imageData, mask);\n    }\n    return imageData;\n};\nFactory.addGetterSetter(Node, 'threshold', 0, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Noise = function (imageData) {\n    var amount = this.noise() * 255, data = imageData.data, nPixels = data.length, half = amount / 2, i;\n    for (i = 0; i < nPixels; i += 4) {\n        data[i + 0] += half - 2 * half * Math.random();\n        data[i + 1] += half - 2 * half * Math.random();\n        data[i + 2] += half - 2 * half * Math.random();\n    }\n};\nFactory.addGetterSetter(Node, 'noise', 0.2, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Util } from '../Util.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Pixelate = function (imageData) {\n    var pixelSize = Math.ceil(this.pixelSize()), width = imageData.width, height = imageData.height, x, y, i, red, green, blue, alpha, nBinsX = Math.ceil(width / pixelSize), nBinsY = Math.ceil(height / pixelSize), xBinStart, xBinEnd, yBinStart, yBinEnd, xBin, yBin, pixelsInBin, data = imageData.data;\n    if (pixelSize <= 0) {\n        Util.error('pixelSize value can not be <= 0');\n        return;\n    }\n    for (xBin = 0; xBin < nBinsX; xBin += 1) {\n        for (yBin = 0; yBin < nBinsY; yBin += 1) {\n            red = 0;\n            green = 0;\n            blue = 0;\n            alpha = 0;\n            xBinStart = xBin * pixelSize;\n            xBinEnd = xBinStart + pixelSize;\n            yBinStart = yBin * pixelSize;\n            yBinEnd = yBinStart + pixelSize;\n            pixelsInBin = 0;\n            for (x = xBinStart; x < xBinEnd; x += 1) {\n                if (x >= width) {\n                    continue;\n                }\n                for (y = yBinStart; y < yBinEnd; y += 1) {\n                    if (y >= height) {\n                        continue;\n                    }\n                    i = (width * y + x) * 4;\n                    red += data[i + 0];\n                    green += data[i + 1];\n                    blue += data[i + 2];\n                    alpha += data[i + 3];\n                    pixelsInBin += 1;\n                }\n            }\n            red = red / pixelsInBin;\n            green = green / pixelsInBin;\n            blue = blue / pixelsInBin;\n            alpha = alpha / pixelsInBin;\n            for (x = xBinStart; x < xBinEnd; x += 1) {\n                if (x >= width) {\n                    continue;\n                }\n                for (y = yBinStart; y < yBinEnd; y += 1) {\n                    if (y >= height) {\n                        continue;\n                    }\n                    i = (width * y + x) * 4;\n                    data[i + 0] = red;\n                    data[i + 1] = green;\n                    data[i + 2] = blue;\n                    data[i + 3] = alpha;\n                }\n            }\n        }\n    }\n};\nFactory.addGetterSetter(Node, 'pixelSize', 8, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Posterize = function (imageData) {\n    var levels = Math.round(this.levels() * 254) + 1, data = imageData.data, len = data.length, scale = 255 / levels, i;\n    for (i = 0; i < len; i += 1) {\n        data[i] = Math.floor(data[i] / scale) * scale;\n    }\n};\nFactory.addGetterSetter(Node, 'levels', 0.5, getNumberValidator(), Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { RGBComponent } from '../Validators.js';\nexport const RGB = function (imageData) {\n    var data = imageData.data, nPixels = data.length, red = this.red(), green = this.green(), blue = this.blue(), i, brightness;\n    for (i = 0; i < nPixels; i += 4) {\n        brightness =\n            (0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2]) / 255;\n        data[i] = brightness * red;\n        data[i + 1] = brightness * green;\n        data[i + 2] = brightness * blue;\n        data[i + 3] = data[i + 3];\n    }\n};\nFactory.addGetterSetter(Node, 'red', 0, function (val) {\n    this._filterUpToDate = false;\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    else {\n        return Math.round(val);\n    }\n});\nFactory.addGetterSetter(Node, 'green', 0, function (val) {\n    this._filterUpToDate = false;\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    else {\n        return Math.round(val);\n    }\n});\nFactory.addGetterSetter(Node, 'blue', 0, RGBComponent, Factory.afterSetFilter);\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { RGBComponent } from '../Validators.js';\nexport const RGBA = function (imageData) {\n    var data = imageData.data, nPixels = data.length, red = this.red(), green = this.green(), blue = this.blue(), alpha = this.alpha(), i, ia;\n    for (i = 0; i < nPixels; i += 4) {\n        ia = 1 - alpha;\n        data[i] = red * alpha + data[i] * ia;\n        data[i + 1] = green * alpha + data[i + 1] * ia;\n        data[i + 2] = blue * alpha + data[i + 2] * ia;\n    }\n};\nFactory.addGetterSetter(Node, 'red', 0, function (val) {\n    this._filterUpToDate = false;\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    else {\n        return Math.round(val);\n    }\n});\nFactory.addGetterSetter(Node, 'green', 0, function (val) {\n    this._filterUpToDate = false;\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    else {\n        return Math.round(val);\n    }\n});\nFactory.addGetterSetter(Node, 'blue', 0, RGBComponent, Factory.afterSetFilter);\nFactory.addGetterSetter(Node, 'alpha', 1, function (val) {\n    this._filterUpToDate = false;\n    if (val > 1) {\n        return 1;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    else {\n        return val;\n    }\n});\n","export const Sepia = function (imageData) {\n    var data = imageData.data, nPixels = data.length, i, r, g, b;\n    for (i = 0; i < nPixels; i += 4) {\n        r = data[i + 0];\n        g = data[i + 1];\n        b = data[i + 2];\n        data[i + 0] = Math.min(255, r * 0.393 + g * 0.769 + b * 0.189);\n        data[i + 1] = Math.min(255, r * 0.349 + g * 0.686 + b * 0.168);\n        data[i + 2] = Math.min(255, r * 0.272 + g * 0.534 + b * 0.131);\n    }\n};\n","export const Solarize = function (imageData) {\n    var data = imageData.data, w = imageData.width, h = imageData.height, w4 = w * 4, y = h;\n    do {\n        var offsetY = (y - 1) * w4;\n        var x = w;\n        do {\n            var offset = offsetY + (x - 1) * 4;\n            var r = data[offset];\n            var g = data[offset + 1];\n            var b = data[offset + 2];\n            if (r > 127) {\n                r = 255 - r;\n            }\n            if (g > 127) {\n                g = 255 - g;\n            }\n            if (b > 127) {\n                b = 255 - b;\n            }\n            data[offset] = r;\n            data[offset + 1] = g;\n            data[offset + 2] = b;\n        } while (--x);\n    } while (--y);\n};\n","import { Factory } from '../Factory.js';\nimport { Node } from '../Node.js';\nimport { getNumberValidator } from '../Validators.js';\nexport const Threshold = function (imageData) {\n    var level = this.threshold() * 255, data = imageData.data, len = data.length, i;\n    for (i = 0; i < len; i += 1) {\n        data[i] = data[i] < level ? 0 : 255;\n    }\n};\nFactory.addGetterSetter(Node, 'threshold', 0.5, getNumberValidator(), Factory.afterSetFilter);\n","import { Konva as Core } from './_CoreInternals.js';\nimport { Arc } from './shapes/Arc.js';\nimport { Arrow } from './shapes/Arrow.js';\nimport { Circle } from './shapes/Circle.js';\nimport { Ellipse } from './shapes/Ellipse.js';\nimport { Image } from './shapes/Image.js';\nimport { Label, Tag } from './shapes/Label.js';\nimport { Line } from './shapes/Line.js';\nimport { Path } from './shapes/Path.js';\nimport { Rect } from './shapes/Rect.js';\nimport { RegularPolygon } from './shapes/RegularPolygon.js';\nimport { Ring } from './shapes/Ring.js';\nimport { Sprite } from './shapes/Sprite.js';\nimport { Star } from './shapes/Star.js';\nimport { Text } from './shapes/Text.js';\nimport { TextPath } from './shapes/TextPath.js';\nimport { Transformer } from './shapes/Transformer.js';\nimport { Wedge } from './shapes/Wedge.js';\nimport { Blur } from './filters/Blur.js';\nimport { Brighten } from './filters/Brighten.js';\nimport { Contrast } from './filters/Contrast.js';\nimport { Emboss } from './filters/Emboss.js';\nimport { Enhance } from './filters/Enhance.js';\nimport { Grayscale } from './filters/Grayscale.js';\nimport { HSL } from './filters/HSL.js';\nimport { HSV } from './filters/HSV.js';\nimport { Invert } from './filters/Invert.js';\nimport { Kaleidoscope } from './filters/Kaleidoscope.js';\nimport { Mask } from './filters/Mask.js';\nimport { Noise } from './filters/Noise.js';\nimport { Pixelate } from './filters/Pixelate.js';\nimport { Posterize } from './filters/Posterize.js';\nimport { RGB } from './filters/RGB.js';\nimport { RGBA } from './filters/RGBA.js';\nimport { Sepia } from './filters/Sepia.js';\nimport { Solarize } from './filters/Solarize.js';\nimport { Threshold } from './filters/Threshold.js';\nexport const Konva = Core.Util._assign(Core, {\n    Arc,\n    Arrow,\n    Circle,\n    Ellipse,\n    Image,\n    Label,\n    Tag,\n    Line,\n    Path,\n    Rect,\n    RegularPolygon,\n    Ring,\n    Sprite,\n    Star,\n    Text,\n    TextPath,\n    Transformer,\n    Wedge,\n    Filters: {\n        Blur,\n        Brighten,\n        Contrast,\n        Emboss,\n        Enhance,\n        Grayscale,\n        HSL,\n        HSV,\n        Invert,\n        Kaleidoscope,\n        Mask,\n        Noise,\n        Pixelate,\n        Posterize,\n        RGB,\n        RGBA,\n        Sepia,\n        Solarize,\n        Threshold,\n    },\n});\n","import { Konva } from './_FullInternals.js';\nexport default Konva;\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","import Konva from \"konva\";\n\nexport class BoardComponent {\n  boardPosition = { col: 0, row: 0 };\n  board = null;\n  tweens = new Map();\n  group = new Konva.Group();\n\n  constructor(board, col, row) {\n    this.board = board;\n\n    this.setBoardPosition(col, row);\n\n    this.updateScreenPosition();\n  }\n\n  setBoardPosition(col, row) {\n    this.boardPosition.col = col;\n    this.boardPosition.row = row;\n\n    this.updateScreenPosition();\n  }\n\n  updateScreenPosition() {\n    const screenPosition = this.board.getScreenPosition(this.boardPosition.col, this.boardPosition.row);\n\n    this.group.setPosition(screenPosition);\n  }\n\n  getScreenPosition() {\n    return this.group.position;\n  }\n\n  getShape(id) {\n    return this.group.findOne(\"#\" + id);\n  }\n\n  addTween(id, tween) {\n    this.tweens.set(id, tween);\n  }\n\n  tween(callback, ...tweens) {\n    for (const tween of tweens) {\n      if (this.tweens.has(tween)) {\n        callback(this.tweens.get(tween));\n      } else {\n        console.warn(`Tween \"${ tween }\" does not exists.\"`);\n      }\n    }\n  }\n\n  destroy() {\n    this.group.destroy();\n\n    for (const key in this.tweens) {\n      this.tweens.get(key).destroy();\n    }\n\n    this.tweens.clear();\n  }\n}","export default class ImageLoader {\n  static images = new Map();\n  static loaded = new Map();\n  static callbacks = new Map();\n\n  static load(path, callback) {\n    if (this.images[path]) {\n      if (this.loaded[path]) {\n        callback(this.images[path]);\n      } else {\n        this.callbacks[path].push(callback);\n      }\n    } else {\n      const image = new Image();\n\n      const handleImage = () => {\n        while (this.callbacks[path].length > 0) {\n            const fn = this.callbacks[path].pop();\n            fn(image);\n        }\n\n        this.loaded[path] = true;\n      }\n\n      image.addEventListener('load', handleImage);\n\n      image.src = path;\n\n      this.loaded[path] = false;\n      this.images[path] = image;\n      this.callbacks[path] = [ callback ];\n    }\n  }\n}","import ImageLoader from \"../utils/ImageLoader\";\n\nexport const CONFIG = {\n  PATH: {\n    SVG: \"svg/\",\n  }\n}\n\nexport class PieceType {\n  id = null;\n  tag = null;\n  value = null;\n  svg = null;\n\n  constructor(id, tag, value) {\n    this.id = id;\n    this.tag = tag;\n    this.value = value;\n\n    ImageLoader.load(`${ CONFIG.PATH.SVG }${ this.id }.svg`, (svg) => {\n      this.svg = svg;\n    });\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  getTag() {\n    return this.tag;\n  }\n\n  getValue() {\n    return this.value;\n  }\n\n  getSvg() {\n    return this.svg;\n  }\n\n  compare(b) {\n    return PieceType.compare(this, b);\n  }\n\n  static compare(a, b) {\n    if (a.getValue() > b.getValue()) {\n      return 1;\n    } else if (a.getValue() < b.getValue()) {\n      return -1;\n    } else {\n      return 0;\n    }\n  }\n\n  static desearilize({ value }) {\n    return getTypeByValue(value);\n  }\n}\n\nexport const Types = {\n  HIDDEN: new PieceType(\"HIDDEN\", \"\", -1),\n  FLAG: new PieceType(\"FLAG\", \"FLAG\", 0),\n  PRIVATE:  new PieceType(\"PRIVATE\", \"PRIVATE\", 1),\n  SERGEANT: new PieceType(\"SERGEANT\", \"SERGEANT\", 2),\n  LIEUTENANT2: new PieceType(\"LIEUTENANT2\", \"2nd LIEUT.\", 3),\n  LIEUTENANT1: new PieceType(\"LIEUTENANT1\", \"1st LIEUT.\", 4),\n  CAPTAIN: new PieceType(\"CAPTAIN\", \"CAPTAIN\", 5),\n  MAJOR: new PieceType(\"MAJOR\", \"MAJOR\", 6),\n  LIEUTENANT_COLONEL: new PieceType(\"LIEUTENANT_COLONEL\", \"LT. COLONEL\", 7),\n  COLONEL: new PieceType(\"COLONEL\", \"COLONEL\", 8),\n  GENERAL1: new PieceType(\"GENERAL1\", \"GENERAL\", 9),\n  GENERAL2: new PieceType(\"GENERAL2\", \"GENERAL\", 10),\n  GENERAL3: new PieceType(\"GENERAL3\", \"GENERAL\", 11),\n  GENERAL4: new PieceType(\"GENERAL4\", \"GENERAL\", 12),\n  GENERAL5: new PieceType(\"GENERAL5\", \"GENERAL\", 13),\n  SPY: new PieceType(\"SPY\", \"SPY\", 14),\n};\n\nexport const getTypeByValue = (value) => {\n  for (const obj of Object.entries(Types)) {\n      if (obj[1].getValue() == value) {\n          return obj[1];\n      }\n  }\n\n  return null;\n};\n\nexport const getTypeById = (id) => {\n    for (const obj of Object.entries(Types)) {\n        if (obj[1].getId() == id) {\n            return obj[1];\n        }\n    }\n  \n    return null;\n}","export const PlayerType = {\n  WHITE: \"WHITE\",\n  BLACK: \"BLACK\",\n};","import Konva from \"konva\";\nimport { CONFIG as BOARD_CONFIG } from \"../Board\";\nimport { BoardComponent } from \"../BoardComponent\";\nimport { getTypeById } from \"./PieceType\";\nimport { PlayerType } from \"../PlayerType\";\n// import ImageLoader from \"../utils/ImageLoader\";\n\nexport const CONFIG = {\n  COLOR: {\n    [PlayerType.WHITE]: {\n      DEFAULT: \"#f5fdc6\",\n      DARK: \"#d2d9a9\"\n    },\n    [PlayerType.BLACK]: {\n      DEFAULT: \"#36453b\",\n      DARK: \"#2a362e\"\n    }\n  },\n  ID: {\n    RECT: \"piece-rect\",\n    SVG: \"piece-svg\",\n    TAG: \"piece-tag\",\n  }\n}\n\nexport class Piece extends BoardComponent {\n  playerType = null;\n  pieceType = null;\n\n  constructor(board, col, row, playerType, pieceType) {\n    super(board, col, row);\n\n    this.playerType = playerType;\n    this.pieceType = pieceType;\n\n    this.init();\n  }\n\n  init() {\n    this.initKonva();\n  }\n\n  initKonva() {\n    const offset = 4;\n    const piece = new Konva.Rect({\n      width: BOARD_CONFIG.SLOT.WIDTH - offset * 2,\n      height: BOARD_CONFIG.SLOT.HEIGHT - offset * 2,\n      fill: CONFIG.COLOR[this.playerType].DEFAULT,\n      ID: CONFIG.ID.RECT,\n      offset: {\n        x: -offset,\n        y: -offset,\n      }\n    });\n\n    const tag = new Konva.Text({\n      id: CONFIG.ID.TAG,\n      text: this.pieceType.getTag(),\n      width: BOARD_CONFIG.SLOT.WIDTH,\n      y: BOARD_CONFIG.SLOT.HEIGHT - 15,\n      align: 'center',\n    });\n\n    this.group.add(piece);\n    this.group.add(tag);\n\n    // ImageLoader.load(`${ PIECETYPE_CONFIG.PATH.SVG }${ this.pieceType.getId() }.svg`, (image) => {\n    //   const svg = new Konva.Image({\n    //     id: CONFIG.ID.SVG,\n    //     image,\n    //     width: 50,\n    //     height: 50,\n    //     offset: {\n    //       x: -(BOARD_CONFIG.SLOT.WIDTH - 50) / 2,\n    //       y: -(BOARD_CONFIG.SLOT.HEIGHT - 50) / 2 + 8,\n    //     },\n    //   });\n\n    //   this.group.add(svg);\n    // });\n    this.board.layer.add(this.group);\n    this.initEvents();\n  }\n\n  initEvents() {\n    this.group.on('click', () => {\n      this.board.handlePieceClick(this.boardPosition.col, this.boardPosition.row);\n    })\n  }\n\n  static deserialize(board, col, row, serialized) {\n    const piece = new Piece(board, col, row, serialized.playerType, getTypeById(serialized.pieceType.id));\n    return piece;\n  }\n}","import Konva from \"konva\";\nimport { CONFIG as BOARD_CONFIG } from \"../Board\";\nimport { BoardComponent } from \"../BoardComponent\";\nimport { PlayerType } from \"../PlayerType\";\n\nexport const CONFIG = {\n  COLOR: {\n    [PlayerType.WHITE]: {\n      DEFAULT: \"#588157\",\n      POTENTIAL: \"#a59132\",\n      POTENTIAL_DARK: \"#a59132\",\n    },\n    [PlayerType.BLACK]: {\n      DEFAULT: \"#a3b18a\",\n      POTENTIAL: \"#a59132\",\n      POTENTIAL_DARK: \"#a59132\",\n    },\n  },\n  ID: {\n    RECT: \"slot-rect\",\n  },\n}\n\nexport class Slot extends BoardComponent {\n  playerType = null;\n\n  constructor(board, col, row, playerType) {\n    super(board, col, row);\n\n    this.playerType = playerType;\n\n    this.init();\n  }\n\n  init() {\n    this.initKonva();\n  }\n\n  initKonva() {\n    const slot = new Konva.Rect({\n      width: BOARD_CONFIG.SLOT.WIDTH,\n      height: BOARD_CONFIG.SLOT.HEIGHT,\n      fill: CONFIG.COLOR[this.playerType].DEFAULT,\n      id: CONFIG.ID.RECT,\n    });\n\n    this.group.add(slot);\n\n    this.initEvents();\n\n    this.board.layer.add(this.group);\n  }\n\n  initEvents() {\n    this.group.on('click', () => {\n      this.board.handleSlotClick(this.boardPosition.col, this.boardPosition.row);\n    });\n  }\n\n  setPotential(state) {\n    const shape = this.getShape(CONFIG.ID.RECT);\n    \n    if (shape == null) {\n      return;\n    }\n\n    if (state) {\n      shape.fill(CONFIG.COLOR[this.playerType].POTENTIAL);\n    } else {\n      shape.fill(CONFIG.COLOR[this.playerType].DEFAULT);\n    }\n  }\n\n  changePlayerType(playerType) {\n    const slot = this.getShape(CONFIG.ID.RECT);\n\n    this.playerType = playerType;\n\n    slot.fill(CONFIG.COLOR[this.playerType].DEFAULT);\n  }\n}","import Konva from \"konva\";\nimport { Piece } from \"./Piece\";\nimport { Slot } from \"./Slot\";\nimport { PlayerType } from \"./PlayerType\";\n\nexport const CONFIG = {\n  BOARD: {\n    GAP: 8,\n  },\n  SLOT: {\n    WIDTH: 100,\n    HEIGHT: 62,\n  },\n  CELL: {\n    WIDTH: 100,\n    HEIGHT: 62,\n  },\n  COLOR: {\n    DEFAULT: \"#344e41\",\n  }\n}\n\nexport class Board {\n  socket = null;\n  stage = null;\n  layer = new Konva.Layer();\n  x = 0;\n  y = 0;\n  row = 0;\n  col = 0;\n  width = 0;\n  height = 0;\n  clickedPiece = null;\n  playerType = PlayerType.WHITE;\n  orientation = PlayerType.WHITE;\n\n  pieces = [];\n  slots = []\n\n  constructor(socket, container, x, y, row, col) {\n    this.socket = socket;\n    this.x = x;\n    this.y = y;\n    this.col = col;\n    this.row = row;\n    this.width = this.col * (CONFIG.SLOT.WIDTH + CONFIG.BOARD.GAP) + CONFIG.BOARD.GAP;\n    this.height = this.row * (CONFIG.SLOT.HEIGHT + CONFIG.BOARD.GAP) + CONFIG.BOARD.GAP;\n\n    this.stage = new Konva.Stage({\n      container,\n      width: this.width,\n      height: this.height,\n    });\n\n    this.init();\n  }\n\n  init() {\n    this.initKonva();\n    this.initSockets();\n\n\n    window.addEventListener('resize', () => {\n      this.stage.width(this.width);\n      this.stage.height(this.width);\n    })\n  }\n\n  initKonva() {\n    const boardRect = new Konva.Rect({\n      width: this.width,\n      height: this.height,\n      fill: CONFIG.COLOR.DEFAULT,\n    });\n\n    this.layer.add(boardRect);\n\n    for (let row = 0; row < this.row; row++) {\n      const ROW = []\n      for (let col = 0; col < this.col; col++) {\n        const playerType = row < this.row / 2 ? PlayerType.WHITE : PlayerType.BLACK;\n\n        ROW.push(new Slot(this, col, row, playerType));\n      }\n      this.slots.push(ROW);\n    }\n\n    this.stage.add(this.layer);\n\n    this.initEvents();\n  }\n\n  initEvents() {\n    \n  }\n\n  initSockets() {\n    this.socket.on(\"sync-board\", (data) => {\n      this.loadBoard(data);\n    });\n\n    this.socket.on(\"opponent-moved-piece\", ({ payload, result }) => {\n      const { col: col1, row: row1 } = this.orientedColRow(payload.col1, payload.row1);\n      const { col: col2, row: row2 } = this.orientedColRow(payload.col2, payload.row2);\n\n      this.handlePieceBattle(col1, row1, col2, row2, result);\n    });\n\n    this.socket.on(\"winner\", (data) => {\n      console.log(data);\n    })\n  }\n\n  movePiece(col1, row1, col2, row2) {\n    if (!this.hasPieceAt(col1, row1)) {\n      return;\n    }\n\n    this.pieces[row2][col2] = this.pieces[row1][col1];\n    this.pieces[row1][col1] = null;\n\n    this.pieces[row2][col2].setBoardPosition(col2, row2);\n  }\n\n  killPiece(col, row) {\n    if (this.hasPieceAt(col, row)) {\n      this.pieces[row][col].destroy();\n    }\n\n    this.pieces[row][col] = null;\n  }\n\n  handlePieceBattle(col1, row1, col2, row2, result) {\n    if (result == -1) {\n      this.killPiece(col1, row1);\n    } else if (result == 0) {\n      this.killPiece(col1, row1);\n      this.killPiece(col2, row2);\n    } else if (result == 1) {\n      this.killPiece(col2, row2);\n      this.movePiece(col1, row1, col2, row2);\n    } else if (result == 2) {\n      this.movePiece(col1, row1, col2, row2);\n    }\n  }\n\n  handlePieceClick(col, row) {\n    if (this.clickedPiece != null) {\n      if (this.clickedPiece != this.pieces[row][col]) {\n        // this.unclickPiece();\n        // this.clickPiece(col, row);\n        this.handleSlotClick(col, row);\n      } else {\n        this.unclickPiece();\n      }\n    } else {\n      this.clickPiece(col, row);\n    }\n  }\n\n  clickPiece(col, row) {\n    if (this.pieces[row][col]) {\n      if (this.pieces[row][col].pieceType.getValue() >= 0) {\n        this.clickedPiece = this.pieces[row][col];\n      }\n    }\n    \n    if (this.clickedPiece != null) {\n      this.setPotentialsOf(col, row, true);\n    }\n  }\n\n  unclickPiece() {\n    if (this.clickedPiece != null) {\n      const { col, row } = this.clickedPiece.boardPosition;\n      this.setPotentialsOf(col, row, false);\n    }\n\n    this.clickedPiece = null;\n  }\n\n  setPotentialsOf(col, row, state) {\n    if (!this.hasPieceAt(col, row)) {\n      return;\n    }\n\n    const dcol = [ 1, 0, -1, 0 ];\n    const drow = [ 0, -1, 0, 1 ];\n\n    for (let i = 0; i < 4; i++) {\n      const col1 = col + dcol[i];\n      const row1 = row + drow[i];\n\n      if (this.isInBound(col1, row1)) {\n        if (state) {\n          if (this.hasPieceAt(col1, row1)) {\n            if (this.pieces[row][col].playerType != this.pieces[row1][col1].playerType) {\n              this.slots[row1][col1].setPotential(true);\n            }\n          } else {\n            this.slots[row1][col1].setPotential(true);\n          }\n        } else {\n          this.slots[row1][col1].setPotential(false);\n        }\n      }\n    }\n  }\n\n  handleSlotClick(col, row) {\n    if (this.clickedPiece != null) {\n      const { col: pCol, row: pRow } = this.clickedPiece.boardPosition;\n      const distance = this.getDistance(pCol, pRow, col, row);\n      const { col: col1, row: row1 } = this.orientedColRow(pCol, pRow);\n      const { col: col2, row: row2 } = this.orientedColRow(col, row);\n\n      this.unclickPiece();\n\n      if (distance == 1) {\n        this.socket.emit(\"move-piece\", {\n          col1,\n          row1,\n          col2,\n          row2,\n        }, (result) => {\n          this.handlePieceBattle(pCol, pRow, col, row, result);\n        });\n      }\n    }\n\n    this.unclickPiece();\n  }\n\n  getScreenPosition(col, row) {\n    return {\n      x: col * (CONFIG.SLOT.WIDTH + CONFIG.BOARD.GAP) + CONFIG.BOARD.GAP,\n      y: row * (CONFIG.SLOT.HEIGHT + CONFIG.BOARD.GAP) + CONFIG.BOARD.GAP,\n    }\n  }\n\n  getDistance(col1, row1, col2, row2) {\n    return Math.abs(col1 - col2) + Math.abs(row1 - row2);\n  }\n\n  isInBound(col, row) {\n    return col >= 0 && col < this.col && row >= 0 && row < this.row;\n  }\n\n  hasPieceAt(col, row) {\n    return this.isInBound(col, row) && this.pieces[row][col] != null;\n  }\n\n  changePlayerType(playerType) {\n    this.playerType = playerType;\n\n    this.changeOrientation(this.playerType);\n  }\n\n  changeOrientation(orientation) {\n    this.orientation = orientation;\n\n    for (let row = 0; row < this.row; row++) {\n      for (let col = 0; col < this.col; col++) {\n        const playerType = row < this.row / 2 ? PlayerType.WHITE : PlayerType.BLACK;\n        const oriented = this.orientation == PlayerType.WHITE ? playerType : (playerType == PlayerType.WHITE ? PlayerType.BLACK : PlayerType.WHITE);\n\n        this.slots[row][col].changePlayerType(oriented);\n      }\n    }\n  }\n\n  orientedColRow(col, row) {\n    if (this.orientation == PlayerType.BLACK) {\n      return {\n        col,\n        row: this.row - 1 - row,\n      }\n    }\n\n    return {\n      col,\n      row,\n    };\n  }\n\n  syncBoardData({ data }) {\n    const { col, row, pieces } = data;\n\n    for (let i = 0; i < row; i++) {\n      for (let j = 0; j < col; j++) {\n        if (this.hasPieceAt(j, i) == (pieces[i][j] != null)) {\n          if (this.hasPieceAt(j, i)) {\n            const p1 = this.getPieceAt(j, i);\n            const p2 = pieces[i][j];\n\n            if (p1.pieceType.getId() != p2.pieceType.id\n              || p1.playerType != p2.playerType\n              || p2.x != j\n              || p2.y != i) {\n\n              this.loadBoard(data);\n              return;\n            }\n          }\n        } else {\n          this.loadBoard(data);\n          return;\n        }\n      }\n    }\n  }\n\n  loadBoard({ data }) {\n    this.unclickPiece();\n\n    const { col: c, row: r, playerType, pieces } = data;\n\n    if (playerType != null) {\n      this.changePlayerType(playerType);\n    }\n\n    for (const ROW of this.pieces) {\n      for (const piece of ROW) {\n        if (piece != null) {\n          piece.destroy();\n        }\n      }\n    }\n\n    this.pieces = [];\n\n    for (let row = 0; row < r; row++) {\n      const ROW = [];\n      for (let col = 0; col < c; col++) {\n        const { col: col1, row: row1 } = this.orientedColRow(col, row);\n\n        const serialized = pieces[row1][col1];\n\n        if (serialized != null) {\n          const piece = Piece.deserialize(this, col, row, serialized);\n          ROW.push(piece);\n        } else {\n          ROW.push(null);\n        }\n      }\n\n      this.pieces.push(ROW);\n    }\n  }\n}","import { render } from \"./Game.vue?vue&type=template&id=94c7d5b0\"\nimport script from \"./Game.vue?vue&type=script&lang=js\"\nexport * from \"./Game.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  } catch (error) {\n    iteratorClose(iterator);\n    throw error;\n  }\n};\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  // eslint-disable-next-line es/no-array-from -- required for testing\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.es/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.iterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.iterator\ndefineWellKnownSymbol('iterator');\n","var PI_OVER_180 = Math.PI / 180;\nfunction detectBrowser() {\n    return (typeof window !== 'undefined' &&\n        ({}.toString.call(window) === '[object Window]' ||\n            {}.toString.call(window) === '[object global]'));\n}\nexport const glob = typeof global !== 'undefined'\n    ? global\n    : typeof window !== 'undefined'\n        ? window\n        : typeof WorkerGlobalScope !== 'undefined'\n            ? self\n            : {};\nexport const Konva = {\n    _global: glob,\n    version: '8.0.4',\n    isBrowser: detectBrowser(),\n    isUnminified: /param/.test(function (param) { }.toString()),\n    dblClickWindow: 400,\n    getAngle(angle) {\n        return Konva.angleDeg ? angle * PI_OVER_180 : angle;\n    },\n    enableTrace: false,\n    pointerEventsEnabled: true,\n    autoDrawEnabled: true,\n    hitOnDragEnabled: false,\n    capturePointerEventsEnabled: false,\n    _mouseListenClick: false,\n    _touchListenClick: false,\n    _pointerListenClick: false,\n    _mouseInDblClickWindow: false,\n    _touchInDblClickWindow: false,\n    _pointerInDblClickWindow: false,\n    pixelRatio: (typeof window !== 'undefined' && window.devicePixelRatio) || 1,\n    dragDistance: 3,\n    angleDeg: true,\n    showWarnings: true,\n    dragButtons: [0, 1],\n    isDragging() {\n        return Konva['DD'].isDragging;\n    },\n    isDragReady() {\n        return !!Konva['DD'].node;\n    },\n    document: glob.document,\n    _injectGlobal(Konva) {\n        glob.Konva = Konva;\n    },\n};\nexport const _registerNode = (NodeClass) => {\n    Konva[NodeClass.prototype.getClassName()] = NodeClass;\n};\nKonva._injectGlobal(Konva);\n","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar has = require('../internals/has');\nvar isObject = require('../internals/is-object');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\n\nif (DESCRIPTORS && typeof NativeSymbol == 'function' && (!('description' in NativeSymbol.prototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : String(arguments[0]);\n    var result = this instanceof SymbolWrapper\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  var symbolPrototype = SymbolWrapper.prototype = NativeSymbol.prototype;\n  symbolPrototype.constructor = SymbolWrapper;\n\n  var symbolToString = symbolPrototype.toString;\n  var native = String(NativeSymbol('test')) == 'Symbol(test)';\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  defineProperty(symbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = isObject(this) ? this.valueOf() : this;\n      var string = symbolToString.call(symbol);\n      if (has(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = native ? string.slice(7, -1) : string.replace(regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n","var hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar has = require('../internals/has');\nvar defineProperty = require('../internals/object-define-property').f;\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar METADATA = uid('meta');\nvar id = 0;\n\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + ++id, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && meta.REQUIRED && isExtensible(it) && !has(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar meta = module.exports = {\n  REQUIRED: false,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","'use strict';\nvar $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\n\nvar SPECIES = wellKnownSymbol('species');\nvar nativeSlice = [].slice;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.es/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = toLength(O.length);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (typeof Constructor == 'function' && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return nativeSlice.call(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n"],"sourceRoot":""}